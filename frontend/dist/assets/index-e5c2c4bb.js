function zD(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var WD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dI={exports:{}},am={},fI={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bh=Symbol.for("react.element"),HD=Symbol.for("react.portal"),$D=Symbol.for("react.fragment"),qD=Symbol.for("react.strict_mode"),GD=Symbol.for("react.profiler"),KD=Symbol.for("react.provider"),ZD=Symbol.for("react.context"),QD=Symbol.for("react.forward_ref"),YD=Symbol.for("react.suspense"),XD=Symbol.for("react.memo"),JD=Symbol.for("react.lazy"),wT=Symbol.iterator;function eM(t){return t===null||typeof t!="object"?null:(t=wT&&t[wT]||t["@@iterator"],typeof t=="function"?t:null)}var pI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mI=Object.assign,gI={};function tu(t,e,n){this.props=t,this.context=e,this.refs=gI,this.updater=n||pI}tu.prototype.isReactComponent={};tu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};tu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function _I(){}_I.prototype=tu.prototype;function zv(t,e,n){this.props=t,this.context=e,this.refs=gI,this.updater=n||pI}var Wv=zv.prototype=new _I;Wv.constructor=zv;mI(Wv,tu.prototype);Wv.isPureReactComponent=!0;var ET=Array.isArray,yI=Object.prototype.hasOwnProperty,Hv={current:null},vI={key:!0,ref:!0,__self:!0,__source:!0};function wI(t,e,n){var i,r={},s=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)yI.call(e,i)&&!vI.hasOwnProperty(i)&&(r[i]=e[i]);var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){for(var c=Array(u),h=0;h<u;h++)c[h]=arguments[h+2];r.children=c}if(t&&t.defaultProps)for(i in u=t.defaultProps,u)r[i]===void 0&&(r[i]=u[i]);return{$$typeof:Bh,type:t,key:s,ref:a,props:r,_owner:Hv.current}}function tM(t,e){return{$$typeof:Bh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $v(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bh}function nM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var TT=/\/+/g;function Ag(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nM(""+t.key):e.toString(36)}function Ef(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Bh:case HD:a=!0}}if(a)return a=t,r=r(a),t=i===""?"."+Ag(a,0):i,ET(r)?(n="",t!=null&&(n=t.replace(TT,"$&/")+"/"),Ef(r,e,n,"",function(h){return h})):r!=null&&($v(r)&&(r=tM(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(TT,"$&/")+"/")+t)),e.push(r)),1;if(a=0,i=i===""?".":i+":",ET(t))for(var u=0;u<t.length;u++){s=t[u];var c=i+Ag(s,u);a+=Ef(s,e,n,c,r)}else if(c=eM(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=i+Ag(s,u++),a+=Ef(s,e,n,c,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function $d(t,e,n){if(t==null)return t;var i=[],r=0;return Ef(t,i,"","",function(s){return e.call(n,s,r++)}),i}function iM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cn={current:null},Tf={transition:null},rM={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:Tf,ReactCurrentOwner:Hv};function EI(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:$d,forEach:function(t,e,n){$d(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return $d(t,function(){e++}),e},toArray:function(t){return $d(t,function(e){return e})||[]},only:function(t){if(!$v(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=tu;ke.Fragment=$D;ke.Profiler=GD;ke.PureComponent=zv;ke.StrictMode=qD;ke.Suspense=YD;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rM;ke.act=EI;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=mI({},t.props),r=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Hv.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)yI.call(e,c)&&!vI.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];i.children=u}return{$$typeof:Bh,type:t.type,key:r,ref:s,props:i,_owner:a}};ke.createContext=function(t){return t={$$typeof:ZD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KD,_context:t},t.Consumer=t};ke.createElement=wI;ke.createFactory=function(t){var e=wI.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:QD,render:t}};ke.isValidElement=$v;ke.lazy=function(t){return{$$typeof:JD,_payload:{_status:-1,_result:t},_init:iM}};ke.memo=function(t,e){return{$$typeof:XD,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Tf.transition;Tf.transition={};try{t()}finally{Tf.transition=e}};ke.unstable_act=EI;ke.useCallback=function(t,e){return Cn.current.useCallback(t,e)};ke.useContext=function(t){return Cn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return Cn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return Cn.current.useEffect(t,e)};ke.useId=function(){return Cn.current.useId()};ke.useImperativeHandle=function(t,e,n){return Cn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return Cn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return Cn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return Cn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return Cn.current.useReducer(t,e,n)};ke.useRef=function(t){return Cn.current.useRef(t)};ke.useState=function(t){return Cn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return Cn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return Cn.current.useTransition()};ke.version="18.3.1";fI.exports=ke;var B=fI.exports;const ui=hI(B),sM=zD({__proto__:null,default:ui},[B]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oM=B,aM=Symbol.for("react.element"),lM=Symbol.for("react.fragment"),uM=Object.prototype.hasOwnProperty,cM=oM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hM={key:!0,ref:!0,__self:!0,__source:!0};function TI(t,e,n){var i,r={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)uM.call(e,i)&&!hM.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:aM,type:t,key:s,ref:a,props:r,_owner:cM.current}}am.Fragment=lM;am.jsx=TI;am.jsxs=TI;dI.exports=am;var E=dI.exports;var O_={},xI={exports:{}},Zn={},SI={exports:{}},CI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,re){var X=q.length;q.push(re);e:for(;0<X;){var le=X-1>>>1,Se=q[le];if(0<r(Se,re))q[le]=re,q[X]=Se,X=le;else break e}}function n(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var re=q[0],X=q.pop();if(X!==re){q[0]=X;e:for(var le=0,Se=q.length,nt=Se>>>1;le<nt;){var Ve=2*(le+1)-1,Ne=q[Ve],ye=Ve+1,Ut=q[ye];if(0>r(Ne,X))ye<Se&&0>r(Ut,Ne)?(q[le]=Ut,q[ye]=X,le=ye):(q[le]=Ne,q[Ve]=X,le=Ve);else if(ye<Se&&0>r(Ut,X))q[le]=Ut,q[ye]=X,le=ye;else break e}}return re}function r(q,re){var X=q.sortIndex-re.sortIndex;return X!==0?X:q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var c=[],h=[],p=1,m=null,_=3,T=!1,A=!1,b=!1,V=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(q){for(var re=n(h);re!==null;){if(re.callback===null)i(h);else if(re.startTime<=q)i(h),re.sortIndex=re.expirationTime,e(c,re);else break;re=n(h)}}function U(q){if(b=!1,R(q),!A)if(n(c)!==null)A=!0,Ge(W);else{var re=n(h);re!==null&&he(U,re.startTime-q)}}function W(q,re){A=!1,b&&(b=!1,C(I),I=-1),T=!0;var X=_;try{for(R(re),m=n(c);m!==null&&(!(m.expirationTime>re)||q&&!M());){var le=m.callback;if(typeof le=="function"){m.callback=null,_=m.priorityLevel;var Se=le(m.expirationTime<=re);re=t.unstable_now(),typeof Se=="function"?m.callback=Se:m===n(c)&&i(c),R(re)}else i(c);m=n(c)}if(m!==null)var nt=!0;else{var Ve=n(h);Ve!==null&&he(U,Ve.startTime-re),nt=!1}return nt}finally{m=null,_=X,T=!1}}var K=!1,k=null,I=-1,N=5,O=-1;function M(){return!(t.unstable_now()-O<N)}function j(){if(k!==null){var q=t.unstable_now();O=q;var re=!0;try{re=k(!0,q)}finally{re?D():(K=!1,k=null)}}else K=!1}var D;if(typeof S=="function")D=function(){S(j)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Nt=xe.port2;xe.port1.onmessage=j,D=function(){Nt.postMessage(null)}}else D=function(){V(j,0)};function Ge(q){k=q,K||(K=!0,D())}function he(q,re){I=V(function(){q(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){A||T||(A=!0,Ge(W))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(q){switch(_){case 1:case 2:case 3:var re=3;break;default:re=_}var X=_;_=re;try{return q()}finally{_=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,re){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var X=_;_=q;try{return re()}finally{_=X}},t.unstable_scheduleCallback=function(q,re,X){var le=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?le+X:le):X=le,q){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=X+Se,q={id:p++,callback:re,priorityLevel:q,startTime:X,expirationTime:Se,sortIndex:-1},X>le?(q.sortIndex=X,e(h,q),n(c)===null&&q===n(h)&&(b?(C(I),I=-1):b=!0,he(U,X-le))):(q.sortIndex=Se,e(c,q),A||T||(A=!0,Ge(W))),q},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(q){var re=_;return function(){var X=_;_=re;try{return q.apply(this,arguments)}finally{_=X}}}})(CI);SI.exports=CI;var dM=SI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fM=B,Kn=dM;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var II=new Set,Qc={};function ca(t,e){Nl(t,e),Nl(t+"Capture",e)}function Nl(t,e){for(Qc[t]=e,t=0;t<e.length;t++)II.add(e[t])}var zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),V_=Object.prototype.hasOwnProperty,pM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xT={},ST={};function mM(t){return V_.call(ST,t)?!0:V_.call(xT,t)?!1:pM.test(t)?ST[t]=!0:(xT[t]=!0,!1)}function gM(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _M(t,e,n,i){if(e===null||typeof e>"u"||gM(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,i,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rn[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rn[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rn[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rn[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rn[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rn[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rn[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rn[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rn[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var qv=/[\-:]([a-z])/g;function Gv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qv,Gv);rn[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qv,Gv);rn[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qv,Gv);rn[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rn[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});rn.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rn[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function Kv(t,e,n,i){var r=rn.hasOwnProperty(e)?rn[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_M(e,n,r,i)&&(n=null),i||r===null?mM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var es=fM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qd=Symbol.for("react.element"),Ya=Symbol.for("react.portal"),Xa=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),F_=Symbol.for("react.profiler"),PI=Symbol.for("react.provider"),AI=Symbol.for("react.context"),Qv=Symbol.for("react.forward_ref"),j_=Symbol.for("react.suspense"),U_=Symbol.for("react.suspense_list"),Yv=Symbol.for("react.memo"),gs=Symbol.for("react.lazy"),RI=Symbol.for("react.offscreen"),CT=Symbol.iterator;function Xu(t){return t===null||typeof t!="object"?null:(t=CT&&t[CT]||t["@@iterator"],typeof t=="function"?t:null)}var dt=Object.assign,Rg;function fc(t){if(Rg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Rg=e&&e[1]||""}return`
`+Rg+t}var bg=!1;function kg(t,e){if(!t||bg)return"";bg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var i=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){i=h}t.call(e.prototype)}else{try{throw Error()}catch(h){i=h}t()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,u=s.length-1;1<=a&&0<=u&&r[a]!==s[u];)u--;for(;1<=a&&0<=u;a--,u--)if(r[a]!==s[u]){if(a!==1||u!==1)do if(a--,u--,0>u||r[a]!==s[u]){var c=`
`+r[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=u);break}}}finally{bg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?fc(t):""}function yM(t){switch(t.tag){case 5:return fc(t.type);case 16:return fc("Lazy");case 13:return fc("Suspense");case 19:return fc("SuspenseList");case 0:case 2:case 15:return t=kg(t.type,!1),t;case 11:return t=kg(t.type.render,!1),t;case 1:return t=kg(t.type,!0),t;default:return""}}function B_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xa:return"Fragment";case Ya:return"Portal";case F_:return"Profiler";case Zv:return"StrictMode";case j_:return"Suspense";case U_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AI:return(t.displayName||"Context")+".Consumer";case PI:return(t._context.displayName||"Context")+".Provider";case Qv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Yv:return e=t.displayName||null,e!==null?e:B_(t.type)||"Memo";case gs:e=t._payload,t=t._init;try{return B_(t(e))}catch{}}return null}function vM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B_(e);case 8:return e===Zv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function bI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wM(t){var e=bI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gd(t){t._valueTracker||(t._valueTracker=wM(t))}function kI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=bI(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Kf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function z_(t,e){var n=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function IT(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=zs(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NI(t,e){e=e.checked,e!=null&&Kv(t,"checked",e,!1)}function W_(t,e){NI(t,e);var n=zs(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?H_(t,e.type,n):e.hasOwnProperty("defaultValue")&&H_(t,e.type,zs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function PT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function H_(t,e,n){(e!=="number"||Kf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var pc=Array.isArray;function gl(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+zs(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function $_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function AT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(pc(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zs(n)}}function LI(t,e){var n=zs(e.value),i=zs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function RT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Kd,MI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Kd=Kd||document.createElement("div"),Kd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Kd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EM=["Webkit","ms","Moz","O"];Object.keys(Ic).forEach(function(t){EM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ic[e]=Ic[t]})});function OI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ic.hasOwnProperty(t)&&Ic[t]?(""+e).trim():e+"px"}function VI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=OI(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var TM=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function G_(t,e){if(e){if(TM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function K_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Z_=null;function Xv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Q_=null,_l=null,yl=null;function bT(t){if(t=Hh(t)){if(typeof Q_!="function")throw Error(J(280));var e=t.stateNode;e&&(e=dm(e),Q_(t.stateNode,t.type,e))}}function FI(t){_l?yl?yl.push(t):yl=[t]:_l=t}function jI(){if(_l){var t=_l,e=yl;if(yl=_l=null,bT(t),e)for(t=0;t<e.length;t++)bT(e[t])}}function UI(t,e){return t(e)}function BI(){}var Ng=!1;function zI(t,e,n){if(Ng)return t(e,n);Ng=!0;try{return UI(t,e,n)}finally{Ng=!1,(_l!==null||yl!==null)&&(BI(),jI())}}function Xc(t,e){var n=t.stateNode;if(n===null)return null;var i=dm(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var Y_=!1;if(zr)try{var Ju={};Object.defineProperty(Ju,"passive",{get:function(){Y_=!0}}),window.addEventListener("test",Ju,Ju),window.removeEventListener("test",Ju,Ju)}catch{Y_=!1}function xM(t,e,n,i,r,s,a,u,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Pc=!1,Zf=null,Qf=!1,X_=null,SM={onError:function(t){Pc=!0,Zf=t}};function CM(t,e,n,i,r,s,a,u,c){Pc=!1,Zf=null,xM.apply(SM,arguments)}function IM(t,e,n,i,r,s,a,u,c){if(CM.apply(this,arguments),Pc){if(Pc){var h=Zf;Pc=!1,Zf=null}else throw Error(J(198));Qf||(Qf=!0,X_=h)}}function ha(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function WI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kT(t){if(ha(t)!==t)throw Error(J(188))}function PM(t){var e=t.alternate;if(!e){if(e=ha(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return kT(r),t;if(s===i)return kT(r),e;s=s.sibling}throw Error(J(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,u=r.child;u;){if(u===n){a=!0,n=r,i=s;break}if(u===i){a=!0,i=r,n=s;break}u=u.sibling}if(!a){for(u=s.child;u;){if(u===n){a=!0,n=s,i=r;break}if(u===i){a=!0,i=s,n=r;break}u=u.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==i)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function HI(t){return t=PM(t),t!==null?$I(t):null}function $I(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$I(t);if(e!==null)return e;t=t.sibling}return null}var qI=Kn.unstable_scheduleCallback,NT=Kn.unstable_cancelCallback,AM=Kn.unstable_shouldYield,RM=Kn.unstable_requestPaint,Et=Kn.unstable_now,bM=Kn.unstable_getCurrentPriorityLevel,Jv=Kn.unstable_ImmediatePriority,GI=Kn.unstable_UserBlockingPriority,Yf=Kn.unstable_NormalPriority,kM=Kn.unstable_LowPriority,KI=Kn.unstable_IdlePriority,lm=null,tr=null;function NM(t){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(lm,t,void 0,(t.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:MM,LM=Math.log,DM=Math.LN2;function MM(t){return t>>>=0,t===0?32:31-(LM(t)/DM|0)|0}var Zd=64,Qd=4194304;function mc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xf(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~r;u!==0?i=mc(u):(s&=a,s!==0&&(i=mc(s)))}else a=n&~r,a!==0?i=mc(a):s!==0&&(i=mc(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-ki(e),r=1<<n,i|=t[n],e&=~r;return i}function OM(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VM(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ki(s),u=1<<a,c=r[a];c===-1?(!(u&n)||u&i)&&(r[a]=OM(u,e)):c<=e&&(t.expiredLanes|=u),s&=~u}}function J_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZI(){var t=Zd;return Zd<<=1,!(Zd&4194240)&&(Zd=64),t}function Lg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function zh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ki(e),t[e]=n}function FM(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ki(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function e0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ki(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var He=0;function QI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var YI,t0,XI,JI,eP,ey=!1,Yd=[],As=null,Rs=null,bs=null,Jc=new Map,eh=new Map,ys=[],jM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LT(t,e){switch(t){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":Rs=null;break;case"mouseover":case"mouseout":bs=null;break;case"pointerover":case"pointerout":Jc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":eh.delete(e.pointerId)}}function ec(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Hh(e),e!==null&&t0(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function UM(t,e,n,i,r){switch(e){case"focusin":return As=ec(As,t,e,n,i,r),!0;case"dragenter":return Rs=ec(Rs,t,e,n,i,r),!0;case"mouseover":return bs=ec(bs,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Jc.set(s,ec(Jc.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,eh.set(s,ec(eh.get(s)||null,t,e,n,i,r)),!0}return!1}function tP(t){var e=Do(t.target);if(e!==null){var n=ha(e);if(n!==null){if(e=n.tag,e===13){if(e=WI(n),e!==null){t.blockedOn=e,eP(t.priority,function(){XI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function xf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ty(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Z_=i,n.target.dispatchEvent(i),Z_=null}else return e=Hh(n),e!==null&&t0(e),t.blockedOn=n,!1;e.shift()}return!0}function DT(t,e,n){xf(t)&&n.delete(e)}function BM(){ey=!1,As!==null&&xf(As)&&(As=null),Rs!==null&&xf(Rs)&&(Rs=null),bs!==null&&xf(bs)&&(bs=null),Jc.forEach(DT),eh.forEach(DT)}function tc(t,e){t.blockedOn===e&&(t.blockedOn=null,ey||(ey=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,BM)))}function th(t){function e(r){return tc(r,t)}if(0<Yd.length){tc(Yd[0],t);for(var n=1;n<Yd.length;n++){var i=Yd[n];i.blockedOn===t&&(i.blockedOn=null)}}for(As!==null&&tc(As,t),Rs!==null&&tc(Rs,t),bs!==null&&tc(bs,t),Jc.forEach(e),eh.forEach(e),n=0;n<ys.length;n++)i=ys[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<ys.length&&(n=ys[0],n.blockedOn===null);)tP(n),n.blockedOn===null&&ys.shift()}var vl=es.ReactCurrentBatchConfig,Jf=!0;function zM(t,e,n,i){var r=He,s=vl.transition;vl.transition=null;try{He=1,n0(t,e,n,i)}finally{He=r,vl.transition=s}}function WM(t,e,n,i){var r=He,s=vl.transition;vl.transition=null;try{He=4,n0(t,e,n,i)}finally{He=r,vl.transition=s}}function n0(t,e,n,i){if(Jf){var r=ty(t,e,n,i);if(r===null)Wg(t,e,i,ep,n),LT(t,i);else if(UM(r,t,e,n,i))i.stopPropagation();else if(LT(t,i),e&4&&-1<jM.indexOf(t)){for(;r!==null;){var s=Hh(r);if(s!==null&&YI(s),s=ty(t,e,n,i),s===null&&Wg(t,e,i,ep,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Wg(t,e,i,null,n)}}var ep=null;function ty(t,e,n,i){if(ep=null,t=Xv(i),t=Do(t),t!==null)if(e=ha(t),e===null)t=null;else if(n=e.tag,n===13){if(t=WI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ep=t,null}function nP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bM()){case Jv:return 1;case GI:return 4;case Yf:case kM:return 16;case KI:return 536870912;default:return 16}default:return 16}}var xs=null,i0=null,Sf=null;function iP(){if(Sf)return Sf;var t,e=i0,n=e.length,i,r="value"in xs?xs.value:xs.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return Sf=r.slice(t,1<i?1-i:void 0)}function Cf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xd(){return!0}function MT(){return!1}function Qn(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Xd:MT,this.isPropagationStopped=MT,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xd)},persist:function(){},isPersistent:Xd}),e}var nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},r0=Qn(nu),Wh=dt({},nu,{view:0,detail:0}),HM=Qn(Wh),Dg,Mg,nc,um=dt({},Wh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nc&&(nc&&t.type==="mousemove"?(Dg=t.screenX-nc.screenX,Mg=t.screenY-nc.screenY):Mg=Dg=0,nc=t),Dg)},movementY:function(t){return"movementY"in t?t.movementY:Mg}}),OT=Qn(um),$M=dt({},um,{dataTransfer:0}),qM=Qn($M),GM=dt({},Wh,{relatedTarget:0}),Og=Qn(GM),KM=dt({},nu,{animationName:0,elapsedTime:0,pseudoElement:0}),ZM=Qn(KM),QM=dt({},nu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YM=Qn(QM),XM=dt({},nu,{data:0}),VT=Qn(XM),JM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},e2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},t2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=t2[t])?!!e[t]:!1}function s0(){return n2}var i2=dt({},Wh,{key:function(t){if(t.key){var e=JM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Cf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?e2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s0,charCode:function(t){return t.type==="keypress"?Cf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Cf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),r2=Qn(i2),s2=dt({},um,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FT=Qn(s2),o2=dt({},Wh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s0}),a2=Qn(o2),l2=dt({},nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),u2=Qn(l2),c2=dt({},um,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),h2=Qn(c2),d2=[9,13,27,32],o0=zr&&"CompositionEvent"in window,Ac=null;zr&&"documentMode"in document&&(Ac=document.documentMode);var f2=zr&&"TextEvent"in window&&!Ac,rP=zr&&(!o0||Ac&&8<Ac&&11>=Ac),jT=String.fromCharCode(32),UT=!1;function sP(t,e){switch(t){case"keyup":return d2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ja=!1;function p2(t,e){switch(t){case"compositionend":return oP(e);case"keypress":return e.which!==32?null:(UT=!0,jT);case"textInput":return t=e.data,t===jT&&UT?null:t;default:return null}}function m2(t,e){if(Ja)return t==="compositionend"||!o0&&sP(t,e)?(t=iP(),Sf=i0=xs=null,Ja=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rP&&e.locale!=="ko"?null:e.data;default:return null}}var g2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!g2[t.type]:e==="textarea"}function aP(t,e,n,i){FI(i),e=tp(e,"onChange"),0<e.length&&(n=new r0("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Rc=null,nh=null;function _2(t){yP(t,0)}function cm(t){var e=nl(t);if(kI(e))return t}function y2(t,e){if(t==="change")return e}var lP=!1;if(zr){var Vg;if(zr){var Fg="oninput"in document;if(!Fg){var zT=document.createElement("div");zT.setAttribute("oninput","return;"),Fg=typeof zT.oninput=="function"}Vg=Fg}else Vg=!1;lP=Vg&&(!document.documentMode||9<document.documentMode)}function WT(){Rc&&(Rc.detachEvent("onpropertychange",uP),nh=Rc=null)}function uP(t){if(t.propertyName==="value"&&cm(nh)){var e=[];aP(e,nh,t,Xv(t)),zI(_2,e)}}function v2(t,e,n){t==="focusin"?(WT(),Rc=e,nh=n,Rc.attachEvent("onpropertychange",uP)):t==="focusout"&&WT()}function w2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cm(nh)}function E2(t,e){if(t==="click")return cm(e)}function T2(t,e){if(t==="input"||t==="change")return cm(e)}function x2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mi=typeof Object.is=="function"?Object.is:x2;function ih(t,e){if(Mi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!V_.call(e,r)||!Mi(t[r],e[r]))return!1}return!0}function HT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $T(t,e){var n=HT(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=HT(n)}}function cP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function hP(){for(var t=window,e=Kf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Kf(t.document)}return e}function a0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function S2(t){var e=hP(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&cP(n.ownerDocument.documentElement,n)){if(i!==null&&a0(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=$T(n,s);var a=$T(n,i);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var C2=zr&&"documentMode"in document&&11>=document.documentMode,el=null,ny=null,bc=null,iy=!1;function qT(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;iy||el==null||el!==Kf(i)||(i=el,"selectionStart"in i&&a0(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),bc&&ih(bc,i)||(bc=i,i=tp(ny,"onSelect"),0<i.length&&(e=new r0("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=el)))}function Jd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var tl={animationend:Jd("Animation","AnimationEnd"),animationiteration:Jd("Animation","AnimationIteration"),animationstart:Jd("Animation","AnimationStart"),transitionend:Jd("Transition","TransitionEnd")},jg={},dP={};zr&&(dP=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);function hm(t){if(jg[t])return jg[t];if(!tl[t])return t;var e=tl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dP)return jg[t]=e[n];return t}var fP=hm("animationend"),pP=hm("animationiteration"),mP=hm("animationstart"),gP=hm("transitionend"),_P=new Map,GT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function io(t,e){_P.set(t,e),ca(e,[t])}for(var Ug=0;Ug<GT.length;Ug++){var Bg=GT[Ug],I2=Bg.toLowerCase(),P2=Bg[0].toUpperCase()+Bg.slice(1);io(I2,"on"+P2)}io(fP,"onAnimationEnd");io(pP,"onAnimationIteration");io(mP,"onAnimationStart");io("dblclick","onDoubleClick");io("focusin","onFocus");io("focusout","onBlur");io(gP,"onTransitionEnd");Nl("onMouseEnter",["mouseout","mouseover"]);Nl("onMouseLeave",["mouseout","mouseover"]);Nl("onPointerEnter",["pointerout","pointerover"]);Nl("onPointerLeave",["pointerout","pointerover"]);ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A2=new Set("cancel close invalid load scroll toggle".split(" ").concat(gc));function KT(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,IM(i,e,void 0,t),t.currentTarget=null}function yP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var u=i[a],c=u.instance,h=u.currentTarget;if(u=u.listener,c!==s&&r.isPropagationStopped())break e;KT(r,u,h),s=c}else for(a=0;a<i.length;a++){if(u=i[a],c=u.instance,h=u.currentTarget,u=u.listener,c!==s&&r.isPropagationStopped())break e;KT(r,u,h),s=c}}}if(Qf)throw t=X_,Qf=!1,X_=null,t}function Xe(t,e){var n=e[ly];n===void 0&&(n=e[ly]=new Set);var i=t+"__bubble";n.has(i)||(vP(e,t,2,!1),n.add(i))}function zg(t,e,n){var i=0;e&&(i|=4),vP(n,t,i,e)}var ef="_reactListening"+Math.random().toString(36).slice(2);function rh(t){if(!t[ef]){t[ef]=!0,II.forEach(function(n){n!=="selectionchange"&&(A2.has(n)||zg(n,!1,t),zg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ef]||(e[ef]=!0,zg("selectionchange",!1,e))}}function vP(t,e,n,i){switch(nP(e)){case 1:var r=zM;break;case 4:r=WM;break;default:r=n0}n=r.bind(null,e,n,t),r=void 0,!Y_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Wg(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var u=i.stateNode.containerInfo;if(u===r||u.nodeType===8&&u.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;a=a.return}for(;u!==null;){if(a=Do(u),a===null)return;if(c=a.tag,c===5||c===6){i=s=a;continue e}u=u.parentNode}}i=i.return}zI(function(){var h=s,p=Xv(n),m=[];e:{var _=_P.get(t);if(_!==void 0){var T=r0,A=t;switch(t){case"keypress":if(Cf(n)===0)break e;case"keydown":case"keyup":T=r2;break;case"focusin":A="focus",T=Og;break;case"focusout":A="blur",T=Og;break;case"beforeblur":case"afterblur":T=Og;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=OT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=qM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=a2;break;case fP:case pP:case mP:T=ZM;break;case gP:T=u2;break;case"scroll":T=HM;break;case"wheel":T=h2;break;case"copy":case"cut":case"paste":T=YM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=FT}var b=(e&4)!==0,V=!b&&t==="scroll",C=b?_!==null?_+"Capture":null:_;b=[];for(var S=h,R;S!==null;){R=S;var U=R.stateNode;if(R.tag===5&&U!==null&&(R=U,C!==null&&(U=Xc(S,C),U!=null&&b.push(sh(S,U,R)))),V)break;S=S.return}0<b.length&&(_=new T(_,A,null,n,p),m.push({event:_,listeners:b}))}}if(!(e&7)){e:{if(_=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",_&&n!==Z_&&(A=n.relatedTarget||n.fromElement)&&(Do(A)||A[Wr]))break e;if((T||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,T?(A=n.relatedTarget||n.toElement,T=h,A=A?Do(A):null,A!==null&&(V=ha(A),A!==V||A.tag!==5&&A.tag!==6)&&(A=null)):(T=null,A=h),T!==A)){if(b=OT,U="onMouseLeave",C="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(b=FT,U="onPointerLeave",C="onPointerEnter",S="pointer"),V=T==null?_:nl(T),R=A==null?_:nl(A),_=new b(U,S+"leave",T,n,p),_.target=V,_.relatedTarget=R,U=null,Do(p)===h&&(b=new b(C,S+"enter",A,n,p),b.target=R,b.relatedTarget=V,U=b),V=U,T&&A)t:{for(b=T,C=A,S=0,R=b;R;R=Ha(R))S++;for(R=0,U=C;U;U=Ha(U))R++;for(;0<S-R;)b=Ha(b),S--;for(;0<R-S;)C=Ha(C),R--;for(;S--;){if(b===C||C!==null&&b===C.alternate)break t;b=Ha(b),C=Ha(C)}b=null}else b=null;T!==null&&ZT(m,_,T,b,!1),A!==null&&V!==null&&ZT(m,V,A,b,!0)}}e:{if(_=h?nl(h):window,T=_.nodeName&&_.nodeName.toLowerCase(),T==="select"||T==="input"&&_.type==="file")var W=y2;else if(BT(_))if(lP)W=T2;else{W=w2;var K=v2}else(T=_.nodeName)&&T.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(W=E2);if(W&&(W=W(t,h))){aP(m,W,n,p);break e}K&&K(t,_,h),t==="focusout"&&(K=_._wrapperState)&&K.controlled&&_.type==="number"&&H_(_,"number",_.value)}switch(K=h?nl(h):window,t){case"focusin":(BT(K)||K.contentEditable==="true")&&(el=K,ny=h,bc=null);break;case"focusout":bc=ny=el=null;break;case"mousedown":iy=!0;break;case"contextmenu":case"mouseup":case"dragend":iy=!1,qT(m,n,p);break;case"selectionchange":if(C2)break;case"keydown":case"keyup":qT(m,n,p)}var k;if(o0)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Ja?sP(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(rP&&n.locale!=="ko"&&(Ja||I!=="onCompositionStart"?I==="onCompositionEnd"&&Ja&&(k=iP()):(xs=p,i0="value"in xs?xs.value:xs.textContent,Ja=!0)),K=tp(h,I),0<K.length&&(I=new VT(I,t,null,n,p),m.push({event:I,listeners:K}),k?I.data=k:(k=oP(n),k!==null&&(I.data=k)))),(k=f2?p2(t,n):m2(t,n))&&(h=tp(h,"onBeforeInput"),0<h.length&&(p=new VT("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=k))}yP(m,e)})}function sh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function tp(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Xc(t,n),s!=null&&i.unshift(sh(t,s,r)),s=Xc(t,e),s!=null&&i.push(sh(t,s,r))),t=t.return}return i}function Ha(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ZT(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var u=n,c=u.alternate,h=u.stateNode;if(c!==null&&c===i)break;u.tag===5&&h!==null&&(u=h,r?(c=Xc(n,s),c!=null&&a.unshift(sh(n,c,u))):r||(c=Xc(n,s),c!=null&&a.push(sh(n,c,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var R2=/\r\n?/g,b2=/\u0000|\uFFFD/g;function QT(t){return(typeof t=="string"?t:""+t).replace(R2,`
`).replace(b2,"")}function tf(t,e,n){if(e=QT(e),QT(t)!==e&&n)throw Error(J(425))}function np(){}var ry=null,sy=null;function oy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ay=typeof setTimeout=="function"?setTimeout:void 0,k2=typeof clearTimeout=="function"?clearTimeout:void 0,YT=typeof Promise=="function"?Promise:void 0,N2=typeof queueMicrotask=="function"?queueMicrotask:typeof YT<"u"?function(t){return YT.resolve(null).then(t).catch(L2)}:ay;function L2(t){setTimeout(function(){throw t})}function Hg(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),th(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);th(e)}function ks(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function XT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var iu=Math.random().toString(36).slice(2),Xi="__reactFiber$"+iu,oh="__reactProps$"+iu,Wr="__reactContainer$"+iu,ly="__reactEvents$"+iu,D2="__reactListeners$"+iu,M2="__reactHandles$"+iu;function Do(t){var e=t[Xi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wr]||n[Xi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=XT(t);t!==null;){if(n=t[Xi])return n;t=XT(t)}return e}t=n,n=t.parentNode}return null}function Hh(t){return t=t[Xi]||t[Wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function nl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function dm(t){return t[oh]||null}var uy=[],il=-1;function ro(t){return{current:t}}function tt(t){0>il||(t.current=uy[il],uy[il]=null,il--)}function Qe(t,e){il++,uy[il]=t.current,t.current=e}var Ws={},gn=ro(Ws),Fn=ro(!1),Qo=Ws;function Ll(t,e){var n=t.type.contextTypes;if(!n)return Ws;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function jn(t){return t=t.childContextTypes,t!=null}function ip(){tt(Fn),tt(gn)}function JT(t,e,n){if(gn.current!==Ws)throw Error(J(168));Qe(gn,e),Qe(Fn,n)}function wP(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(J(108,vM(t)||"Unknown",r));return dt({},n,i)}function rp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ws,Qo=gn.current,Qe(gn,t),Qe(Fn,Fn.current),!0}function ex(t,e,n){var i=t.stateNode;if(!i)throw Error(J(169));n?(t=wP(t,e,Qo),i.__reactInternalMemoizedMergedChildContext=t,tt(Fn),tt(gn),Qe(gn,t)):tt(Fn),Qe(Fn,n)}var Nr=null,fm=!1,$g=!1;function EP(t){Nr===null?Nr=[t]:Nr.push(t)}function O2(t){fm=!0,EP(t)}function so(){if(!$g&&Nr!==null){$g=!0;var t=0,e=He;try{var n=Nr;for(He=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Nr=null,fm=!1}catch(r){throw Nr!==null&&(Nr=Nr.slice(t+1)),qI(Jv,so),r}finally{He=e,$g=!1}}return null}var rl=[],sl=0,sp=null,op=0,ni=[],ii=0,Yo=null,Lr=1,Dr="";function Ao(t,e){rl[sl++]=op,rl[sl++]=sp,sp=t,op=e}function TP(t,e,n){ni[ii++]=Lr,ni[ii++]=Dr,ni[ii++]=Yo,Yo=t;var i=Lr;t=Dr;var r=32-ki(i)-1;i&=~(1<<r),n+=1;var s=32-ki(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Lr=1<<32-ki(e)+r|n<<r|i,Dr=s+t}else Lr=1<<s|n<<r|i,Dr=t}function l0(t){t.return!==null&&(Ao(t,1),TP(t,1,0))}function u0(t){for(;t===sp;)sp=rl[--sl],rl[sl]=null,op=rl[--sl],rl[sl]=null;for(;t===Yo;)Yo=ni[--ii],ni[ii]=null,Dr=ni[--ii],ni[ii]=null,Lr=ni[--ii],ni[ii]=null}var Gn=null,$n=null,it=!1,Pi=null;function xP(t,e){var n=oi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gn=t,$n=ks(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gn=t,$n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Yo!==null?{id:Lr,overflow:Dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=oi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gn=t,$n=null,!0):!1;default:return!1}}function cy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hy(t){if(it){var e=$n;if(e){var n=e;if(!tx(t,e)){if(cy(t))throw Error(J(418));e=ks(n.nextSibling);var i=Gn;e&&tx(t,e)?xP(i,n):(t.flags=t.flags&-4097|2,it=!1,Gn=t)}}else{if(cy(t))throw Error(J(418));t.flags=t.flags&-4097|2,it=!1,Gn=t}}}function nx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gn=t}function nf(t){if(t!==Gn)return!1;if(!it)return nx(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oy(t.type,t.memoizedProps)),e&&(e=$n)){if(cy(t))throw SP(),Error(J(418));for(;e;)xP(t,e),e=ks(e.nextSibling)}if(nx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$n=ks(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$n=null}}else $n=Gn?ks(t.stateNode.nextSibling):null;return!0}function SP(){for(var t=$n;t;)t=ks(t.nextSibling)}function Dl(){$n=Gn=null,it=!1}function c0(t){Pi===null?Pi=[t]:Pi.push(t)}var V2=es.ReactCurrentBatchConfig;function ic(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var i=n.stateNode}if(!i)throw Error(J(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var u=r.refs;a===null?delete u[s]:u[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function rf(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ix(t){var e=t._init;return e(t._payload)}function CP(t){function e(C,S){if(t){var R=C.deletions;R===null?(C.deletions=[S],C.flags|=16):R.push(S)}}function n(C,S){if(!t)return null;for(;S!==null;)e(C,S),S=S.sibling;return null}function i(C,S){for(C=new Map;S!==null;)S.key!==null?C.set(S.key,S):C.set(S.index,S),S=S.sibling;return C}function r(C,S){return C=Ms(C,S),C.index=0,C.sibling=null,C}function s(C,S,R){return C.index=R,t?(R=C.alternate,R!==null?(R=R.index,R<S?(C.flags|=2,S):R):(C.flags|=2,S)):(C.flags|=1048576,S)}function a(C){return t&&C.alternate===null&&(C.flags|=2),C}function u(C,S,R,U){return S===null||S.tag!==6?(S=Xg(R,C.mode,U),S.return=C,S):(S=r(S,R),S.return=C,S)}function c(C,S,R,U){var W=R.type;return W===Xa?p(C,S,R.props.children,U,R.key):S!==null&&(S.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===gs&&ix(W)===S.type)?(U=r(S,R.props),U.ref=ic(C,S,R),U.return=C,U):(U=Nf(R.type,R.key,R.props,null,C.mode,U),U.ref=ic(C,S,R),U.return=C,U)}function h(C,S,R,U){return S===null||S.tag!==4||S.stateNode.containerInfo!==R.containerInfo||S.stateNode.implementation!==R.implementation?(S=Jg(R,C.mode,U),S.return=C,S):(S=r(S,R.children||[]),S.return=C,S)}function p(C,S,R,U,W){return S===null||S.tag!==7?(S=Wo(R,C.mode,U,W),S.return=C,S):(S=r(S,R),S.return=C,S)}function m(C,S,R){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Xg(""+S,C.mode,R),S.return=C,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case qd:return R=Nf(S.type,S.key,S.props,null,C.mode,R),R.ref=ic(C,null,S),R.return=C,R;case Ya:return S=Jg(S,C.mode,R),S.return=C,S;case gs:var U=S._init;return m(C,U(S._payload),R)}if(pc(S)||Xu(S))return S=Wo(S,C.mode,R,null),S.return=C,S;rf(C,S)}return null}function _(C,S,R,U){var W=S!==null?S.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return W!==null?null:u(C,S,""+R,U);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case qd:return R.key===W?c(C,S,R,U):null;case Ya:return R.key===W?h(C,S,R,U):null;case gs:return W=R._init,_(C,S,W(R._payload),U)}if(pc(R)||Xu(R))return W!==null?null:p(C,S,R,U,null);rf(C,R)}return null}function T(C,S,R,U,W){if(typeof U=="string"&&U!==""||typeof U=="number")return C=C.get(R)||null,u(S,C,""+U,W);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case qd:return C=C.get(U.key===null?R:U.key)||null,c(S,C,U,W);case Ya:return C=C.get(U.key===null?R:U.key)||null,h(S,C,U,W);case gs:var K=U._init;return T(C,S,R,K(U._payload),W)}if(pc(U)||Xu(U))return C=C.get(R)||null,p(S,C,U,W,null);rf(S,U)}return null}function A(C,S,R,U){for(var W=null,K=null,k=S,I=S=0,N=null;k!==null&&I<R.length;I++){k.index>I?(N=k,k=null):N=k.sibling;var O=_(C,k,R[I],U);if(O===null){k===null&&(k=N);break}t&&k&&O.alternate===null&&e(C,k),S=s(O,S,I),K===null?W=O:K.sibling=O,K=O,k=N}if(I===R.length)return n(C,k),it&&Ao(C,I),W;if(k===null){for(;I<R.length;I++)k=m(C,R[I],U),k!==null&&(S=s(k,S,I),K===null?W=k:K.sibling=k,K=k);return it&&Ao(C,I),W}for(k=i(C,k);I<R.length;I++)N=T(k,C,I,R[I],U),N!==null&&(t&&N.alternate!==null&&k.delete(N.key===null?I:N.key),S=s(N,S,I),K===null?W=N:K.sibling=N,K=N);return t&&k.forEach(function(M){return e(C,M)}),it&&Ao(C,I),W}function b(C,S,R,U){var W=Xu(R);if(typeof W!="function")throw Error(J(150));if(R=W.call(R),R==null)throw Error(J(151));for(var K=W=null,k=S,I=S=0,N=null,O=R.next();k!==null&&!O.done;I++,O=R.next()){k.index>I?(N=k,k=null):N=k.sibling;var M=_(C,k,O.value,U);if(M===null){k===null&&(k=N);break}t&&k&&M.alternate===null&&e(C,k),S=s(M,S,I),K===null?W=M:K.sibling=M,K=M,k=N}if(O.done)return n(C,k),it&&Ao(C,I),W;if(k===null){for(;!O.done;I++,O=R.next())O=m(C,O.value,U),O!==null&&(S=s(O,S,I),K===null?W=O:K.sibling=O,K=O);return it&&Ao(C,I),W}for(k=i(C,k);!O.done;I++,O=R.next())O=T(k,C,I,O.value,U),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?I:O.key),S=s(O,S,I),K===null?W=O:K.sibling=O,K=O);return t&&k.forEach(function(j){return e(C,j)}),it&&Ao(C,I),W}function V(C,S,R,U){if(typeof R=="object"&&R!==null&&R.type===Xa&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case qd:e:{for(var W=R.key,K=S;K!==null;){if(K.key===W){if(W=R.type,W===Xa){if(K.tag===7){n(C,K.sibling),S=r(K,R.props.children),S.return=C,C=S;break e}}else if(K.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===gs&&ix(W)===K.type){n(C,K.sibling),S=r(K,R.props),S.ref=ic(C,K,R),S.return=C,C=S;break e}n(C,K);break}else e(C,K);K=K.sibling}R.type===Xa?(S=Wo(R.props.children,C.mode,U,R.key),S.return=C,C=S):(U=Nf(R.type,R.key,R.props,null,C.mode,U),U.ref=ic(C,S,R),U.return=C,C=U)}return a(C);case Ya:e:{for(K=R.key;S!==null;){if(S.key===K)if(S.tag===4&&S.stateNode.containerInfo===R.containerInfo&&S.stateNode.implementation===R.implementation){n(C,S.sibling),S=r(S,R.children||[]),S.return=C,C=S;break e}else{n(C,S);break}else e(C,S);S=S.sibling}S=Jg(R,C.mode,U),S.return=C,C=S}return a(C);case gs:return K=R._init,V(C,S,K(R._payload),U)}if(pc(R))return A(C,S,R,U);if(Xu(R))return b(C,S,R,U);rf(C,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,S!==null&&S.tag===6?(n(C,S.sibling),S=r(S,R),S.return=C,C=S):(n(C,S),S=Xg(R,C.mode,U),S.return=C,C=S),a(C)):n(C,S)}return V}var Ml=CP(!0),IP=CP(!1),ap=ro(null),lp=null,ol=null,h0=null;function d0(){h0=ol=lp=null}function f0(t){var e=ap.current;tt(ap),t._currentValue=e}function dy(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function wl(t,e){lp=t,h0=ol=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dn=!0),t.firstContext=null)}function fi(t){var e=t._currentValue;if(h0!==t)if(t={context:t,memoizedValue:e,next:null},ol===null){if(lp===null)throw Error(J(308));ol=t,lp.dependencies={lanes:0,firstContext:t}}else ol=ol.next=t;return e}var Mo=null;function p0(t){Mo===null?Mo=[t]:Mo.push(t)}function PP(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,p0(e)):(n.next=r.next,r.next=n),e.interleaved=n,Hr(t,i)}function Hr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _s=!1;function m0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function AP(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ns(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,je&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Hr(t,n)}return r=i.interleaved,r===null?(e.next=e,p0(i)):(e.next=r.next,r.next=e),i.interleaved=e,Hr(t,n)}function If(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,e0(t,n)}}function rx(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function up(t,e,n,i){var r=t.updateQueue;_s=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,u=r.shared.pending;if(u!==null){r.shared.pending=null;var c=u,h=c.next;c.next=null,a===null?s=h:a.next=h,a=c;var p=t.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==a&&(u===null?p.firstBaseUpdate=h:u.next=h,p.lastBaseUpdate=c))}if(s!==null){var m=r.baseState;a=0,p=h=c=null,u=s;do{var _=u.lane,T=u.eventTime;if((i&_)===_){p!==null&&(p=p.next={eventTime:T,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var A=t,b=u;switch(_=e,T=n,b.tag){case 1:if(A=b.payload,typeof A=="function"){m=A.call(T,m,_);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=b.payload,_=typeof A=="function"?A.call(T,m,_):A,_==null)break e;m=dt({},m,_);break e;case 2:_s=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,_=r.effects,_===null?r.effects=[u]:_.push(u))}else T={eventTime:T,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(h=p=T,c=m):p=p.next=T,a|=_;if(u=u.next,u===null){if(u=r.shared.pending,u===null)break;_=u,u=_.next,_.next=null,r.lastBaseUpdate=_,r.shared.pending=null}}while(1);if(p===null&&(c=m),r.baseState=c,r.firstBaseUpdate=h,r.lastBaseUpdate=p,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Jo|=a,t.lanes=a,t.memoizedState=m}}function sx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(J(191,r));r.call(i)}}}var $h={},nr=ro($h),ah=ro($h),lh=ro($h);function Oo(t){if(t===$h)throw Error(J(174));return t}function g0(t,e){switch(Qe(lh,e),Qe(ah,t),Qe(nr,$h),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:q_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=q_(e,t)}tt(nr),Qe(nr,e)}function Ol(){tt(nr),tt(ah),tt(lh)}function RP(t){Oo(lh.current);var e=Oo(nr.current),n=q_(e,t.type);e!==n&&(Qe(ah,t),Qe(nr,n))}function _0(t){ah.current===t&&(tt(nr),tt(ah))}var at=ro(0);function cp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qg=[];function y0(){for(var t=0;t<qg.length;t++)qg[t]._workInProgressVersionPrimary=null;qg.length=0}var Pf=es.ReactCurrentDispatcher,Gg=es.ReactCurrentBatchConfig,Xo=0,ht=null,Ot=null,$t=null,hp=!1,kc=!1,uh=0,F2=0;function un(){throw Error(J(321))}function v0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mi(t[n],e[n]))return!1;return!0}function w0(t,e,n,i,r,s){if(Xo=s,ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pf.current=t===null||t.memoizedState===null?z2:W2,t=n(i,r),kc){s=0;do{if(kc=!1,uh=0,25<=s)throw Error(J(301));s+=1,$t=Ot=null,e.updateQueue=null,Pf.current=H2,t=n(i,r)}while(kc)}if(Pf.current=dp,e=Ot!==null&&Ot.next!==null,Xo=0,$t=Ot=ht=null,hp=!1,e)throw Error(J(300));return t}function E0(){var t=uh!==0;return uh=0,t}function Qi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?ht.memoizedState=$t=t:$t=$t.next=t,$t}function pi(){if(Ot===null){var t=ht.alternate;t=t!==null?t.memoizedState:null}else t=Ot.next;var e=$t===null?ht.memoizedState:$t.next;if(e!==null)$t=e,Ot=t;else{if(t===null)throw Error(J(310));Ot=t,t={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},$t===null?ht.memoizedState=$t=t:$t=$t.next=t}return $t}function ch(t,e){return typeof e=="function"?e(t):e}function Kg(t){var e=pi(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var i=Ot,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var u=a=null,c=null,h=s;do{var p=h.lane;if((Xo&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:t(i,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(u=c=m,a=i):c=c.next=m,ht.lanes|=p,Jo|=p}h=h.next}while(h!==null&&h!==s);c===null?a=i:c.next=u,Mi(i,e.memoizedState)||(Dn=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=c,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,ht.lanes|=s,Jo|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Zg(t){var e=pi(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);Mi(s,e.memoizedState)||(Dn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function bP(){}function kP(t,e){var n=ht,i=pi(),r=e(),s=!Mi(i.memoizedState,r);if(s&&(i.memoizedState=r,Dn=!0),i=i.queue,T0(DP.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||$t!==null&&$t.memoizedState.tag&1){if(n.flags|=2048,hh(9,LP.bind(null,n,i,r,e),void 0,null),Zt===null)throw Error(J(349));Xo&30||NP(n,e,r)}return r}function NP(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function LP(t,e,n,i){e.value=n,e.getSnapshot=i,MP(e)&&OP(t)}function DP(t,e,n){return n(function(){MP(e)&&OP(t)})}function MP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mi(t,n)}catch{return!0}}function OP(t){var e=Hr(t,1);e!==null&&Ni(e,t,1,-1)}function ox(t){var e=Qi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ch,lastRenderedState:t},e.queue=t,t=t.dispatch=B2.bind(null,ht,t),[e.memoizedState,t]}function hh(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function VP(){return pi().memoizedState}function Af(t,e,n,i){var r=Qi();ht.flags|=t,r.memoizedState=hh(1|e,n,void 0,i===void 0?null:i)}function pm(t,e,n,i){var r=pi();i=i===void 0?null:i;var s=void 0;if(Ot!==null){var a=Ot.memoizedState;if(s=a.destroy,i!==null&&v0(i,a.deps)){r.memoizedState=hh(e,n,s,i);return}}ht.flags|=t,r.memoizedState=hh(1|e,n,s,i)}function ax(t,e){return Af(8390656,8,t,e)}function T0(t,e){return pm(2048,8,t,e)}function FP(t,e){return pm(4,2,t,e)}function jP(t,e){return pm(4,4,t,e)}function UP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BP(t,e,n){return n=n!=null?n.concat([t]):null,pm(4,4,UP.bind(null,e,t),n)}function x0(){}function zP(t,e){var n=pi();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v0(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function WP(t,e){var n=pi();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v0(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function HP(t,e,n){return Xo&21?(Mi(n,e)||(n=ZI(),ht.lanes|=n,Jo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dn=!0),t.memoizedState=n)}function j2(t,e){var n=He;He=n!==0&&4>n?n:4,t(!0);var i=Gg.transition;Gg.transition={};try{t(!1),e()}finally{He=n,Gg.transition=i}}function $P(){return pi().memoizedState}function U2(t,e,n){var i=Ds(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},qP(t))GP(e,n);else if(n=PP(t,e,n,i),n!==null){var r=xn();Ni(n,t,i,r),KP(n,e,i)}}function B2(t,e,n){var i=Ds(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(qP(t))GP(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,u=s(a,n);if(r.hasEagerState=!0,r.eagerState=u,Mi(u,a)){var c=e.interleaved;c===null?(r.next=r,p0(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=PP(t,e,r,i),n!==null&&(r=xn(),Ni(n,t,i,r),KP(n,e,i))}}function qP(t){var e=t.alternate;return t===ht||e!==null&&e===ht}function GP(t,e){kc=hp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function KP(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,e0(t,n)}}var dp={readContext:fi,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},z2={readContext:fi,useCallback:function(t,e){return Qi().memoizedState=[t,e===void 0?null:e],t},useContext:fi,useEffect:ax,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Af(4194308,4,UP.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Af(4194308,4,t,e)},useInsertionEffect:function(t,e){return Af(4,2,t,e)},useMemo:function(t,e){var n=Qi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Qi();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=U2.bind(null,ht,t),[i.memoizedState,t]},useRef:function(t){var e=Qi();return t={current:t},e.memoizedState=t},useState:ox,useDebugValue:x0,useDeferredValue:function(t){return Qi().memoizedState=t},useTransition:function(){var t=ox(!1),e=t[0];return t=j2.bind(null,t[1]),Qi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=ht,r=Qi();if(it){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),Zt===null)throw Error(J(349));Xo&30||NP(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,ax(DP.bind(null,i,s,t),[t]),i.flags|=2048,hh(9,LP.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Qi(),e=Zt.identifierPrefix;if(it){var n=Dr,i=Lr;n=(i&~(1<<32-ki(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=uh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=F2++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},W2={readContext:fi,useCallback:zP,useContext:fi,useEffect:T0,useImperativeHandle:BP,useInsertionEffect:FP,useLayoutEffect:jP,useMemo:WP,useReducer:Kg,useRef:VP,useState:function(){return Kg(ch)},useDebugValue:x0,useDeferredValue:function(t){var e=pi();return HP(e,Ot.memoizedState,t)},useTransition:function(){var t=Kg(ch)[0],e=pi().memoizedState;return[t,e]},useMutableSource:bP,useSyncExternalStore:kP,useId:$P,unstable_isNewReconciler:!1},H2={readContext:fi,useCallback:zP,useContext:fi,useEffect:T0,useImperativeHandle:BP,useInsertionEffect:FP,useLayoutEffect:jP,useMemo:WP,useReducer:Zg,useRef:VP,useState:function(){return Zg(ch)},useDebugValue:x0,useDeferredValue:function(t){var e=pi();return Ot===null?e.memoizedState=t:HP(e,Ot.memoizedState,t)},useTransition:function(){var t=Zg(ch)[0],e=pi().memoizedState;return[t,e]},useMutableSource:bP,useSyncExternalStore:kP,useId:$P,unstable_isNewReconciler:!1};function Ci(t,e){if(t&&t.defaultProps){e=dt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fy(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:dt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mm={isMounted:function(t){return(t=t._reactInternals)?ha(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=xn(),r=Ds(t),s=Fr(i,r);s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,r),e!==null&&(Ni(e,t,r,i),If(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=xn(),r=Ds(t),s=Fr(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,r),e!==null&&(Ni(e,t,r,i),If(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),i=Ds(t),r=Fr(n,i);r.tag=2,e!=null&&(r.callback=e),e=Ns(t,r,i),e!==null&&(Ni(e,t,i,n),If(e,t,i))}};function lx(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!ih(n,i)||!ih(r,s):!0}function ZP(t,e,n){var i=!1,r=Ws,s=e.contextType;return typeof s=="object"&&s!==null?s=fi(s):(r=jn(e)?Qo:gn.current,i=e.contextTypes,s=(i=i!=null)?Ll(t,r):Ws),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mm,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function ux(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&mm.enqueueReplaceState(e,e.state,null)}function py(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},m0(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=fi(s):(s=jn(e)?Qo:gn.current,r.context=Ll(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fy(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&mm.enqueueReplaceState(r,r.state,null),up(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Vl(t,e){try{var n="",i=e;do n+=yM(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function Qg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function my(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $2=typeof WeakMap=="function"?WeakMap:Map;function QP(t,e,n){n=Fr(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){pp||(pp=!0,Cy=i),my(t,e)},n}function YP(t,e,n){n=Fr(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){my(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){my(t,e),typeof i!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function cx(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new $2;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=sO.bind(null,t,e,n),e.then(t,t))}function hx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dx(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fr(-1,1),e.tag=2,Ns(n,e,1))),n.lanes|=1),t)}var q2=es.ReactCurrentOwner,Dn=!1;function wn(t,e,n,i){e.child=t===null?IP(e,null,n,i):Ml(e,t.child,n,i)}function fx(t,e,n,i,r){n=n.render;var s=e.ref;return wl(e,r),i=w0(t,e,n,i,s,r),n=E0(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,$r(t,e,r)):(it&&n&&l0(e),e.flags|=1,wn(t,e,i,r),e.child)}function px(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!k0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,XP(t,e,s,i,r)):(t=Nf(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:ih,n(a,i)&&t.ref===e.ref)return $r(t,e,r)}return e.flags|=1,t=Ms(s,i),t.ref=e.ref,t.return=e,e.child=t}function XP(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(ih(s,i)&&t.ref===e.ref)if(Dn=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Dn=!0);else return e.lanes=t.lanes,$r(t,e,r)}return gy(t,e,n,i,r)}function JP(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(ll,Hn),Hn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Qe(ll,Hn),Hn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Qe(ll,Hn),Hn|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Qe(ll,Hn),Hn|=i;return wn(t,e,r,n),e.child}function eA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gy(t,e,n,i,r){var s=jn(n)?Qo:gn.current;return s=Ll(e,s),wl(e,r),n=w0(t,e,n,i,s,r),i=E0(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,$r(t,e,r)):(it&&i&&l0(e),e.flags|=1,wn(t,e,n,r),e.child)}function mx(t,e,n,i,r){if(jn(n)){var s=!0;rp(e)}else s=!1;if(wl(e,r),e.stateNode===null)Rf(t,e),ZP(e,n,i),py(e,n,i,r),i=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=fi(h):(h=jn(n)?Qo:gn.current,h=Ll(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==i||c!==h)&&ux(e,a,i,h),_s=!1;var _=e.memoizedState;a.state=_,up(e,i,a,r),c=e.memoizedState,u!==i||_!==c||Fn.current||_s?(typeof p=="function"&&(fy(e,n,p,i),c=e.memoizedState),(u=_s||lx(e,n,u,i,_,c,h))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),a.props=i,a.state=c,a.context=h,i=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,AP(t,e),u=e.memoizedProps,h=e.type===e.elementType?u:Ci(e.type,u),a.props=h,m=e.pendingProps,_=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=fi(c):(c=jn(n)?Qo:gn.current,c=Ll(e,c));var T=n.getDerivedStateFromProps;(p=typeof T=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==m||_!==c)&&ux(e,a,i,c),_s=!1,_=e.memoizedState,a.state=_,up(e,i,a,r);var A=e.memoizedState;u!==m||_!==A||Fn.current||_s?(typeof T=="function"&&(fy(e,n,T,i),A=e.memoizedState),(h=_s||lx(e,n,h,i,_,A,c)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,A,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,A,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=A),a.props=i,a.state=A,a.context=c,i=h):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),i=!1)}return _y(t,e,n,i,s,r)}function _y(t,e,n,i,r,s){eA(t,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&ex(e,n,!1),$r(t,e,s);i=e.stateNode,q2.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&a?(e.child=Ml(e,t.child,null,s),e.child=Ml(e,null,u,s)):wn(t,e,u,s),e.memoizedState=i.state,r&&ex(e,n,!0),e.child}function tA(t){var e=t.stateNode;e.pendingContext?JT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&JT(t,e.context,!1),g0(t,e.containerInfo)}function gx(t,e,n,i,r){return Dl(),c0(r),e.flags|=256,wn(t,e,n,i),e.child}var yy={dehydrated:null,treeContext:null,retryLane:0};function vy(t){return{baseLanes:t,cachePool:null,transitions:null}}function nA(t,e,n){var i=e.pendingProps,r=at.current,s=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(r&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Qe(at,r&1),t===null)return hy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,t=i.fallback,s?(i=e.mode,s=e.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ym(a,i,0,null),t=Wo(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=vy(n),e.memoizedState=yy,t):S0(e,a));if(r=t.memoizedState,r!==null&&(u=r.dehydrated,u!==null))return G2(t,e,a,i,u,r,n);if(s){s=i.fallback,a=e.mode,r=t.child,u=r.sibling;var c={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=Ms(r,c),i.subtreeFlags=r.subtreeFlags&14680064),u!==null?s=Ms(u,s):(s=Wo(s,a,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,a=t.child.memoizedState,a=a===null?vy(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=yy,i}return s=t.child,t=s.sibling,i=Ms(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function S0(t,e){return e=ym({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function sf(t,e,n,i){return i!==null&&c0(i),Ml(e,t.child,null,n),t=S0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function G2(t,e,n,i,r,s,a){if(n)return e.flags&256?(e.flags&=-257,i=Qg(Error(J(422))),sf(t,e,a,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=ym({mode:"visible",children:i.children},r,0,null),s=Wo(s,r,a,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Ml(e,t.child,null,a),e.child.memoizedState=vy(a),e.memoizedState=yy,s);if(!(e.mode&1))return sf(t,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var u=i.dgst;return i=u,s=Error(J(419)),i=Qg(s,i,void 0),sf(t,e,a,i)}if(u=(a&t.childLanes)!==0,Dn||u){if(i=Zt,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Hr(t,r),Ni(i,t,r,-1))}return b0(),i=Qg(Error(J(421))),sf(t,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=oO.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,$n=ks(r.nextSibling),Gn=e,it=!0,Pi=null,t!==null&&(ni[ii++]=Lr,ni[ii++]=Dr,ni[ii++]=Yo,Lr=t.id,Dr=t.overflow,Yo=e),e=S0(e,i.children),e.flags|=4096,e)}function _x(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),dy(t.return,e,n)}function Yg(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function iA(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(wn(t,e,i.children,n),i=at.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_x(t,n,e);else if(t.tag===19)_x(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Qe(at,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&cp(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Yg(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&cp(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Yg(e,!0,n,null,s);break;case"together":Yg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $r(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Jo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=Ms(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ms(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function K2(t,e,n){switch(e.tag){case 3:tA(e),Dl();break;case 5:RP(e);break;case 1:jn(e.type)&&rp(e);break;case 4:g0(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Qe(ap,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Qe(at,at.current&1),e.flags|=128,null):n&e.child.childLanes?nA(t,e,n):(Qe(at,at.current&1),t=$r(t,e,n),t!==null?t.sibling:null);Qe(at,at.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return iA(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Qe(at,at.current),i)break;return null;case 22:case 23:return e.lanes=0,JP(t,e,n)}return $r(t,e,n)}var rA,wy,sA,oA;rA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wy=function(){};sA=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Oo(nr.current);var s=null;switch(n){case"input":r=z_(t,r),i=z_(t,i),s=[];break;case"select":r=dt({},r,{value:void 0}),i=dt({},i,{value:void 0}),s=[];break;case"textarea":r=$_(t,r),i=$_(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=np)}G_(n,i);var a;n=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var u=r[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Qc.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(u=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&c!==u&&(c!=null||u!=null))if(h==="style")if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Qc.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Xe("scroll",t),s||u===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};oA=function(t,e,n,i){n!==i&&(e.flags|=4)};function rc(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function cn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Z2(t,e,n){var i=e.pendingProps;switch(u0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(e),null;case 1:return jn(e.type)&&ip(),cn(e),null;case 3:return i=e.stateNode,Ol(),tt(Fn),tt(gn),y0(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(nf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Pi!==null&&(Ay(Pi),Pi=null))),wy(t,e),cn(e),null;case 5:_0(e);var r=Oo(lh.current);if(n=e.type,t!==null&&e.stateNode!=null)sA(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(J(166));return cn(e),null}if(t=Oo(nr.current),nf(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Xi]=e,i[oh]=s,t=(e.mode&1)!==0,n){case"dialog":Xe("cancel",i),Xe("close",i);break;case"iframe":case"object":case"embed":Xe("load",i);break;case"video":case"audio":for(r=0;r<gc.length;r++)Xe(gc[r],i);break;case"source":Xe("error",i);break;case"img":case"image":case"link":Xe("error",i),Xe("load",i);break;case"details":Xe("toggle",i);break;case"input":IT(i,s),Xe("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Xe("invalid",i);break;case"textarea":AT(i,s),Xe("invalid",i)}G_(n,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];a==="children"?typeof u=="string"?i.textContent!==u&&(s.suppressHydrationWarning!==!0&&tf(i.textContent,u,t),r=["children",u]):typeof u=="number"&&i.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&tf(i.textContent,u,t),r=["children",""+u]):Qc.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&Xe("scroll",i)}switch(n){case"input":Gd(i),PT(i,s,!0);break;case"textarea":Gd(i),RT(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=np)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=a.createElement(n,{is:i.is}):(t=a.createElement(n),n==="select"&&(a=t,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):t=a.createElementNS(t,n),t[Xi]=e,t[oh]=i,rA(t,e,!1,!1),e.stateNode=t;e:{switch(a=K_(n,i),n){case"dialog":Xe("cancel",t),Xe("close",t),r=i;break;case"iframe":case"object":case"embed":Xe("load",t),r=i;break;case"video":case"audio":for(r=0;r<gc.length;r++)Xe(gc[r],t);r=i;break;case"source":Xe("error",t),r=i;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),r=i;break;case"details":Xe("toggle",t),r=i;break;case"input":IT(t,i),r=z_(t,i),Xe("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=dt({},i,{value:void 0}),Xe("invalid",t);break;case"textarea":AT(t,i),r=$_(t,i),Xe("invalid",t);break;default:r=i}G_(n,r),u=r;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?VI(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&MI(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Yc(t,c):typeof c=="number"&&Yc(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Qc.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Xe("scroll",t):c!=null&&Kv(t,s,c,a))}switch(n){case"input":Gd(t),PT(t,i,!1);break;case"textarea":Gd(t),RT(t);break;case"option":i.value!=null&&t.setAttribute("value",""+zs(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?gl(t,!!i.multiple,s,!1):i.defaultValue!=null&&gl(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=np)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return cn(e),null;case 6:if(t&&e.stateNode!=null)oA(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(J(166));if(n=Oo(lh.current),Oo(nr.current),nf(e)){if(i=e.stateNode,n=e.memoizedProps,i[Xi]=e,(s=i.nodeValue!==n)&&(t=Gn,t!==null))switch(t.tag){case 3:tf(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tf(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Xi]=e,e.stateNode=i}return cn(e),null;case 13:if(tt(at),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&$n!==null&&e.mode&1&&!(e.flags&128))SP(),Dl(),e.flags|=98560,s=!1;else if(s=nf(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(J(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(J(317));s[Xi]=e}else Dl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;cn(e),s=!1}else Pi!==null&&(Ay(Pi),Pi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?Ft===0&&(Ft=3):b0())),e.updateQueue!==null&&(e.flags|=4),cn(e),null);case 4:return Ol(),wy(t,e),t===null&&rh(e.stateNode.containerInfo),cn(e),null;case 10:return f0(e.type._context),cn(e),null;case 17:return jn(e.type)&&ip(),cn(e),null;case 19:if(tt(at),s=e.memoizedState,s===null)return cn(e),null;if(i=(e.flags&128)!==0,a=s.rendering,a===null)if(i)rc(s,!1);else{if(Ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=cp(t),a!==null){for(e.flags|=128,rc(s,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Qe(at,at.current&1|2),e.child}t=t.sibling}s.tail!==null&&Et()>Fl&&(e.flags|=128,i=!0,rc(s,!1),e.lanes=4194304)}else{if(!i)if(t=cp(a),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!it)return cn(e),null}else 2*Et()-s.renderingStartTime>Fl&&n!==1073741824&&(e.flags|=128,i=!0,rc(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Et(),e.sibling=null,n=at.current,Qe(at,i?n&1|2:n&1),e):(cn(e),null);case 22:case 23:return R0(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Hn&1073741824&&(cn(e),e.subtreeFlags&6&&(e.flags|=8192)):cn(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function Q2(t,e){switch(u0(e),e.tag){case 1:return jn(e.type)&&ip(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ol(),tt(Fn),tt(gn),y0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _0(e),null;case 13:if(tt(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Dl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tt(at),null;case 4:return Ol(),null;case 10:return f0(e.type._context),null;case 22:case 23:return R0(),null;case 24:return null;default:return null}}var of=!1,fn=!1,Y2=typeof WeakSet=="function"?WeakSet:Set,se=null;function al(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){gt(t,e,i)}else n.current=null}function Ey(t,e,n){try{n()}catch(i){gt(t,e,i)}}var yx=!1;function X2(t,e){if(ry=Jf,t=hP(),a0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,u=-1,c=-1,h=0,p=0,m=t,_=null;t:for(;;){for(var T;m!==n||r!==0&&m.nodeType!==3||(u=a+r),m!==s||i!==0&&m.nodeType!==3||(c=a+i),m.nodeType===3&&(a+=m.nodeValue.length),(T=m.firstChild)!==null;)_=m,m=T;for(;;){if(m===t)break t;if(_===n&&++h===r&&(u=a),_===s&&++p===i&&(c=a),(T=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=T}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(sy={focusedElem:t,selectionRange:n},Jf=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var b=A.memoizedProps,V=A.memoizedState,C=e.stateNode,S=C.getSnapshotBeforeUpdate(e.elementType===e.type?b:Ci(e.type,b),V);C.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(U){gt(e,e.return,U)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return A=yx,yx=!1,A}function Nc(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&Ey(e,n,s)}r=r.next}while(r!==i)}}function gm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Ty(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function aA(t){var e=t.alternate;e!==null&&(t.alternate=null,aA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xi],delete e[oh],delete e[ly],delete e[D2],delete e[M2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lA(t){return t.tag===5||t.tag===3||t.tag===4}function vx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xy(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=np));else if(i!==4&&(t=t.child,t!==null))for(xy(t,e,n),t=t.sibling;t!==null;)xy(t,e,n),t=t.sibling}function Sy(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Sy(t,e,n),t=t.sibling;t!==null;)Sy(t,e,n),t=t.sibling}var Jt=null,Ii=!1;function fs(t,e,n){for(n=n.child;n!==null;)uA(t,e,n),n=n.sibling}function uA(t,e,n){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(lm,n)}catch{}switch(n.tag){case 5:fn||al(n,e);case 6:var i=Jt,r=Ii;Jt=null,fs(t,e,n),Jt=i,Ii=r,Jt!==null&&(Ii?(t=Jt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Jt.removeChild(n.stateNode));break;case 18:Jt!==null&&(Ii?(t=Jt,n=n.stateNode,t.nodeType===8?Hg(t.parentNode,n):t.nodeType===1&&Hg(t,n),th(t)):Hg(Jt,n.stateNode));break;case 4:i=Jt,r=Ii,Jt=n.stateNode.containerInfo,Ii=!0,fs(t,e,n),Jt=i,Ii=r;break;case 0:case 11:case 14:case 15:if(!fn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Ey(n,e,a),r=r.next}while(r!==i)}fs(t,e,n);break;case 1:if(!fn&&(al(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(u){gt(n,e,u)}fs(t,e,n);break;case 21:fs(t,e,n);break;case 22:n.mode&1?(fn=(i=fn)||n.memoizedState!==null,fs(t,e,n),fn=i):fs(t,e,n);break;default:fs(t,e,n)}}function wx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Y2),e.forEach(function(i){var r=aO.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function xi(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:Jt=u.stateNode,Ii=!1;break e;case 3:Jt=u.stateNode.containerInfo,Ii=!0;break e;case 4:Jt=u.stateNode.containerInfo,Ii=!0;break e}u=u.return}if(Jt===null)throw Error(J(160));uA(s,a,r),Jt=null,Ii=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(h){gt(r,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cA(e,t),e=e.sibling}function cA(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xi(e,t),Zi(t),i&4){try{Nc(3,t,t.return),gm(3,t)}catch(b){gt(t,t.return,b)}try{Nc(5,t,t.return)}catch(b){gt(t,t.return,b)}}break;case 1:xi(e,t),Zi(t),i&512&&n!==null&&al(n,n.return);break;case 5:if(xi(e,t),Zi(t),i&512&&n!==null&&al(n,n.return),t.flags&32){var r=t.stateNode;try{Yc(r,"")}catch(b){gt(t,t.return,b)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&NI(r,s),K_(u,a);var h=K_(u,s);for(a=0;a<c.length;a+=2){var p=c[a],m=c[a+1];p==="style"?VI(r,m):p==="dangerouslySetInnerHTML"?MI(r,m):p==="children"?Yc(r,m):Kv(r,p,m,h)}switch(u){case"input":W_(r,s);break;case"textarea":LI(r,s);break;case"select":var _=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var T=s.value;T!=null?gl(r,!!s.multiple,T,!1):_!==!!s.multiple&&(s.defaultValue!=null?gl(r,!!s.multiple,s.defaultValue,!0):gl(r,!!s.multiple,s.multiple?[]:"",!1))}r[oh]=s}catch(b){gt(t,t.return,b)}}break;case 6:if(xi(e,t),Zi(t),i&4){if(t.stateNode===null)throw Error(J(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(b){gt(t,t.return,b)}}break;case 3:if(xi(e,t),Zi(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{th(e.containerInfo)}catch(b){gt(t,t.return,b)}break;case 4:xi(e,t),Zi(t);break;case 13:xi(e,t),Zi(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(P0=Et())),i&4&&wx(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(fn=(h=fn)||p,xi(e,t),fn=h):xi(e,t),Zi(t),i&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(se=t,p=t.child;p!==null;){for(m=se=p;se!==null;){switch(_=se,T=_.child,_.tag){case 0:case 11:case 14:case 15:Nc(4,_,_.return);break;case 1:al(_,_.return);var A=_.stateNode;if(typeof A.componentWillUnmount=="function"){i=_,n=_.return;try{e=i,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(b){gt(i,n,b)}}break;case 5:al(_,_.return);break;case 22:if(_.memoizedState!==null){Tx(m);continue}}T!==null?(T.return=_,se=T):Tx(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{r=m.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=m.stateNode,c=m.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=OI("display",a))}catch(b){gt(t,t.return,b)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(b){gt(t,t.return,b)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:xi(e,t),Zi(t),i&4&&wx(t);break;case 21:break;default:xi(e,t),Zi(t)}}function Zi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(lA(n)){var i=n;break e}n=n.return}throw Error(J(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Yc(r,""),i.flags&=-33);var s=vx(t);Sy(t,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,u=vx(t);xy(t,u,a);break;default:throw Error(J(161))}}catch(c){gt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function J2(t,e,n){se=t,hA(t)}function hA(t,e,n){for(var i=(t.mode&1)!==0;se!==null;){var r=se,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||of;if(!a){var u=r.alternate,c=u!==null&&u.memoizedState!==null||fn;u=of;var h=fn;if(of=a,(fn=c)&&!h)for(se=r;se!==null;)a=se,c=a.child,a.tag===22&&a.memoizedState!==null?xx(r):c!==null?(c.return=a,se=c):xx(r);for(;s!==null;)se=s,hA(s),s=s.sibling;se=r,of=u,fn=h}Ex(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,se=s):Ex(t)}}function Ex(t){for(;se!==null;){var e=se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fn||gm(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!fn)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ci(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&sx(e,s,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sx(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&th(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}fn||e.flags&512&&Ty(e)}catch(_){gt(e,e.return,_)}}if(e===t){se=null;break}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}}function Tx(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,se=n;break}se=e.return}}function xx(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gm(4,e)}catch(c){gt(e,n,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){gt(e,r,c)}}var s=e.return;try{Ty(e)}catch(c){gt(e,s,c)}break;case 5:var a=e.return;try{Ty(e)}catch(c){gt(e,a,c)}}}catch(c){gt(e,e.return,c)}if(e===t){se=null;break}var u=e.sibling;if(u!==null){u.return=e.return,se=u;break}se=e.return}}var eO=Math.ceil,fp=es.ReactCurrentDispatcher,C0=es.ReactCurrentOwner,ci=es.ReactCurrentBatchConfig,je=0,Zt=null,Pt=null,nn=0,Hn=0,ll=ro(0),Ft=0,dh=null,Jo=0,_m=0,I0=0,Lc=null,kn=null,P0=0,Fl=1/0,kr=null,pp=!1,Cy=null,Ls=null,af=!1,Ss=null,mp=0,Dc=0,Iy=null,bf=-1,kf=0;function xn(){return je&6?Et():bf!==-1?bf:bf=Et()}function Ds(t){return t.mode&1?je&2&&nn!==0?nn&-nn:V2.transition!==null?(kf===0&&(kf=ZI()),kf):(t=He,t!==0||(t=window.event,t=t===void 0?16:nP(t.type)),t):1}function Ni(t,e,n,i){if(50<Dc)throw Dc=0,Iy=null,Error(J(185));zh(t,n,i),(!(je&2)||t!==Zt)&&(t===Zt&&(!(je&2)&&(_m|=n),Ft===4&&vs(t,nn)),Un(t,i),n===1&&je===0&&!(e.mode&1)&&(Fl=Et()+500,fm&&so()))}function Un(t,e){var n=t.callbackNode;VM(t,e);var i=Xf(t,t===Zt?nn:0);if(i===0)n!==null&&NT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&NT(n),e===1)t.tag===0?O2(Sx.bind(null,t)):EP(Sx.bind(null,t)),N2(function(){!(je&6)&&so()}),n=null;else{switch(QI(i)){case 1:n=Jv;break;case 4:n=GI;break;case 16:n=Yf;break;case 536870912:n=KI;break;default:n=Yf}n=vA(n,dA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dA(t,e){if(bf=-1,kf=0,je&6)throw Error(J(327));var n=t.callbackNode;if(El()&&t.callbackNode!==n)return null;var i=Xf(t,t===Zt?nn:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=gp(t,i);else{e=i;var r=je;je|=2;var s=pA();(Zt!==t||nn!==e)&&(kr=null,Fl=Et()+500,zo(t,e));do try{iO();break}catch(u){fA(t,u)}while(1);d0(),fp.current=s,je=r,Pt!==null?e=0:(Zt=null,nn=0,e=Ft)}if(e!==0){if(e===2&&(r=J_(t),r!==0&&(i=r,e=Py(t,r))),e===1)throw n=dh,zo(t,0),vs(t,i),Un(t,Et()),n;if(e===6)vs(t,i);else{if(r=t.current.alternate,!(i&30)&&!tO(r)&&(e=gp(t,i),e===2&&(s=J_(t),s!==0&&(i=s,e=Py(t,s))),e===1))throw n=dh,zo(t,0),vs(t,i),Un(t,Et()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(J(345));case 2:Ro(t,kn,kr);break;case 3:if(vs(t,i),(i&130023424)===i&&(e=P0+500-Et(),10<e)){if(Xf(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){xn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ay(Ro.bind(null,t,kn,kr),e);break}Ro(t,kn,kr);break;case 4:if(vs(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-ki(i);s=1<<a,a=e[a],a>r&&(r=a),i&=~s}if(i=r,i=Et()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*eO(i/1960))-i,10<i){t.timeoutHandle=ay(Ro.bind(null,t,kn,kr),i);break}Ro(t,kn,kr);break;case 5:Ro(t,kn,kr);break;default:throw Error(J(329))}}}return Un(t,Et()),t.callbackNode===n?dA.bind(null,t):null}function Py(t,e){var n=Lc;return t.current.memoizedState.isDehydrated&&(zo(t,e).flags|=256),t=gp(t,e),t!==2&&(e=kn,kn=n,e!==null&&Ay(e)),t}function Ay(t){kn===null?kn=t:kn.push.apply(kn,t)}function tO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Mi(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vs(t,e){for(e&=~I0,e&=~_m,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ki(e),i=1<<n;t[n]=-1,e&=~i}}function Sx(t){if(je&6)throw Error(J(327));El();var e=Xf(t,0);if(!(e&1))return Un(t,Et()),null;var n=gp(t,e);if(t.tag!==0&&n===2){var i=J_(t);i!==0&&(e=i,n=Py(t,i))}if(n===1)throw n=dh,zo(t,0),vs(t,e),Un(t,Et()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ro(t,kn,kr),Un(t,Et()),null}function A0(t,e){var n=je;je|=1;try{return t(e)}finally{je=n,je===0&&(Fl=Et()+500,fm&&so())}}function ea(t){Ss!==null&&Ss.tag===0&&!(je&6)&&El();var e=je;je|=1;var n=ci.transition,i=He;try{if(ci.transition=null,He=1,t)return t()}finally{He=i,ci.transition=n,je=e,!(je&6)&&so()}}function R0(){Hn=ll.current,tt(ll)}function zo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,k2(n)),Pt!==null)for(n=Pt.return;n!==null;){var i=n;switch(u0(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&ip();break;case 3:Ol(),tt(Fn),tt(gn),y0();break;case 5:_0(i);break;case 4:Ol();break;case 13:tt(at);break;case 19:tt(at);break;case 10:f0(i.type._context);break;case 22:case 23:R0()}n=n.return}if(Zt=t,Pt=t=Ms(t.current,null),nn=Hn=e,Ft=0,dh=null,I0=_m=Jo=0,kn=Lc=null,Mo!==null){for(e=0;e<Mo.length;e++)if(n=Mo[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}n.pending=i}Mo=null}return t}function fA(t,e){do{var n=Pt;try{if(d0(),Pf.current=dp,hp){for(var i=ht.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}hp=!1}if(Xo=0,$t=Ot=ht=null,kc=!1,uh=0,C0.current=null,n===null||n.return===null){Ft=1,dh=e,Pt=null;break}e:{var s=t,a=n.return,u=n,c=e;if(e=nn,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=u,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var T=hx(a);if(T!==null){T.flags&=-257,dx(T,a,u,s,e),T.mode&1&&cx(s,h,e),e=T,c=h;var A=e.updateQueue;if(A===null){var b=new Set;b.add(c),e.updateQueue=b}else A.add(c);break e}else{if(!(e&1)){cx(s,h,e),b0();break e}c=Error(J(426))}}else if(it&&u.mode&1){var V=hx(a);if(V!==null){!(V.flags&65536)&&(V.flags|=256),dx(V,a,u,s,e),c0(Vl(c,u));break e}}s=c=Vl(c,u),Ft!==4&&(Ft=2),Lc===null?Lc=[s]:Lc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=QP(s,c,e);rx(s,C);break e;case 1:u=c;var S=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Ls===null||!Ls.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var U=YP(s,u,e);rx(s,U);break e}}s=s.return}while(s!==null)}gA(n)}catch(W){e=W,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(1)}function pA(){var t=fp.current;return fp.current=dp,t===null?dp:t}function b0(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),Zt===null||!(Jo&268435455)&&!(_m&268435455)||vs(Zt,nn)}function gp(t,e){var n=je;je|=2;var i=pA();(Zt!==t||nn!==e)&&(kr=null,zo(t,e));do try{nO();break}catch(r){fA(t,r)}while(1);if(d0(),je=n,fp.current=i,Pt!==null)throw Error(J(261));return Zt=null,nn=0,Ft}function nO(){for(;Pt!==null;)mA(Pt)}function iO(){for(;Pt!==null&&!AM();)mA(Pt)}function mA(t){var e=yA(t.alternate,t,Hn);t.memoizedProps=t.pendingProps,e===null?gA(t):Pt=e,C0.current=null}function gA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Q2(n,e),n!==null){n.flags&=32767,Pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ft=6,Pt=null;return}}else if(n=Z2(n,e,Hn),n!==null){Pt=n;return}if(e=e.sibling,e!==null){Pt=e;return}Pt=e=t}while(e!==null);Ft===0&&(Ft=5)}function Ro(t,e,n){var i=He,r=ci.transition;try{ci.transition=null,He=1,rO(t,e,n,i)}finally{ci.transition=r,He=i}return null}function rO(t,e,n,i){do El();while(Ss!==null);if(je&6)throw Error(J(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(FM(t,s),t===Zt&&(Pt=Zt=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||af||(af=!0,vA(Yf,function(){return El(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ci.transition,ci.transition=null;var a=He;He=1;var u=je;je|=4,C0.current=null,X2(t,n),cA(n,t),S2(sy),Jf=!!ry,sy=ry=null,t.current=n,J2(n),RM(),je=u,He=a,ci.transition=s}else t.current=n;if(af&&(af=!1,Ss=t,mp=r),s=t.pendingLanes,s===0&&(Ls=null),NM(n.stateNode),Un(t,Et()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(pp)throw pp=!1,t=Cy,Cy=null,t;return mp&1&&t.tag!==0&&El(),s=t.pendingLanes,s&1?t===Iy?Dc++:(Dc=0,Iy=t):Dc=0,so(),null}function El(){if(Ss!==null){var t=QI(mp),e=ci.transition,n=He;try{if(ci.transition=null,He=16>t?16:t,Ss===null)var i=!1;else{if(t=Ss,Ss=null,mp=0,je&6)throw Error(J(331));var r=je;for(je|=4,se=t.current;se!==null;){var s=se,a=s.child;if(se.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var h=u[c];for(se=h;se!==null;){var p=se;switch(p.tag){case 0:case 11:case 15:Nc(8,p,s)}var m=p.child;if(m!==null)m.return=p,se=m;else for(;se!==null;){p=se;var _=p.sibling,T=p.return;if(aA(p),p===h){se=null;break}if(_!==null){_.return=T,se=_;break}se=T}}}var A=s.alternate;if(A!==null){var b=A.child;if(b!==null){A.child=null;do{var V=b.sibling;b.sibling=null,b=V}while(b!==null)}}se=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,se=a;else e:for(;se!==null;){if(s=se,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Nc(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,se=C;break e}se=s.return}}var S=t.current;for(se=S;se!==null;){a=se;var R=a.child;if(a.subtreeFlags&2064&&R!==null)R.return=a,se=R;else e:for(a=S;se!==null;){if(u=se,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:gm(9,u)}}catch(W){gt(u,u.return,W)}if(u===a){se=null;break e}var U=u.sibling;if(U!==null){U.return=u.return,se=U;break e}se=u.return}}if(je=r,so(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(lm,t)}catch{}i=!0}return i}finally{He=n,ci.transition=e}}return!1}function Cx(t,e,n){e=Vl(n,e),e=QP(t,e,1),t=Ns(t,e,1),e=xn(),t!==null&&(zh(t,1,e),Un(t,e))}function gt(t,e,n){if(t.tag===3)Cx(t,t,n);else for(;e!==null;){if(e.tag===3){Cx(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ls===null||!Ls.has(i))){t=Vl(n,t),t=YP(e,t,1),e=Ns(e,t,1),t=xn(),e!==null&&(zh(e,1,t),Un(e,t));break}}e=e.return}}function sO(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Zt===t&&(nn&n)===n&&(Ft===4||Ft===3&&(nn&130023424)===nn&&500>Et()-P0?zo(t,0):I0|=n),Un(t,e)}function _A(t,e){e===0&&(t.mode&1?(e=Qd,Qd<<=1,!(Qd&130023424)&&(Qd=4194304)):e=1);var n=xn();t=Hr(t,e),t!==null&&(zh(t,e,n),Un(t,n))}function oO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),_A(t,n)}function aO(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(J(314))}i!==null&&i.delete(e),_A(t,n)}var yA;yA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fn.current)Dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Dn=!1,K2(t,e,n);Dn=!!(t.flags&131072)}else Dn=!1,it&&e.flags&1048576&&TP(e,op,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Rf(t,e),t=e.pendingProps;var r=Ll(e,gn.current);wl(e,n),r=w0(null,e,i,t,r,n);var s=E0();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(i)?(s=!0,rp(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,m0(e),r.updater=mm,e.stateNode=r,r._reactInternals=e,py(e,i,t,n),e=_y(null,e,i,!0,s,n)):(e.tag=0,it&&s&&l0(e),wn(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Rf(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=uO(i),t=Ci(i,t),r){case 0:e=gy(null,e,i,t,n);break e;case 1:e=mx(null,e,i,t,n);break e;case 11:e=fx(null,e,i,t,n);break e;case 14:e=px(null,e,i,Ci(i.type,t),n);break e}throw Error(J(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ci(i,r),gy(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ci(i,r),mx(t,e,i,r,n);case 3:e:{if(tA(e),t===null)throw Error(J(387));i=e.pendingProps,s=e.memoizedState,r=s.element,AP(t,e),up(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Vl(Error(J(423)),e),e=gx(t,e,i,n,r);break e}else if(i!==r){r=Vl(Error(J(424)),e),e=gx(t,e,i,n,r);break e}else for($n=ks(e.stateNode.containerInfo.firstChild),Gn=e,it=!0,Pi=null,n=IP(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Dl(),i===r){e=$r(t,e,n);break e}wn(t,e,i,n)}e=e.child}return e;case 5:return RP(e),t===null&&hy(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,a=r.children,oy(i,r)?a=null:s!==null&&oy(i,s)&&(e.flags|=32),eA(t,e),wn(t,e,a,n),e.child;case 6:return t===null&&hy(e),null;case 13:return nA(t,e,n);case 4:return g0(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Ml(e,null,i,n):wn(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ci(i,r),fx(t,e,i,r,n);case 7:return wn(t,e,e.pendingProps,n),e.child;case 8:return wn(t,e,e.pendingProps.children,n),e.child;case 12:return wn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Qe(ap,i._currentValue),i._currentValue=a,s!==null)if(Mi(s.value,a)){if(s.children===r.children&&!Fn.current){e=$r(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){a=s.child;for(var c=u.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=Fr(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),dy(s.return,n,e),u.lanes|=n;break}c=c.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(J(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),dy(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}wn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,wl(e,n),r=fi(r),i=i(r),e.flags|=1,wn(t,e,i,n),e.child;case 14:return i=e.type,r=Ci(i,e.pendingProps),r=Ci(i.type,r),px(t,e,i,r,n);case 15:return XP(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ci(i,r),Rf(t,e),e.tag=1,jn(i)?(t=!0,rp(e)):t=!1,wl(e,n),ZP(e,i,r),py(e,i,r,n),_y(null,e,i,!0,t,n);case 19:return iA(t,e,n);case 22:return JP(t,e,n)}throw Error(J(156,e.tag))};function vA(t,e){return qI(t,e)}function lO(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(t,e,n,i){return new lO(t,e,n,i)}function k0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uO(t){if(typeof t=="function")return k0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Qv)return 11;if(t===Yv)return 14}return 2}function Ms(t,e){var n=t.alternate;return n===null?(n=oi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Nf(t,e,n,i,r,s){var a=2;if(i=t,typeof t=="function")k0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Xa:return Wo(n.children,r,s,e);case Zv:a=8,r|=8;break;case F_:return t=oi(12,n,e,r|2),t.elementType=F_,t.lanes=s,t;case j_:return t=oi(13,n,e,r),t.elementType=j_,t.lanes=s,t;case U_:return t=oi(19,n,e,r),t.elementType=U_,t.lanes=s,t;case RI:return ym(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case PI:a=10;break e;case AI:a=9;break e;case Qv:a=11;break e;case Yv:a=14;break e;case gs:a=16,i=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=oi(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Wo(t,e,n,i){return t=oi(7,t,i,e),t.lanes=n,t}function ym(t,e,n,i){return t=oi(22,t,i,e),t.elementType=RI,t.lanes=n,t.stateNode={isHidden:!1},t}function Xg(t,e,n){return t=oi(6,t,null,e),t.lanes=n,t}function Jg(t,e,n){return e=oi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cO(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lg(0),this.expirationTimes=Lg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lg(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function N0(t,e,n,i,r,s,a,u,c){return t=new cO(t,e,n,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=oi(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},m0(s),t}function hO(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ya,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function wA(t){if(!t)return Ws;t=t._reactInternals;e:{if(ha(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(jn(n))return wP(t,n,e)}return e}function EA(t,e,n,i,r,s,a,u,c){return t=N0(n,i,!0,t,r,s,a,u,c),t.context=wA(null),n=t.current,i=xn(),r=Ds(n),s=Fr(i,r),s.callback=e??null,Ns(n,s,r),t.current.lanes=r,zh(t,r,i),Un(t,i),t}function vm(t,e,n,i){var r=e.current,s=xn(),a=Ds(r);return n=wA(n),e.context===null?e.context=n:e.pendingContext=n,e=Fr(s,a),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Ns(r,e,a),t!==null&&(Ni(t,r,a,s),If(t,r,a)),a}function _p(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ix(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function L0(t,e){Ix(t,e),(t=t.alternate)&&Ix(t,e)}function dO(){return null}var TA=typeof reportError=="function"?reportError:function(t){console.error(t)};function D0(t){this._internalRoot=t}wm.prototype.render=D0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));vm(t,e,null,null)};wm.prototype.unmount=D0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ea(function(){vm(null,t,null,null)}),e[Wr]=null}};function wm(t){this._internalRoot=t}wm.prototype.unstable_scheduleHydration=function(t){if(t){var e=JI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ys.length&&e!==0&&e<ys[n].priority;n++);ys.splice(n,0,t),n===0&&tP(t)}};function M0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Em(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Px(){}function fO(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var h=_p(a);s.call(h)}}var a=EA(e,i,t,0,null,!1,!1,"",Px);return t._reactRootContainer=a,t[Wr]=a.current,rh(t.nodeType===8?t.parentNode:t),ea(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var u=i;i=function(){var h=_p(c);u.call(h)}}var c=N0(t,0,!1,null,null,!1,!1,"",Px);return t._reactRootContainer=c,t[Wr]=c.current,rh(t.nodeType===8?t.parentNode:t),ea(function(){vm(e,c,n,i)}),c}function Tm(t,e,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var u=r;r=function(){var c=_p(a);u.call(c)}}vm(e,a,t,r)}else a=fO(n,e,t,r,i);return _p(a)}YI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mc(e.pendingLanes);n!==0&&(e0(e,n|1),Un(e,Et()),!(je&6)&&(Fl=Et()+500,so()))}break;case 13:ea(function(){var i=Hr(t,1);if(i!==null){var r=xn();Ni(i,t,1,r)}}),L0(t,1)}};t0=function(t){if(t.tag===13){var e=Hr(t,134217728);if(e!==null){var n=xn();Ni(e,t,134217728,n)}L0(t,134217728)}};XI=function(t){if(t.tag===13){var e=Ds(t),n=Hr(t,e);if(n!==null){var i=xn();Ni(n,t,e,i)}L0(t,e)}};JI=function(){return He};eP=function(t,e){var n=He;try{return He=t,e()}finally{He=n}};Q_=function(t,e,n){switch(e){case"input":if(W_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=dm(i);if(!r)throw Error(J(90));kI(i),W_(i,r)}}}break;case"textarea":LI(t,n);break;case"select":e=n.value,e!=null&&gl(t,!!n.multiple,e,!1)}};UI=A0;BI=ea;var pO={usingClientEntryPoint:!1,Events:[Hh,nl,dm,FI,jI,A0]},sc={findFiberByHostInstance:Do,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mO={bundleType:sc.bundleType,version:sc.version,rendererPackageName:sc.rendererPackageName,rendererConfig:sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:es.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=HI(t),t===null?null:t.stateNode},findFiberByHostInstance:sc.findFiberByHostInstance||dO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lf.isDisabled&&lf.supportsFiber)try{lm=lf.inject(mO),tr=lf}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pO;Zn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M0(e))throw Error(J(200));return hO(t,e,null,n)};Zn.createRoot=function(t,e){if(!M0(t))throw Error(J(299));var n=!1,i="",r=TA;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=N0(t,1,!1,null,null,n,!1,i,r),t[Wr]=e.current,rh(t.nodeType===8?t.parentNode:t),new D0(e)};Zn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=HI(e),t=t===null?null:t.stateNode,t};Zn.flushSync=function(t){return ea(t)};Zn.hydrate=function(t,e,n){if(!Em(e))throw Error(J(200));return Tm(null,t,e,!0,n)};Zn.hydrateRoot=function(t,e,n){if(!M0(t))throw Error(J(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",a=TA;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=EA(e,null,t,1,n??null,r,!1,s,a),t[Wr]=e.current,rh(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new wm(e)};Zn.render=function(t,e,n){if(!Em(e))throw Error(J(200));return Tm(null,t,e,!1,n)};Zn.unmountComponentAtNode=function(t){if(!Em(t))throw Error(J(40));return t._reactRootContainer?(ea(function(){Tm(null,null,t,!1,function(){t._reactRootContainer=null,t[Wr]=null})}),!0):!1};Zn.unstable_batchedUpdates=A0;Zn.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Em(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return Tm(t,e,n,!1,i)};Zn.version="18.3.1-next-f1338f8080-20240426";function xA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xA)}catch(t){console.error(t)}}xA(),xI.exports=Zn;var SA=xI.exports,Ax=SA;O_.createRoot=Ax.createRoot,O_.hydrateRoot=Ax.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fh(){return fh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},fh.apply(this,arguments)}var Cs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Cs||(Cs={}));const Rx="popstate";function gO(t){t===void 0&&(t={});function e(i,r){let{pathname:s,search:a,hash:u}=i.location;return Ry("",{pathname:s,search:a,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:IA(r)}return yO(e,n,null,t)}function bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function CA(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function _O(){return Math.random().toString(36).substr(2,8)}function bx(t,e){return{usr:t.state,key:t.key,idx:e}}function Ry(t,e,n,i){return n===void 0&&(n=null),fh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ru(e):e,{state:n,key:e&&e.key||i||_O()})}function IA(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function ru(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function yO(t,e,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,u=Cs.Pop,c=null,h=p();h==null&&(h=0,a.replaceState(fh({},a.state,{idx:h}),""));function p(){return(a.state||{idx:null}).idx}function m(){u=Cs.Pop;let V=p(),C=V==null?null:V-h;h=V,c&&c({action:u,location:b.location,delta:C})}function _(V,C){u=Cs.Push;let S=Ry(b.location,V,C);n&&n(S,V),h=p()+1;let R=bx(S,h),U=b.createHref(S);try{a.pushState(R,"",U)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;r.location.assign(U)}s&&c&&c({action:u,location:b.location,delta:1})}function T(V,C){u=Cs.Replace;let S=Ry(b.location,V,C);n&&n(S,V),h=p();let R=bx(S,h),U=b.createHref(S);a.replaceState(R,"",U),s&&c&&c({action:u,location:b.location,delta:0})}function A(V){let C=r.location.origin!=="null"?r.location.origin:r.location.href,S=typeof V=="string"?V:IA(V);return S=S.replace(/ $/,"%20"),bt(C,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,C)}let b={get action(){return u},get location(){return t(r,a)},listen(V){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(Rx,m),c=V,()=>{r.removeEventListener(Rx,m),c=null}},createHref(V){return e(r,V)},createURL:A,encodeLocation(V){let C=A(V);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:_,replace:T,go(V){return a.go(V)}};return b}var kx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(kx||(kx={}));function vO(t,e,n){return n===void 0&&(n="/"),wO(t,e,n,!1)}function wO(t,e,n,i){let r=typeof e=="string"?ru(e):e,s=RA(r.pathname||"/",n);if(s==null)return null;let a=PA(t);EO(a);let u=null;for(let c=0;u==null&&c<a.length;++c){let h=NO(s);u=bO(a[c],h,i)}return u}function PA(t,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(s,a,u)=>{let c={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};c.relativePath.startsWith("/")&&(bt(c.relativePath.startsWith(i),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(i.length));let h=Ho([i,c.relativePath]),p=n.concat(c);s.children&&s.children.length>0&&(bt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),PA(s.children,e,p,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:AO(h,s.index),routesMeta:p})};return t.forEach((s,a)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))r(s,a);else for(let c of AA(s.path))r(s,a,c)}),e}function AA(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let a=AA(i.join("/")),u=[];return u.push(...a.map(c=>c===""?s:[s,c].join("/"))),r&&u.push(...a),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function EO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:RO(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const TO=/^:[\w-]+$/,xO=3,SO=2,CO=1,IO=10,PO=-2,Nx=t=>t==="*";function AO(t,e){let n=t.split("/"),i=n.length;return n.some(Nx)&&(i+=PO),e&&(i+=SO),n.filter(r=>!Nx(r)).reduce((r,s)=>r+(TO.test(s)?xO:s===""?CO:IO),i)}function RO(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function bO(t,e,n){n===void 0&&(n=!1);let{routesMeta:i}=t,r={},s="/",a=[];for(let u=0;u<i.length;++u){let c=i[u],h=u===i.length-1,p=s==="/"?e:e.slice(s.length)||"/",m=Lx({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},p),_=c.route;if(!m&&h&&n&&!i[i.length-1].route.index&&(m=Lx({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},p)),!m)return null;Object.assign(r,m.params),a.push({params:r,pathname:Ho([s,m.pathname]),pathnameBase:OO(Ho([s,m.pathnameBase])),route:_}),m.pathnameBase!=="/"&&(s=Ho([s,m.pathnameBase]))}return a}function Lx(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=kO(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:i.reduce((h,p,m)=>{let{paramName:_,isOptional:T}=p;if(_==="*"){let b=u[m]||"";a=s.slice(0,s.length-b.length).replace(/(.)\/+$/,"$1")}const A=u[m];return T&&!A?h[_]=void 0:h[_]=(A||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:t}}function kO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),CA(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,u,c)=>(i.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function NO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return CA(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function RA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function LO(t,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?ru(t):t;return{pathname:n?n.startsWith("/")?n:DO(n,e):e,search:VO(i),hash:FO(r)}}function DO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function e_(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function MO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function bA(t,e){let n=MO(t);return e?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function kA(t,e,n,i){i===void 0&&(i=!1);let r;typeof t=="string"?r=ru(t):(r=fh({},t),bt(!r.pathname||!r.pathname.includes("?"),e_("?","pathname","search",r)),bt(!r.pathname||!r.pathname.includes("#"),e_("#","pathname","hash",r)),bt(!r.search||!r.search.includes("#"),e_("#","search","hash",r)));let s=t===""||r.pathname==="",a=s?"/":r.pathname,u;if(a==null)u=n;else{let m=e.length-1;if(!i&&a.startsWith("..")){let _=a.split("/");for(;_[0]==="..";)_.shift(),m-=1;r.pathname=_.join("/")}u=m>=0?e[m]:"/"}let c=LO(r,u),h=a&&a!=="/"&&a.endsWith("/"),p=(s||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(h||p)&&(c.pathname+="/"),c}const Ho=t=>t.join("/").replace(/\/\/+/g,"/"),OO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,FO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function jO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const NA=["post","put","patch","delete"];new Set(NA);const UO=["get",...NA];new Set(UO);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ph(){return ph=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ph.apply(this,arguments)}const O0=B.createContext(null),BO=B.createContext(null),qh=B.createContext(null),xm=B.createContext(null),da=B.createContext({outlet:null,matches:[],isDataRoute:!1}),LA=B.createContext(null);function Gh(){return B.useContext(xm)!=null}function V0(){return Gh()||bt(!1),B.useContext(xm).location}function DA(t){B.useContext(qh).static||B.useLayoutEffect(t)}function Kh(){let{isDataRoute:t}=B.useContext(da);return t?eV():zO()}function zO(){Gh()||bt(!1);let t=B.useContext(O0),{basename:e,future:n,navigator:i}=B.useContext(qh),{matches:r}=B.useContext(da),{pathname:s}=V0(),a=JSON.stringify(bA(r,n.v7_relativeSplatPath)),u=B.useRef(!1);return DA(()=>{u.current=!0}),B.useCallback(function(h,p){if(p===void 0&&(p={}),!u.current)return;if(typeof h=="number"){i.go(h);return}let m=kA(h,JSON.parse(a),s,p.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ho([e,m.pathname])),(p.replace?i.replace:i.push)(m,p.state,p)},[e,i,a,s,t])}function WO(t,e){return HO(t,e)}function HO(t,e,n,i){Gh()||bt(!1);let{navigator:r}=B.useContext(qh),{matches:s}=B.useContext(da),a=s[s.length-1],u=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let h=V0(),p;if(e){var m;let V=typeof e=="string"?ru(e):e;c==="/"||(m=V.pathname)!=null&&m.startsWith(c)||bt(!1),p=V}else p=h;let _=p.pathname||"/",T=_;if(c!=="/"){let V=c.replace(/^\//,"").split("/");T="/"+_.replace(/^\//,"").split("/").slice(V.length).join("/")}let A=vO(t,{pathname:T}),b=ZO(A&&A.map(V=>Object.assign({},V,{params:Object.assign({},u,V.params),pathname:Ho([c,r.encodeLocation?r.encodeLocation(V.pathname).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?c:Ho([c,r.encodeLocation?r.encodeLocation(V.pathnameBase).pathname:V.pathnameBase])})),s,n,i);return e&&b?B.createElement(xm.Provider,{value:{location:ph({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Cs.Pop}},b):b}function $O(){let t=JO(),e=jO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),n?B.createElement("pre",{style:r},n):null,s)}const qO=B.createElement($O,null);class GO extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?B.createElement(da.Provider,{value:this.props.routeContext},B.createElement(LA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KO(t){let{routeContext:e,match:n,children:i}=t,r=B.useContext(O0);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(da.Provider,{value:e},i)}function ZO(t,e,n,i){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),i===void 0&&(i=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,u=(r=n)==null?void 0:r.errors;if(u!=null){let p=a.findIndex(m=>m.route.id&&(u==null?void 0:u[m.route.id])!==void 0);p>=0||bt(!1),a=a.slice(0,Math.min(a.length,p+1))}let c=!1,h=-1;if(n&&i&&i.v7_partialHydration)for(let p=0;p<a.length;p++){let m=a[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:_,errors:T}=n,A=m.route.loader&&_[m.route.id]===void 0&&(!T||T[m.route.id]===void 0);if(m.route.lazy||A){c=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((p,m,_)=>{let T,A=!1,b=null,V=null;n&&(T=u&&m.route.id?u[m.route.id]:void 0,b=m.route.errorElement||qO,c&&(h<0&&_===0?(tV("route-fallback",!1),A=!0,V=null):h===_&&(A=!0,V=m.route.hydrateFallbackElement||null)));let C=e.concat(a.slice(0,_+1)),S=()=>{let R;return T?R=b:A?R=V:m.route.Component?R=B.createElement(m.route.Component,null):m.route.element?R=m.route.element:R=p,B.createElement(KO,{match:m,routeContext:{outlet:p,matches:C,isDataRoute:n!=null},children:R})};return n&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?B.createElement(GO,{location:n.location,revalidation:n.revalidation,component:b,error:T,children:S(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):S()},null)}var MA=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(MA||{}),yp=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(yp||{});function QO(t){let e=B.useContext(O0);return e||bt(!1),e}function YO(t){let e=B.useContext(BO);return e||bt(!1),e}function XO(t){let e=B.useContext(da);return e||bt(!1),e}function OA(t){let e=XO(),n=e.matches[e.matches.length-1];return n.route.id||bt(!1),n.route.id}function JO(){var t;let e=B.useContext(LA),n=YO(yp.UseRouteError),i=OA(yp.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[i]}function eV(){let{router:t}=QO(MA.UseNavigateStable),e=OA(yp.UseNavigateStable),n=B.useRef(!1);return DA(()=>{n.current=!0}),B.useCallback(function(r,s){s===void 0&&(s={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,ph({fromRouteId:e},s)))},[t,e])}const Dx={};function tV(t,e,n){!e&&!Dx[t]&&(Dx[t]=!0)}function nV(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function uf(t){let{to:e,replace:n,state:i,relative:r}=t;Gh()||bt(!1);let{future:s,static:a}=B.useContext(qh),{matches:u}=B.useContext(da),{pathname:c}=V0(),h=Kh(),p=kA(e,bA(u,s.v7_relativeSplatPath),c,r==="path"),m=JSON.stringify(p);return B.useEffect(()=>h(JSON.parse(m),{replace:n,state:i,relative:r}),[h,m,r,n,i]),null}function bo(t){bt(!1)}function iV(t){let{basename:e="/",children:n=null,location:i,navigationType:r=Cs.Pop,navigator:s,static:a=!1,future:u}=t;Gh()&&bt(!1);let c=e.replace(/^\/*/,"/"),h=B.useMemo(()=>({basename:c,navigator:s,static:a,future:ph({v7_relativeSplatPath:!1},u)}),[c,u,s,a]);typeof i=="string"&&(i=ru(i));let{pathname:p="/",search:m="",hash:_="",state:T=null,key:A="default"}=i,b=B.useMemo(()=>{let V=RA(p,c);return V==null?null:{location:{pathname:V,search:m,hash:_,state:T,key:A},navigationType:r}},[c,p,m,_,T,A,r]);return b==null?null:B.createElement(qh.Provider,{value:h},B.createElement(xm.Provider,{children:n,value:b}))}function rV(t){let{children:e,location:n}=t;return WO(by(e),n)}new Promise(()=>{});function by(t,e){e===void 0&&(e=[]);let n=[];return B.Children.forEach(t,(i,r)=>{if(!B.isValidElement(i))return;let s=[...e,r];if(i.type===B.Fragment){n.push.apply(n,by(i.props.children,s));return}i.type!==bo&&bt(!1),!i.props.index||!i.props.children||bt(!1);let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=by(i.props.children,s)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const sV="6";try{window.__reactRouterVersion=sV}catch{}const oV="startTransition",Mx=sM[oV];function aV(t){let{basename:e,children:n,future:i,window:r}=t,s=B.useRef();s.current==null&&(s.current=gO({window:r,v5Compat:!0}));let a=s.current,[u,c]=B.useState({action:a.action,location:a.location}),{v7_startTransition:h}=i||{},p=B.useCallback(m=>{h&&Mx?Mx(()=>c(m)):c(m)},[c,h]);return B.useLayoutEffect(()=>a.listen(p),[a,p]),B.useEffect(()=>nV(i),[i]),B.createElement(iV,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:a,future:i})}var Ox;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ox||(Ox={}));var Vx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Vx||(Vx={}));const lV=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(t,e){if(!t)throw su(e)},su=function(t){return new Error("Firebase Database ("+VA.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},uV=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=t[n++],a=t[n++],u=t[n++],c=((r&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],a=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|a&63)}}return e.join("")},F0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const s=t[r],a=r+1<t.length,u=a?t[r+1]:0,c=r+2<t.length,h=c?t[r+2]:0,p=s>>2,m=(s&3)<<4|u>>4;let _=(u&15)<<2|h>>6,T=h&63;c||(T=64,a||(_=64)),i.push(n[p],n[m],n[_],n[T])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(FA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const s=n[t.charAt(r++)],u=r<t.length?n[t.charAt(r)]:0;++r;const h=r<t.length?n[t.charAt(r)]:64;++r;const m=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||u==null||h==null||m==null)throw new cV;const _=s<<2|u>>4;if(i.push(_),h!==64){const T=u<<4&240|h>>2;if(i.push(T),m!==64){const A=h<<6&192|m;i.push(A)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class cV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jA=function(t){const e=FA(t);return F0.encodeByteArray(e,!0)},vp=function(t){return jA(t).replace(/\./g,"")},wp=function(t){try{return F0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hV(t){return UA(void 0,t)}function UA(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!dV(n)||(t[n]=UA(t[n],e[n]));return t}function dV(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV=()=>fV().__FIREBASE_DEFAULTS__,mV=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},gV=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wp(t[1]);return e&&JSON.parse(e)},Sm=()=>{try{return lV()||pV()||mV()||gV()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},BA=t=>{var e,n;return(n=(e=Sm())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},zA=t=>{const e=BA(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},WA=()=>{var t;return(t=Sm())==null?void 0:t.config},HA=t=>{var e;return(e=Sm())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function j0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t},u="";return[vp(JSON.stringify(n)),vp(JSON.stringify(a)),u].join(".")}const Mc={};function _V(){const t={prod:[],emulator:[]};for(const e of Object.keys(Mc))Mc[e]?t.emulator.push(e):t.prod.push(e);return t}function yV(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Fx=!1;function U0(t,e){if(typeof window>"u"||typeof document>"u"||!oo(window.location.host)||Mc[t]===e||Mc[t]||Fx)return;Mc[t]=e;function n(_){return`__firebase__banner__${_}`}const i="__firebase__banner",s=_V().prod.length>0;function a(){const _=document.getElementById(i);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function c(_,T){_.setAttribute("width","24"),_.setAttribute("id",T),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Fx=!0,a()},_}function p(_,T){_.setAttribute("id",T),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=yV(i),T=n("text"),A=document.getElementById(T)||document.createElement("span"),b=n("learnmore"),V=document.getElementById(b)||document.createElement("a"),C=n("preprendIcon"),S=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const R=_.element;u(R),p(V,b);const U=h();c(S,C),R.append(S,A,V,U),document.body.appendChild(R)}s?(A.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function vV(){var e;const t=(e=Sm())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function EV(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function TV(){const t=_n();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function GA(){return VA.NODE_ADMIN===!0}function xV(){return!vV()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SV(){try{return typeof indexedDB=="object"}catch{return!1}}function CV(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV="FirebaseError";class ts extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=IV,Object.setPrototypeOf(this,ts.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zh.prototype.create)}}class Zh{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],a=s?PV(s,i):"Error",u=`${this.serviceName}: ${a} (${r}).`;return new ts(r,u,i)}}function PV(t,e){return t.replace(AV,(n,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const AV=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t){return JSON.parse(t)}function Kt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA=function(t){let e={},n={},i={},r="";try{const s=t.split(".");e=mh(wp(s[0])||""),n=mh(wp(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}},RV=function(t){const e=KA(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},bV=function(t){const e=KA(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function jl(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ep(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Tp(t,e,n){const i={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function Hs(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const s=t[r],a=e[r];if(jx(s)&&jx(a)){if(!Hs(s,a))return!1}else if(s!==a)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function jx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function _c(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function yc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const i=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)i[m]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let m=0;m<16;m++)i[m]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let m=16;m<80;m++){const _=i[m-3]^i[m-8]^i[m-14]^i[m-16];i[m]=(_<<1|_>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],a=this.chain_[2],u=this.chain_[3],c=this.chain_[4],h,p;for(let m=0;m<80;m++){m<40?m<20?(h=u^s&(a^u),p=1518500249):(h=s^a^u,p=1859775393):m<60?(h=s&a|u&(s|a),p=2400959708):(h=s^a^u,p=3395469782);const _=(r<<5|r>>>27)+h+c+p+i[m]&4294967295;c=u,u=a,a=(s<<30|s>>>2)&4294967295,s=r,r=_}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const i=n-this.blockSize;let r=0;const s=this.buf_;let a=this.inbuf_;for(;r<n;){if(a===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[a]=e.charCodeAt(r),++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}else for(;r<n;)if(s[a]=e[r],++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}}function NV(t,e){const n=new LV(t,e);return n.subscribe.bind(n)}class LV{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");DV(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=t_),r.error===void 0&&(r.error=t_),r.complete===void 0&&(r.complete=t_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DV(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function t_(){}function Ul(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,ee(i<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(i)-56320;r=65536+(s<<10)+a}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Cm=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t){return t&&t._delegate?t._delegate:t}class $s{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new Ji;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FV(e))try{this.getOrInitializeService({instanceIdentifier:ko})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=ko){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ko){return this.instances.has(e)}getOptions(e=ko){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);i===u&&a.resolve(r)}return r}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:VV(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ko){return this.component?this.component.multipleInstances?e:ko:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VV(t){return t===ko?void 0:t}function FV(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OV(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(be||(be={}));const UV={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},BV=be.INFO,zV={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},WV=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),r=zV[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Im{constructor(e){this.name=e,this._logLevel=BV,this._logHandler=WV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?UV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const HV=(t,e)=>e.some(n=>t instanceof n);let Ux,Bx;function $V(){return Ux||(Ux=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qV(){return Bx||(Bx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZA=new WeakMap,ky=new WeakMap,QA=new WeakMap,n_=new WeakMap,z0=new WeakMap;function GV(t){const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(Os(t.result)),r()},a=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&ZA.set(n,t)}).catch(()=>{}),z0.set(e,t),e}function KV(t){if(ky.has(t))return;const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),r()},a=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});ky.set(t,e)}let Ny={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ky.get(t);if(e==="objectStoreNames")return t.objectStoreNames||QA.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Os(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZV(t){Ny=t(Ny)}function QV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(i_(this),e,...n);return QA.set(i,e.sort?e.sort():[e]),Os(i)}:qV().includes(t)?function(...e){return t.apply(i_(this),e),Os(ZA.get(this))}:function(...e){return Os(t.apply(i_(this),e))}}function YV(t){return typeof t=="function"?QV(t):(t instanceof IDBTransaction&&KV(t),HV(t,$V())?new Proxy(t,Ny):t)}function Os(t){if(t instanceof IDBRequest)return GV(t);if(n_.has(t))return n_.get(t);const e=YV(t);return e!==t&&(n_.set(t,e),z0.set(e,t)),e}const i_=t=>z0.get(t);function XV(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const a=indexedDB.open(t,e),u=Os(a);return i&&a.addEventListener("upgradeneeded",c=>{i(Os(a.result),c.oldVersion,c.newVersion,Os(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const JV=["get","getKey","getAll","getAllKeys","count"],eF=["put","add","delete","clear"],r_=new Map;function zx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(r_.get(e))return r_.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=eF.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||JV.includes(n)))return;const s=async function(a,...u){const c=this.transaction(a,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(u.shift())),(await Promise.all([h[n](...u),r&&c.done]))[0]};return r_.set(e,s),s}ZV(t=>({...t,get:(e,n,i)=>zx(e,n)||t.get(e,n,i),has:(e,n)=>!!zx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(nF(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function nF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ly="@firebase/app",Wx="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr=new Im("@firebase/app"),iF="@firebase/app-compat",rF="@firebase/analytics-compat",sF="@firebase/analytics",oF="@firebase/app-check-compat",aF="@firebase/app-check",lF="@firebase/auth",uF="@firebase/auth-compat",cF="@firebase/database",hF="@firebase/data-connect",dF="@firebase/database-compat",fF="@firebase/functions",pF="@firebase/functions-compat",mF="@firebase/installations",gF="@firebase/installations-compat",_F="@firebase/messaging",yF="@firebase/messaging-compat",vF="@firebase/performance",wF="@firebase/performance-compat",EF="@firebase/remote-config",TF="@firebase/remote-config-compat",xF="@firebase/storage",SF="@firebase/storage-compat",CF="@firebase/firestore",IF="@firebase/ai",PF="@firebase/firestore-compat",AF="firebase",RF="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="[DEFAULT]",bF={[Ly]:"fire-core",[iF]:"fire-core-compat",[sF]:"fire-analytics",[rF]:"fire-analytics-compat",[aF]:"fire-app-check",[oF]:"fire-app-check-compat",[lF]:"fire-auth",[uF]:"fire-auth-compat",[cF]:"fire-rtdb",[hF]:"fire-data-connect",[dF]:"fire-rtdb-compat",[fF]:"fire-fn",[pF]:"fire-fn-compat",[mF]:"fire-iid",[gF]:"fire-iid-compat",[_F]:"fire-fcm",[yF]:"fire-fcm-compat",[vF]:"fire-perf",[wF]:"fire-perf-compat",[EF]:"fire-rc",[TF]:"fire-rc-compat",[xF]:"fire-gcs",[SF]:"fire-gcs-compat",[CF]:"fire-fst",[PF]:"fire-fst-compat",[IF]:"fire-vertex","fire-js":"fire-js",[AF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new Map,kF=new Map,My=new Map;function Hx(t,e){try{t.container.addComponent(e)}catch(n){qr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ta(t){const e=t.name;if(My.has(e))return qr.debug(`There were multiple attempts to register component ${e}.`),!1;My.set(e,t);for(const n of gh.values())Hx(n,t);for(const n of kF.values())Hx(n,t);return!0}function Pm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vs=new Zh("app","Firebase",NF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $s("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=RF;function YA(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Dy,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Vs.create("bad-app-name",{appName:String(r)});if(n||(n=WA()),!n)throw Vs.create("no-options");const s=gh.get(r);if(s){if(Hs(n,s.options)&&Hs(i,s.config))return s;throw Vs.create("duplicate-app",{appName:r})}const a=new jV(r);for(const c of My.values())a.addComponent(c);const u=new LF(n,i,a);return gh.set(r,u),u}function Am(t=Dy){const e=gh.get(t);if(!e&&t===Dy&&WA())return YA();if(!e)throw Vs.create("no-app",{appName:t});return e}function DF(){return Array.from(gh.values())}function ir(t,e,n){let i=bF[t]??t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qr.warn(a.join(" "));return}ta(new $s(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF="firebase-heartbeat-database",OF=1,_h="firebase-heartbeat-store";let s_=null;function XA(){return s_||(s_=XV(MF,OF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_h)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vs.create("idb-open",{originalErrorMessage:t.message})})),s_}async function VF(t){try{const n=(await XA()).transaction(_h),i=await n.objectStore(_h).get(JA(t));return await n.done,i}catch(e){if(e instanceof ts)qr.warn(e.message);else{const n=Vs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qr.warn(n.message)}}}async function $x(t,e){try{const i=(await XA()).transaction(_h,"readwrite");await i.objectStore(_h).put(e,JA(t)),await i.done}catch(n){if(n instanceof ts)qr.warn(n.message);else{const i=Vs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});qr.warn(i.message)}}}function JA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=1024,jF=30;class UF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new zF(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qx();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>jF){const a=WF(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){qr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=qx(),{heartbeatsToSend:i,unsentEntries:r}=BF(this._heartbeatsCache.heartbeats),s=vp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return qr.warn(n),""}}}function qx(){return new Date().toISOString().substring(0,10)}function BF(t,e=FF){const n=[];let i=t.slice();for(const r of t){const s=n.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),Gx(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Gx(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class zF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SV()?CV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await VF(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return $x(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return $x(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Gx(t){return vp(JSON.stringify({version:2,heartbeats:t})).length}function WF(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t){ta(new $s("platform-logger",e=>new tF(e),"PRIVATE")),ta(new $s("heartbeat",e=>new UF(e),"PRIVATE")),ir(Ly,Wx,t),ir(Ly,Wx,"esm2020"),ir("fire-js","")}HF("");function eR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $F=eR,tR=new Zh("auth","Firebase",eR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=new Im("@firebase/auth");function qF(t,...e){xp.logLevel<=be.WARN&&xp.warn(`Auth (${fa}): ${t}`,...e)}function Lf(t,...e){xp.logLevel<=be.ERROR&&xp.error(`Auth (${fa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t,...e){throw H0(t,...e)}function Li(t,...e){return H0(t,...e)}function W0(t,e,n){const i={...$F(),[e]:n};return new Zh("auth","Firebase",i).create(e,{appName:t.name})}function jr(t){return W0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function GF(t,e,n){const i=n;if(!(e instanceof i))throw i.name!==e.constructor.name&&mi(t,"argument-error"),W0(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function H0(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return tR.create(t,...e)}function fe(t,e,...n){if(!t)throw H0(e,...n)}function Mr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lf(e),new Error(e)}function Gr(t,e){t||Mr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function KF(){return Kx()==="http:"||Kx()==="https:"}function Kx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KF()||EV()||"connection"in navigator)?navigator.onLine:!0}function QF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.shortDelay=e,this.longDelay=n,Gr(n>e,"Short delay should be less than long delay!"),this.isMobile=B0()||qA()}get(){return ZF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(t,e){Gr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JF=new Qh(3e4,6e4);function ao(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function lo(t,e,n,i,r={}){return iR(t,r,async()=>{let s={},a={};i&&(e==="GET"?a=i:s={body:JSON.stringify(i)});const u=ou({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:c,...s};return wV()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&oo(t.emulatorConfig.host)&&(h.credentials="include"),nR.fetch()(await rR(t,t.config.apiHost,n,u),h)})}async function iR(t,e,n){t._canInitEmulator=!1;const i={...YF,...e};try{const r=new t4(t),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw cf(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const u=s.ok?a.errorMessage:a.error.message,[c,h]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw cf(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw cf(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw cf(t,"user-disabled",a);const p=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw W0(t,p,h);mi(t,p)}}catch(r){if(r instanceof ts)throw r;mi(t,"network-request-failed",{message:String(r)})}}async function Yh(t,e,n,i,r={}){const s=await lo(t,e,n,i,r);return"mfaPendingCredential"in s&&mi(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function rR(t,e,n,i){const r=`${e}${n}?${i}`,s=t,a=s.config.emulator?$0(t.config,r):`${t.config.apiScheme}://${r}`;return XF.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function e4(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class t4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Li(this.auth,"network-request-failed")),JF.get())})}}function cf(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Li(t,e,i);return r.customData._tokenResponse=n,r}function Zx(t){return t!==void 0&&t.enterprise!==void 0}class n4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return e4(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function i4(t,e){return lo(t,"GET","/v2/recaptchaConfig",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(t,e){return lo(t,"POST","/v1/accounts:delete",e)}async function Sp(t,e){return lo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s4(t,e=!1){const n=ot(t),i=await n.getIdToken(e),r=q0(i);fe(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Oc(o_(r.auth_time)),issuedAtTime:Oc(o_(r.iat)),expirationTime:Oc(o_(r.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function o_(t){return Number(t)*1e3}function q0(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return Lf("JWT malformed, contained fewer than 3 sections"),null;try{const r=wp(n);return r?JSON.parse(r):(Lf("Failed to decode base64 JWT payload"),null)}catch(r){return Lf("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Qx(t){const e=q0(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof ts&&o4(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function o4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cp(t){var m;const e=t.auth,n=await t.getIdToken(),i=await yh(t,Sp(e,{idToken:n}));fe(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];t._notifyReloadListener(r);const s=(m=r.providerUserInfo)!=null&&m.length?sR(r.providerUserInfo):[],a=u4(t.providerData,s),u=t.isAnonymous,c=!(t.email&&r.passwordHash)&&!(a!=null&&a.length),h=u?c:!1,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Vy(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function l4(t){const e=ot(t);await Cp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function u4(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function sR(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c4(t,e){const n=await iR(t,{},async()=>{const i=ou({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,a=await rR(t,r,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:u,body:i};return t.emulatorConfig&&oo(t.emulatorConfig.host)&&(c.credentials="include"),nR.fetch()(a,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function h4(t,e){return lo(t,"POST","/v2/accounts:revokeToken",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=Qx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:r,expiresIn:s}=await c4(e,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:r,expirationTime:s}=n,a=new Tl;return i&&(fe(typeof i=="string","internal-error",{appName:e}),a.refreshToken=i),r&&(fe(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),s&&(fe(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tl,this.toJSON())}_performRefresh(){return Mr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ri{constructor({uid:e,auth:n,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new a4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Vy(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await yh(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return s4(this,e)}reload(){return l4(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ri({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Cp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nn(this.auth.app))return Promise.reject(jr(this.auth));const e=await this.getIdToken();return await yh(this,r4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,r=n.email??void 0,s=n.phoneNumber??void 0,a=n.photoURL??void 0,u=n.tenantId??void 0,c=n._redirectEventId??void 0,h=n.createdAt??void 0,p=n.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:T,providerData:A,stsTokenManager:b}=n;fe(m&&b,e,"internal-error");const V=Tl.fromJSON(this.name,b);fe(typeof m=="string",e,"internal-error"),ps(i,e.name),ps(r,e.name),fe(typeof _=="boolean",e,"internal-error"),fe(typeof T=="boolean",e,"internal-error"),ps(s,e.name),ps(a,e.name),ps(u,e.name),ps(c,e.name),ps(h,e.name),ps(p,e.name);const C=new Ri({uid:m,auth:e,email:r,emailVerified:_,displayName:i,isAnonymous:T,photoURL:a,phoneNumber:s,tenantId:u,stsTokenManager:V,createdAt:h,lastLoginAt:p});return A&&Array.isArray(A)&&(C.providerData=A.map(S=>({...S}))),c&&(C._redirectEventId=c),C}static async _fromIdTokenResponse(e,n,i=!1){const r=new Tl;r.updateFromServerResponse(n);const s=new Ri({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Cp(s),s}static async _fromGetAccountInfoResponse(e,n,i){const r=n.users[0];fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?sR(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),u=new Tl;u.updateFromIdToken(i);const c=new Ri({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:a}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Vy(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx=new Map;function Or(t){Gr(t instanceof Function,"Expected a class definition");let e=Yx.get(t);return e?(Gr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Yx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}oR.type="NONE";const Xx=oR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t,e,n){return`firebase:${t}:${e}:${n}`}class xl{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Df(this.userKey,r.apiKey,s),this.fullPersistenceKey=Df("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sp(this.auth,{idToken:e}).catch(()=>{});return n?Ri._fromGetAccountInfoResponse(this.auth,n,e):null}return Ri._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new xl(Or(Xx),e,i);const r=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Or(Xx);const a=Df(i,e.config.apiKey,e.name);let u=null;for(const h of n)try{const p=await h._get(a);if(p){let m;if(typeof p=="string"){const _=await Sp(e,{idToken:p}).catch(()=>{});if(!_)break;m=await Ri._fromGetAccountInfoResponse(e,_,p)}else m=Ri._fromJSON(e,p);h!==s&&(u=m),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new xl(s,e,i):(s=c[0],u&&await s._set(a,u.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(a)}catch{}})),new xl(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dR(e))return"Blackberry";if(fR(e))return"Webos";if(lR(e))return"Safari";if((e.includes("chrome/")||uR(e))&&!e.includes("edge/"))return"Chrome";if(hR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function aR(t=_n()){return/firefox\//i.test(t)}function lR(t=_n()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uR(t=_n()){return/crios\//i.test(t)}function cR(t=_n()){return/iemobile/i.test(t)}function hR(t=_n()){return/android/i.test(t)}function dR(t=_n()){return/blackberry/i.test(t)}function fR(t=_n()){return/webos/i.test(t)}function G0(t=_n()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function d4(t=_n()){var e;return G0(t)&&!!((e=window.navigator)!=null&&e.standalone)}function f4(){return TV()&&document.documentMode===10}function pR(t=_n()){return G0(t)||hR(t)||fR(t)||dR(t)||/windows phone/i.test(t)||cR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t,e=[]){let n;switch(t){case"Browser":n=Jx(_n());break;case"Worker":n=`${Jx(_n())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${fa}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=s=>new Promise((a,u)=>{try{const c=e(s);a(c)}catch(c){u(c)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m4(t,e={}){return lo(t,"GET","/v2/passwordPolicy",ao(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=6;class _4{constructor(e){var i;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??g4,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,n,i,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new e1(this),this.idTokenSubscription=new e1(this),this.beforeStateQueue=new p4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Or(n)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await xl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sp(this,{idToken:e}),i=await Ri._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Nn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(s=this.redirectUser)==null?void 0:s._redirectEventId,u=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===u)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Cp(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nn(this.app))return Promise.reject(jr(this));const n=e?ot(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nn(this.app)?Promise.reject(jr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nn(this.app)?Promise.reject(jr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await m4(this),n=new _4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zh("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await h4(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Or(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await xl.create(this,[Or(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,i,r);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var n;if(Nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&qF(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function uo(t){return ot(t)}class e1{constructor(e){this.auth=e,this.observer=null,this.addObserver=NV(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function v4(t){Rm=t}function gR(t){return Rm.loadJS(t)}function w4(){return Rm.recaptchaEnterpriseScript}function E4(){return Rm.gapiScript}function T4(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class x4{constructor(){this.enterprise=new S4}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class S4{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const C4="recaptcha-enterprise",_R="NO_RECAPTCHA";class I4{constructor(e){this.type=C4,this.auth=uo(e)}async verify(e="verify",n=!1){async function i(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,u)=>{i4(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const h=new n4(c);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,a(h.siteKey)}}).catch(c=>{u(c)})})}function r(s,a,u){const c=window.grecaptcha;Zx(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(h=>{a(h)}).catch(()=>{a(_R)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new x4().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{i(this.auth).then(u=>{if(!n&&Zx(window.grecaptcha))r(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=w4();c.length!==0&&(c+=u),gR(c).then(()=>{r(u,s,a)}).catch(h=>{a(h)})}}).catch(u=>{a(u)})})}}async function oc(t,e,n,i=!1,r=!1){const s=new I4(t);let a;if(r)a=_R;else try{a=await s.verify(n)}catch{a=await s.verify(n,!0)}const u={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const c=u.phoneEnrollmentInfo.phoneNumber,h=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const c=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return i?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Fy(t,e,n,i,r){var s,a;if(r==="EMAIL_PASSWORD_PROVIDER")if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await oc(t,e,n,n==="getOobCode");return i(t,u)}else return i(t,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await oc(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(u)});else if(r==="PHONE_PROVIDER")if((a=t._getRecaptchaConfig())!=null&&a.isProviderEnabled("PHONE_PROVIDER")){const u=await oc(t,e,n);return i(t,u).catch(async c=>{var h;if(((h=t._getRecaptchaConfig())==null?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const p=await oc(t,e,n,!1,!0);return i(t,p)}return Promise.reject(c)})}else{const u=await oc(t,e,n,!1,!0);return i(t,u)}else return Promise.reject(r+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(t,e){const n=Pm(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),s=n.getOptions();if(Hs(s,e??{}))return r;mi(r,"already-initialized")}return n.initialize({options:e})}function A4(t,e){const n=(e==null?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Or);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function R4(t,e,n){const i=uo(t);fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),s=yR(e),{host:a,port:u}=b4(e),c=u===null?"":`:${u}`,h={url:`${s}//${a}${c}/`},p=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),fe(Hs(h,i.config.emulator)&&Hs(p,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=p,i.settings.appVerificationDisabledForTesting=!0,oo(a)?(j0(`${s}//${a}${c}`),U0("Auth",!0)):r||k4()}function yR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function b4(t){const e=yR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:t1(i.substr(s.length+1))}}else{const[s,a]=i.split(":");return{host:s,port:t1(a)}}}function t1(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function k4(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Mr("not implemented")}_getIdTokenResponse(e){return Mr("not implemented")}_linkToIdToken(e,n){return Mr("not implemented")}_getReauthenticationResolver(e){return Mr("not implemented")}}async function N4(t,e){return lo(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4(t,e){return Yh(t,"POST","/v1/accounts:signInWithPassword",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(t,e){return Yh(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}async function M4(t,e){return Yh(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends K0{constructor(e,n,i,r=null){super("password",i),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new vh(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new vh(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fy(e,n,"signInWithPassword",L4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return D4(e,{email:this._email,oobCode:this._password});default:mi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fy(e,i,"signUpPassword",N4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return M4(e,{idToken:n,email:this._email,oobCode:this._password});default:mi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sl(t,e){return Yh(t,"POST","/v1/accounts:signInWithIdp",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4="http://localhost";class na extends K0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new na(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):mi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=n;if(!i||!r)return null;const a=new na(i,r);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Sl(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Sl(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Sl(e,n)}buildRequest(){const e={requestUri:O4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ou(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function F4(t){const e=_c(yc(t)).link,n=e?_c(yc(e)).deep_link_id:null,i=_c(yc(t)).deep_link_id;return(i?_c(yc(i)).link:null)||i||n||e||t}class Z0{constructor(e){const n=_c(yc(e)),i=n.apiKey??null,r=n.oobCode??null,s=V4(n.mode??null);fe(i&&r&&s,"argument-error"),this.apiKey=i,this.operation=s,this.code=r,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=F4(e);try{return new Z0(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.providerId=au.PROVIDER_ID}static credential(e,n){return vh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Z0.parseLink(n);return fe(i,"argument-error"),vh._fromEmailAndCode(e,i.code,i.tenantId)}}au.PROVIDER_ID="password";au.EMAIL_PASSWORD_SIGN_IN_METHOD="password";au.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh extends Q0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Xh{constructor(){super("facebook.com")}static credential(e){return na._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.FACEBOOK_SIGN_IN_METHOD="facebook.com";ws.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends Xh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return na._fromParams({providerId:er.PROVIDER_ID,signInMethod:er.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return er.credentialFromTaggedObject(e)}static credentialFromError(e){return er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return er.credential(n,i)}catch{return null}}}er.GOOGLE_SIGN_IN_METHOD="google.com";er.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Xh{constructor(){super("github.com")}static credential(e){return na._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.GITHUB_SIGN_IN_METHOD="github.com";Es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Xh{constructor(){super("twitter.com")}static credential(e,n){return na._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ts.credential(n,i)}catch{return null}}}Ts.TWITTER_SIGN_IN_METHOD="twitter.com";Ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t,e){return Yh(t,"POST","/v1/accounts:signUp",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,r=!1){const s=await Ri._fromIdTokenResponse(e,i,r),a=n1(i);return new ia({user:s,providerId:a,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const r=n1(i);return new ia({user:e,providerId:r,_tokenResponse:i,operationType:n})}}function n1(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip extends ts{constructor(e,n,i,r){super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Ip.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,r){return new Ip(e,n,i,r)}}function vR(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ip._fromErrorAndOperation(t,s,e,i):s})}async function U4(t,e,n=!1){const i=await yh(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ia._forOperation(t,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(t,e,n=!1){const{auth:i}=t;if(Nn(i.app))return Promise.reject(jr(i));const r="reauthenticate";try{const s=await yh(t,vR(i,r,e,t),n);fe(s.idToken,i,"internal-error");const a=q0(s.idToken);fe(a,i,"internal-error");const{sub:u}=a;return fe(t.uid===u,i,"user-mismatch"),ia._forOperation(t,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&mi(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wR(t,e,n=!1){if(Nn(t.app))return Promise.reject(jr(t));const i="signIn",r=await vR(t,i,e),s=await ia._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}async function z4(t,e){return wR(uo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(t){const e=uo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function W4(t,e,n){if(Nn(t.app))return Promise.reject(jr(t));const i=uo(t),a=await Fy(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",j4,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ER(t),c}),u=await ia._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(u.user),u}function H4(t,e,n){return Nn(t.app)?Promise.reject(jr(t)):z4(ot(t),au.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&ER(t),i})}function $4(t,e,n,i){return ot(t).onIdTokenChanged(e,n,i)}function q4(t,e,n){return ot(t).beforeAuthStateChanged(e,n)}function TR(t,e,n,i){return ot(t).onAuthStateChanged(e,n,i)}function bm(t){return ot(t).signOut()}const Pp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Pp,"1"),this.storage.removeItem(Pp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4=1e3,K4=10;class SR extends xR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&e(n,r,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,c)=>{this.notifyListeners(a,c)});return}const i=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);f4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,K4):r()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},G4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}SR.type="LOCAL";const Z4=SR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR extends xR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}CR.type="SESSION";const IR=CR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const i=new km(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:r,data:s}=n.data,a=this.handlersMap[r];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const u=Array.from(a).map(async h=>h(n.origin,s)),c=await Q4(u);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}km.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise((u,c)=>{const h=Y0("",20);r.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},i);a={messageChannel:r,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(){return window}function X4(t){rr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(){return typeof rr().WorkerGlobalScope<"u"&&typeof rr().importScripts=="function"}async function J4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ej(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function tj(){return PR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR="firebaseLocalStorageDb",nj=1,Ap="firebaseLocalStorage",RR="fbase_key";class Jh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Nm(t,e){return t.transaction([Ap],e?"readwrite":"readonly").objectStore(Ap)}function ij(){const t=indexedDB.deleteDatabase(AR);return new Jh(t).toPromise()}function jy(){const t=indexedDB.open(AR,nj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Ap,{keyPath:RR})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Ap)?e(i):(i.close(),await ij(),e(await jy()))})})}async function i1(t,e,n){const i=Nm(t,!0).put({[RR]:e,value:n});return new Jh(i).toPromise()}async function rj(t,e){const n=Nm(t,!1).get(e),i=await new Jh(n).toPromise();return i===void 0?null:i.value}function r1(t,e){const n=Nm(t,!0).delete(e);return new Jh(n).toPromise()}const sj=800,oj=3;class bR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jy(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>oj)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return PR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=km._getInstance(tj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,i;if(this.activeServiceWorker=await J4(),!this.activeServiceWorker)return;this.sender=new Y4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ej()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jy();return await i1(e,Pp,"1"),await r1(e,Pp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>i1(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>rj(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>r1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Nm(r,!1).getAll();return new Jh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bR.type="LOCAL";const aj=bR;new Qh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e){return e?Or(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0 extends K0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Sl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Sl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function lj(t){return wR(t.auth,new X0(t),t.bypassAuthState)}function uj(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),B4(n,new X0(t),t.bypassAuthState)}async function cj(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),U4(n,new X0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e,n,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lj;case"linkViaPopup":case"linkViaRedirect":return cj;case"reauthViaPopup":case"reauthViaRedirect":return uj;default:mi(this.auth,"internal-error")}}resolve(e){Gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=new Qh(2e3,1e4);async function s1(t,e,n){if(Nn(t.app))return Promise.reject(Li(t,"operation-not-supported-in-this-environment"));const i=uo(t);GF(t,e,Q0);const r=kR(i,n);return new Vo(i,"signInViaPopup",e,r).executeNotNull()}class Vo extends NR{constructor(e,n,i,r,s){super(e,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Vo.currentPopupAction&&Vo.currentPopupAction.cancel(),Vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){Gr(this.filter.length===1,"Popup operations only handle one event");const e=Y0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Li(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Li(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,i;if((i=(n=this.authWindow)==null?void 0:n.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Li(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hj.get())};e()}}Vo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj="pendingRedirect",Mf=new Map;class fj extends NR{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=Mf.get(this.auth._key());if(!e){try{const i=await pj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}Mf.set(this.auth._key(),e)}return this.bypassAuthState||Mf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pj(t,e){const n=_j(e),i=gj(t);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}function mj(t,e){Mf.set(t._key(),e)}function gj(t){return Or(t._redirectPersistence)}function _j(t){return Df(dj,t.config.apiKey,t.name)}async function yj(t,e,n=!1){if(Nn(t.app))return Promise.reject(jr(t));const i=uo(t),r=kR(i,e),a=await new fj(i,r,n).execute();return a&&!n&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=10*60*1e3;class wj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ej(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var i;if(e.error&&!LR(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";n.onError(Li(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vj&&this.cachedEventUids.clear(),this.cachedEventUids.has(o1(e))}saveEventToCache(e){this.cachedEventUids.add(o1(e)),this.lastProcessedEventTime=Date.now()}}function o1(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function LR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Ej(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return LR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tj(t,e={}){return lo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Sj=/^https?/;async function Cj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Tj(t);for(const n of e)try{if(Ij(n))return}catch{}mi(t,"unauthorized-domain")}function Ij(t){const e=Oy(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===i}if(!Sj.test(n))return!1;if(xj.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj=new Qh(3e4,6e4);function a1(){const t=rr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Aj(t){return new Promise((e,n)=>{var r,s,a;function i(){a1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{a1(),n(Li(t,"network-request-failed"))},timeout:Pj.get()})}if((s=(r=rr().gapi)==null?void 0:r.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((a=rr().gapi)!=null&&a.load)i();else{const u=T4("iframefcb");return rr()[u]=()=>{gapi.load?i():n(Li(t,"network-request-failed"))},gR(`${E4()}?onload=${u}`).catch(c=>n(c))}}).catch(e=>{throw Of=null,e})}let Of=null;function Rj(t){return Of=Of||Aj(t),Of}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj=new Qh(5e3,15e3),kj="__/auth/iframe",Nj="emulator/auth/iframe",Lj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Mj(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$0(e,Nj):`https://${t.config.authDomain}/${kj}`,i={apiKey:e.apiKey,appName:t.name,v:fa},r=Dj.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${ou(i).slice(1)}`}async function Oj(t){const e=await Rj(t),n=rr().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:Mj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Lj,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const a=Li(t,"network-request-failed"),u=rr().setTimeout(()=>{s(a)},bj.get());function c(){rr().clearTimeout(u),r(i)}i.ping(c).then(c,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Fj=500,jj=600,Uj="_blank",Bj="http://localhost";class l1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zj(t,e,n,i=Fj,r=jj){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let u="";const c={...Vj,width:i.toString(),height:r.toString(),top:s,left:a},h=_n().toLowerCase();n&&(u=uR(h)?Uj:n),aR(h)&&(e=e||Bj,c.scrollbars="yes");const p=Object.entries(c).reduce((_,[T,A])=>`${_}${T}=${A},`,"");if(d4(h)&&u!=="_self")return Wj(e||"",u),new l1(null);const m=window.open(e||"",u,p);fe(m,t,"popup-blocked");try{m.focus()}catch{}return new l1(m)}function Wj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj="__/auth/handler",$j="emulator/auth/handler",qj=encodeURIComponent("fac");async function u1(t,e,n,i,r,s){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:fa,eventId:r};if(e instanceof Q0){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Ep(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof Xh){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const c=await t._getAppCheckToken(),h=c?`#${qj}=${encodeURIComponent(c)}`:"";return`${Gj(t)}?${ou(u).slice(1)}${h}`}function Gj({config:t}){return t.emulator?$0(t,$j):`https://${t.authDomain}/${Hj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="webStorageSupport";class Kj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IR,this._completeRedirectFn=yj,this._overrideRedirectResult=mj}async _openPopup(e,n,i,r){var a;Gr((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await u1(e,n,i,Oy(),r);return zj(e,s,Y0())}async _openRedirect(e,n,i,r){await this._originValidation(e);const s=await u1(e,n,i,Oy(),r);return X4(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(Gr(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await Oj(e),i=new wj(e);return n.register("authEvent",r=>(fe(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(a_,{type:a_},r=>{var a;const s=(a=r==null?void 0:r[0])==null?void 0:a[a_];s!==void 0&&n(!!s),mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Cj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return pR()||lR()||G0()}}const Zj=Kj;var c1="@firebase/auth",h1="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Xj(t){ta(new $s("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=i.options;fe(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mR(t)},h=new y4(i,r,s,c);return A4(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),ta(new $s("auth-internal",e=>{const n=uo(e.getProvider("auth").getImmediate());return(i=>new Qj(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ir(c1,h1,Yj(t)),ir(c1,h1,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=5*60,e3=HA("authIdTokenMaxAge")||Jj;let d1=null;const t3=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>e3)return;const r=n==null?void 0:n.token;d1!==r&&(d1=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function DR(t=Am()){const e=Pm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=P4(t,{popupRedirectResolver:Zj,persistence:[aj,Z4,IR]}),i=HA("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const a=t3(s.toString());q4(n,a,()=>a(n.currentUser)),$4(n,u=>a(u))}}const r=BA("auth");return r&&R4(n,`http://${r}`),n}function n3(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}v4({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{const s=Li("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",n3().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Xj("Browser");var i3="firebase",r3="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ir(i3,r3,"app");var f1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fs,MR;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,I){function N(){}N.prototype=I.prototype,k.F=I.prototype,k.prototype=new N,k.prototype.constructor=k,k.D=function(O,M,j){for(var D=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)D[xe-2]=arguments[xe];return I.prototype[M].apply(O,D)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,I,N){N||(N=0);const O=Array(16);if(typeof I=="string")for(var M=0;M<16;++M)O[M]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(M=0;M<16;++M)O[M]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=k.g[0],N=k.g[1],M=k.g[2];let j=k.g[3],D;D=I+(j^N&(M^j))+O[0]+3614090360&4294967295,I=N+(D<<7&4294967295|D>>>25),D=j+(M^I&(N^M))+O[1]+3905402710&4294967295,j=I+(D<<12&4294967295|D>>>20),D=M+(N^j&(I^N))+O[2]+606105819&4294967295,M=j+(D<<17&4294967295|D>>>15),D=N+(I^M&(j^I))+O[3]+3250441966&4294967295,N=M+(D<<22&4294967295|D>>>10),D=I+(j^N&(M^j))+O[4]+4118548399&4294967295,I=N+(D<<7&4294967295|D>>>25),D=j+(M^I&(N^M))+O[5]+1200080426&4294967295,j=I+(D<<12&4294967295|D>>>20),D=M+(N^j&(I^N))+O[6]+2821735955&4294967295,M=j+(D<<17&4294967295|D>>>15),D=N+(I^M&(j^I))+O[7]+4249261313&4294967295,N=M+(D<<22&4294967295|D>>>10),D=I+(j^N&(M^j))+O[8]+1770035416&4294967295,I=N+(D<<7&4294967295|D>>>25),D=j+(M^I&(N^M))+O[9]+2336552879&4294967295,j=I+(D<<12&4294967295|D>>>20),D=M+(N^j&(I^N))+O[10]+4294925233&4294967295,M=j+(D<<17&4294967295|D>>>15),D=N+(I^M&(j^I))+O[11]+2304563134&4294967295,N=M+(D<<22&4294967295|D>>>10),D=I+(j^N&(M^j))+O[12]+1804603682&4294967295,I=N+(D<<7&4294967295|D>>>25),D=j+(M^I&(N^M))+O[13]+4254626195&4294967295,j=I+(D<<12&4294967295|D>>>20),D=M+(N^j&(I^N))+O[14]+2792965006&4294967295,M=j+(D<<17&4294967295|D>>>15),D=N+(I^M&(j^I))+O[15]+1236535329&4294967295,N=M+(D<<22&4294967295|D>>>10),D=I+(M^j&(N^M))+O[1]+4129170786&4294967295,I=N+(D<<5&4294967295|D>>>27),D=j+(N^M&(I^N))+O[6]+3225465664&4294967295,j=I+(D<<9&4294967295|D>>>23),D=M+(I^N&(j^I))+O[11]+643717713&4294967295,M=j+(D<<14&4294967295|D>>>18),D=N+(j^I&(M^j))+O[0]+3921069994&4294967295,N=M+(D<<20&4294967295|D>>>12),D=I+(M^j&(N^M))+O[5]+3593408605&4294967295,I=N+(D<<5&4294967295|D>>>27),D=j+(N^M&(I^N))+O[10]+38016083&4294967295,j=I+(D<<9&4294967295|D>>>23),D=M+(I^N&(j^I))+O[15]+3634488961&4294967295,M=j+(D<<14&4294967295|D>>>18),D=N+(j^I&(M^j))+O[4]+3889429448&4294967295,N=M+(D<<20&4294967295|D>>>12),D=I+(M^j&(N^M))+O[9]+568446438&4294967295,I=N+(D<<5&4294967295|D>>>27),D=j+(N^M&(I^N))+O[14]+3275163606&4294967295,j=I+(D<<9&4294967295|D>>>23),D=M+(I^N&(j^I))+O[3]+4107603335&4294967295,M=j+(D<<14&4294967295|D>>>18),D=N+(j^I&(M^j))+O[8]+1163531501&4294967295,N=M+(D<<20&4294967295|D>>>12),D=I+(M^j&(N^M))+O[13]+2850285829&4294967295,I=N+(D<<5&4294967295|D>>>27),D=j+(N^M&(I^N))+O[2]+4243563512&4294967295,j=I+(D<<9&4294967295|D>>>23),D=M+(I^N&(j^I))+O[7]+1735328473&4294967295,M=j+(D<<14&4294967295|D>>>18),D=N+(j^I&(M^j))+O[12]+2368359562&4294967295,N=M+(D<<20&4294967295|D>>>12),D=I+(N^M^j)+O[5]+4294588738&4294967295,I=N+(D<<4&4294967295|D>>>28),D=j+(I^N^M)+O[8]+2272392833&4294967295,j=I+(D<<11&4294967295|D>>>21),D=M+(j^I^N)+O[11]+1839030562&4294967295,M=j+(D<<16&4294967295|D>>>16),D=N+(M^j^I)+O[14]+4259657740&4294967295,N=M+(D<<23&4294967295|D>>>9),D=I+(N^M^j)+O[1]+2763975236&4294967295,I=N+(D<<4&4294967295|D>>>28),D=j+(I^N^M)+O[4]+1272893353&4294967295,j=I+(D<<11&4294967295|D>>>21),D=M+(j^I^N)+O[7]+4139469664&4294967295,M=j+(D<<16&4294967295|D>>>16),D=N+(M^j^I)+O[10]+3200236656&4294967295,N=M+(D<<23&4294967295|D>>>9),D=I+(N^M^j)+O[13]+681279174&4294967295,I=N+(D<<4&4294967295|D>>>28),D=j+(I^N^M)+O[0]+3936430074&4294967295,j=I+(D<<11&4294967295|D>>>21),D=M+(j^I^N)+O[3]+3572445317&4294967295,M=j+(D<<16&4294967295|D>>>16),D=N+(M^j^I)+O[6]+76029189&4294967295,N=M+(D<<23&4294967295|D>>>9),D=I+(N^M^j)+O[9]+3654602809&4294967295,I=N+(D<<4&4294967295|D>>>28),D=j+(I^N^M)+O[12]+3873151461&4294967295,j=I+(D<<11&4294967295|D>>>21),D=M+(j^I^N)+O[15]+530742520&4294967295,M=j+(D<<16&4294967295|D>>>16),D=N+(M^j^I)+O[2]+3299628645&4294967295,N=M+(D<<23&4294967295|D>>>9),D=I+(M^(N|~j))+O[0]+4096336452&4294967295,I=N+(D<<6&4294967295|D>>>26),D=j+(N^(I|~M))+O[7]+1126891415&4294967295,j=I+(D<<10&4294967295|D>>>22),D=M+(I^(j|~N))+O[14]+2878612391&4294967295,M=j+(D<<15&4294967295|D>>>17),D=N+(j^(M|~I))+O[5]+4237533241&4294967295,N=M+(D<<21&4294967295|D>>>11),D=I+(M^(N|~j))+O[12]+1700485571&4294967295,I=N+(D<<6&4294967295|D>>>26),D=j+(N^(I|~M))+O[3]+2399980690&4294967295,j=I+(D<<10&4294967295|D>>>22),D=M+(I^(j|~N))+O[10]+4293915773&4294967295,M=j+(D<<15&4294967295|D>>>17),D=N+(j^(M|~I))+O[1]+2240044497&4294967295,N=M+(D<<21&4294967295|D>>>11),D=I+(M^(N|~j))+O[8]+1873313359&4294967295,I=N+(D<<6&4294967295|D>>>26),D=j+(N^(I|~M))+O[15]+4264355552&4294967295,j=I+(D<<10&4294967295|D>>>22),D=M+(I^(j|~N))+O[6]+2734768916&4294967295,M=j+(D<<15&4294967295|D>>>17),D=N+(j^(M|~I))+O[13]+1309151649&4294967295,N=M+(D<<21&4294967295|D>>>11),D=I+(M^(N|~j))+O[4]+4149444226&4294967295,I=N+(D<<6&4294967295|D>>>26),D=j+(N^(I|~M))+O[11]+3174756917&4294967295,j=I+(D<<10&4294967295|D>>>22),D=M+(I^(j|~N))+O[2]+718787259&4294967295,M=j+(D<<15&4294967295|D>>>17),D=N+(j^(M|~I))+O[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,k.g[2]=k.g[2]+M&4294967295,k.g[3]=k.g[3]+j&4294967295}i.prototype.v=function(k,I){I===void 0&&(I=k.length);const N=I-this.blockSize,O=this.C;let M=this.h,j=0;for(;j<I;){if(M==0)for(;j<=N;)r(this,k,j),j+=this.blockSize;if(typeof k=="string"){for(;j<I;)if(O[M++]=k.charCodeAt(j++),M==this.blockSize){r(this,O),M=0;break}}else for(;j<I;)if(O[M++]=k[j++],M==this.blockSize){r(this,O),M=0;break}}this.h=M,this.o+=I},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var N=k.length-8;N<k.length;++N)k[N]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,N=0;N<4;++N)for(let O=0;O<32;O+=8)k[I++]=this.g[N]>>>O&255;return k};function s(k,I){var N=u;return Object.prototype.hasOwnProperty.call(N,k)?N[k]:N[k]=I(k)}function a(k,I){this.h=I;const N=[];let O=!0;for(let M=k.length-1;M>=0;M--){const j=k[M]|0;O&&j==I||(N[M]=j,O=!1)}this.g=N}var u={};function c(k){return-128<=k&&k<128?s(k,function(I){return new a([I|0],I<0?-1:0)}):new a([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return m;if(k<0)return V(h(-k));const I=[];let N=1;for(let O=0;k>=N;O++)I[O]=k/N|0,N*=4294967296;return new a(I,0)}function p(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return V(p(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=h(Math.pow(I,8));let O=m;for(let j=0;j<k.length;j+=8){var M=Math.min(8,k.length-j);const D=parseInt(k.substring(j,j+M),I);M<8?(M=h(Math.pow(I,M)),O=O.j(M).add(h(D))):(O=O.j(N),O=O.add(h(D)))}return O}var m=c(0),_=c(1),T=c(16777216);t=a.prototype,t.m=function(){if(b(this))return-V(this).m();let k=0,I=1;for(let N=0;N<this.g.length;N++){const O=this.i(N);k+=(O>=0?O:4294967296+O)*I,I*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(A(this))return"0";if(b(this))return"-"+V(this).toString(k);const I=h(Math.pow(k,6));var N=this;let O="";for(;;){const M=U(N,I).g;N=C(N,M.j(I));let j=((N.g.length>0?N.g[0]:N.h)>>>0).toString(k);if(N=M,A(N))return j+O;for(;j.length<6;)j="0"+j;O=j+O}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function A(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function b(k){return k.h==-1}t.l=function(k){return k=C(this,k),b(k)?-1:A(k)?0:1};function V(k){const I=k.g.length,N=[];for(let O=0;O<I;O++)N[O]=~k.g[O];return new a(N,~k.h).add(_)}t.abs=function(){return b(this)?V(this):this},t.add=function(k){const I=Math.max(this.g.length,k.g.length),N=[];let O=0;for(let M=0;M<=I;M++){let j=O+(this.i(M)&65535)+(k.i(M)&65535),D=(j>>>16)+(this.i(M)>>>16)+(k.i(M)>>>16);O=D>>>16,j&=65535,D&=65535,N[M]=D<<16|j}return new a(N,N[N.length-1]&-2147483648?-1:0)};function C(k,I){return k.add(V(I))}t.j=function(k){if(A(this)||A(k))return m;if(b(this))return b(k)?V(this).j(V(k)):V(V(this).j(k));if(b(k))return V(this.j(V(k)));if(this.l(T)<0&&k.l(T)<0)return h(this.m()*k.m());const I=this.g.length+k.g.length,N=[];for(var O=0;O<2*I;O++)N[O]=0;for(O=0;O<this.g.length;O++)for(let M=0;M<k.g.length;M++){const j=this.i(O)>>>16,D=this.i(O)&65535,xe=k.i(M)>>>16,Nt=k.i(M)&65535;N[2*O+2*M]+=D*Nt,S(N,2*O+2*M),N[2*O+2*M+1]+=j*Nt,S(N,2*O+2*M+1),N[2*O+2*M+1]+=D*xe,S(N,2*O+2*M+1),N[2*O+2*M+2]+=j*xe,S(N,2*O+2*M+2)}for(k=0;k<I;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=I;k<2*I;k++)N[k]=0;return new a(N,0)};function S(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function R(k,I){this.g=k,this.h=I}function U(k,I){if(A(I))throw Error("division by zero");if(A(k))return new R(m,m);if(b(k))return I=U(V(k),I),new R(V(I.g),V(I.h));if(b(I))return I=U(k,V(I)),new R(V(I.g),I.h);if(k.g.length>30){if(b(k)||b(I))throw Error("slowDivide_ only works with positive integers.");for(var N=_,O=I;O.l(k)<=0;)N=W(N),O=W(O);var M=K(N,1),j=K(O,1);for(O=K(O,2),N=K(N,2);!A(O);){var D=j.add(O);D.l(k)<=0&&(M=M.add(N),j=D),O=K(O,1),N=K(N,1)}return I=C(k,M.j(I)),new R(M,I)}for(M=m;k.l(I)>=0;){for(N=Math.max(1,Math.floor(k.m()/I.m())),O=Math.ceil(Math.log(N)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),j=h(N),D=j.j(I);b(D)||D.l(k)>0;)N-=O,j=h(N),D=j.j(I);A(j)&&(j=_),M=M.add(j),k=C(k,D)}return new R(M,k)}t.B=function(k){return U(this,k).h},t.and=function(k){const I=Math.max(this.g.length,k.g.length),N=[];for(let O=0;O<I;O++)N[O]=this.i(O)&k.i(O);return new a(N,this.h&k.h)},t.or=function(k){const I=Math.max(this.g.length,k.g.length),N=[];for(let O=0;O<I;O++)N[O]=this.i(O)|k.i(O);return new a(N,this.h|k.h)},t.xor=function(k){const I=Math.max(this.g.length,k.g.length),N=[];for(let O=0;O<I;O++)N[O]=this.i(O)^k.i(O);return new a(N,this.h^k.h)};function W(k){const I=k.g.length+1,N=[];for(let O=0;O<I;O++)N[O]=k.i(O)<<1|k.i(O-1)>>>31;return new a(N,k.h)}function K(k,I){const N=I>>5;I%=32;const O=k.g.length-N,M=[];for(let j=0;j<O;j++)M[j]=I>0?k.i(j+N)>>>I|k.i(j+N+1)<<32-I:k.i(j+N);return new a(M,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,MR=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,Fs=a}).apply(typeof f1<"u"?f1:typeof self<"u"?self:typeof window<"u"?window:{});var hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var OR,vc,VR,Vf,Uy,FR,jR,UR;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof hf=="object"&&hf];for(var y=0;y<d.length;++y){var w=d[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=n(this);function r(d,y){if(y)e:{var w=i;d=d.split(".");for(var P=0;P<d.length-1;P++){var z=d[P];if(!(z in w))break e;w=w[z]}d=d[d.length-1],P=w[d],y=y(P),y!=P&&y!=null&&e(w,d,{configurable:!0,writable:!0,value:y})}}r("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(d){return d||function(y){var w=[],P;for(P in y)Object.prototype.hasOwnProperty.call(y,P)&&w.push([P,y[P]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function u(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function c(d,y,w){return d.call.apply(d.bind,arguments)}function h(d,y,w){return h=c,h.apply(null,arguments)}function p(d,y){var w=Array.prototype.slice.call(arguments,1);return function(){var P=w.slice();return P.push.apply(P,arguments),d.apply(this,P)}}function m(d,y){function w(){}w.prototype=y.prototype,d.Z=y.prototype,d.prototype=new w,d.prototype.constructor=d,d.Ob=function(P,z,$){for(var te=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)te[ue-2]=arguments[ue];return y.prototype[z].apply(P,te)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function T(d){const y=d.length;if(y>0){const w=Array(y);for(let P=0;P<y;P++)w[P]=d[P];return w}return[]}function A(d,y){for(let P=1;P<arguments.length;P++){const z=arguments[P];var w=typeof z;if(w=w!="object"?w:z?Array.isArray(z)?"array":w:"null",w=="array"||w=="object"&&typeof z.length=="number"){w=d.length||0;const $=z.length||0;d.length=w+$;for(let te=0;te<$;te++)d[w+te]=z[te]}else d.push(z)}}class b{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function V(d){a.setTimeout(()=>{throw d},0)}function C(){var d=k;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class S{constructor(){this.h=this.g=null}add(y,w){const P=R.get();P.set(y,w),this.h?this.h.next=P:this.g=P,this.h=P}}var R=new b(()=>new U,d=>d.reset());class U{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let W,K=!1,k=new S,I=()=>{const d=Promise.resolve(void 0);W=()=>{d.then(N)}};function N(){for(var d;d=C();){try{d.h.call(d.g)}catch(w){V(w)}var y=R;y.j(d),y.h<100&&(y.h++,d.next=y.g,y.g=d)}K=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const w=()=>{};a.addEventListener("test",w,y),a.removeEventListener("test",w,y)}catch{}return d}();function D(d){return/^[\s\xa0]*$/.test(d)}function xe(d,y){M.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,y)}m(xe,M),xe.prototype.init=function(d,y){const w=this.type=d.type,P=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget,y||(w=="mouseover"?y=d.fromElement:w=="mouseout"&&(y=d.toElement)),this.relatedTarget=y,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Nt="closure_listenable_"+(Math.random()*1e6|0),Ge=0;function he(d,y,w,P,z){this.listener=d,this.proxy=null,this.src=y,this.type=w,this.capture=!!P,this.ha=z,this.key=++Ge,this.da=this.fa=!1}function q(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function re(d,y,w){for(const P in d)y.call(w,d[P],P,d)}function X(d,y){for(const w in d)y.call(void 0,d[w],w,d)}function le(d){const y={};for(const w in d)y[w]=d[w];return y}const Se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(d,y){let w,P;for(let z=1;z<arguments.length;z++){P=arguments[z];for(w in P)d[w]=P[w];for(let $=0;$<Se.length;$++)w=Se[$],Object.prototype.hasOwnProperty.call(P,w)&&(d[w]=P[w])}}function Ve(d){this.src=d,this.g={},this.h=0}Ve.prototype.add=function(d,y,w,P,z){const $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);const te=ye(d,y,P,z);return te>-1?(y=d[te],w||(y.fa=!1)):(y=new he(y,this.src,$,!!P,z),y.fa=w,d.push(y)),y};function Ne(d,y){const w=y.type;if(w in d.g){var P=d.g[w],z=Array.prototype.indexOf.call(P,y,void 0),$;($=z>=0)&&Array.prototype.splice.call(P,z,1),$&&(q(y),d.g[w].length==0&&(delete d.g[w],d.h--))}}function ye(d,y,w,P){for(let z=0;z<d.length;++z){const $=d[z];if(!$.da&&$.listener==y&&$.capture==!!w&&$.ha==P)return z}return-1}var Ut="closure_lm_"+(Math.random()*1e6|0),Yn={};function vu(d,y,w,P,z){if(P&&P.once)return is(d,y,w,P,z);if(Array.isArray(y)){for(let $=0;$<y.length;$++)vu(d,y[$],w,P,z);return null}return w=xu(w),d&&d[Nt]?d.J(y,w,u(P)?!!P.capture:!!P,z):va(d,y,w,!1,P,z)}function va(d,y,w,P,z,$){if(!y)throw Error("Invalid event type");const te=u(z)?!!z.capture:!!z;let ue=po(d);if(ue||(d[Ut]=ue=new Ve(d)),w=ue.add(y,w,P,te,$),w.proxy)return w;if(P=wu(),w.proxy=P,P.src=d,P.listener=w,d.addEventListener)j||(z=te),z===void 0&&(z=!1),d.addEventListener(y.toString(),P,z);else if(d.attachEvent)d.attachEvent(Tu(y.toString()),P);else if(d.addListener&&d.removeListener)d.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return w}function wu(){function d(w){return y.call(d.src,d.listener,w)}const y=pd;return d}function is(d,y,w,P,z){if(Array.isArray(y)){for(let $=0;$<y.length;$++)is(d,y[$],w,P,z);return null}return w=xu(w),d&&d[Nt]?d.K(y,w,u(P)?!!P.capture:!!P,z):va(d,y,w,!0,P,z)}function wa(d,y,w,P,z){if(Array.isArray(y))for(var $=0;$<y.length;$++)wa(d,y[$],w,P,z);else P=u(P)?!!P.capture:!!P,w=xu(w),d&&d[Nt]?(d=d.i,$=String(y).toString(),$ in d.g&&(y=d.g[$],w=ye(y,w,P,z),w>-1&&(q(y[w]),Array.prototype.splice.call(y,w,1),y.length==0&&(delete d.g[$],d.h--)))):d&&(d=po(d))&&(y=d.g[y.toString()],d=-1,y&&(d=ye(y,w,P,z)),(w=d>-1?y[d]:null)&&Eu(w))}function Eu(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[Nt])Ne(y.i,d);else{var w=d.type,P=d.proxy;y.removeEventListener?y.removeEventListener(w,P,d.capture):y.detachEvent?y.detachEvent(Tu(w),P):y.addListener&&y.removeListener&&y.removeListener(P),(w=po(y))?(Ne(w,d),w.h==0&&(w.src=null,y[Ut]=null)):q(d)}}}function Tu(d){return d in Yn?Yn[d]:Yn[d]="on"+d}function pd(d,y){if(d.da)d=!0;else{y=new xe(y,this);const w=d.listener,P=d.ha||d.src;d.fa&&Eu(d),d=w.call(P,y)}return d}function po(d){return d=d[Ut],d instanceof Ve?d:null}var rs="__closure_events_fn_"+(Math.random()*1e9>>>0);function xu(d){return typeof d=="function"?d:(d[rs]||(d[rs]=function(y){return d.handleEvent(y)}),d[rs])}function Lt(){O.call(this),this.i=new Ve(this),this.M=this,this.G=null}m(Lt,O),Lt.prototype[Nt]=!0,Lt.prototype.removeEventListener=function(d,y,w,P){wa(this,d,y,w,P)};function Dt(d,y){var w,P=d.G;if(P)for(w=[];P;P=P.G)w.push(P);if(d=d.M,P=y.type||y,typeof y=="string")y=new M(y,d);else if(y instanceof M)y.target=y.target||d;else{var z=y;y=new M(P,d),nt(y,z)}z=!0;let $,te;if(w)for(te=w.length-1;te>=0;te--)$=y.g=w[te],z=mo($,P,!0,y)&&z;if($=y.g=d,z=mo($,P,!0,y)&&z,z=mo($,P,!1,y)&&z,w)for(te=0;te<w.length;te++)$=y.g=w[te],z=mo($,P,!1,y)&&z}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var d=this.i;for(const y in d.g){const w=d.g[y];for(let P=0;P<w.length;P++)q(w[P]);delete d.g[y],d.h--}}this.G=null},Lt.prototype.J=function(d,y,w,P){return this.i.add(String(d),y,!1,w,P)},Lt.prototype.K=function(d,y,w,P){return this.i.add(String(d),y,!0,w,P)};function mo(d,y,w,P){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();let z=!0;for(let $=0;$<y.length;++$){const te=y[$];if(te&&!te.da&&te.capture==w){const ue=te.listener,pt=te.ha||te.src;te.fa&&Ne(d.i,te),z=ue.call(pt,P)!==!1&&z}}return z&&!P.defaultPrevented}function md(d,y){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=h(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:a.setTimeout(d,y||0)}function gd(d){d.g=md(()=>{d.g=null,d.i&&(d.i=!1,gd(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class dg extends O{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:gd(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _r(d){O.call(this),this.h=d,this.g={}}m(_r,O);var Su=[];function Cu(d){re(d.g,function(y,w){this.g.hasOwnProperty(w)&&Eu(y)},d),d.g={}}_r.prototype.N=function(){_r.Z.N.call(this),Cu(this)},_r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Iu=a.JSON.stringify,_d=a.JSON.parse,yd=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function vd(){}function Pu(){}var yr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ea(){M.call(this,"d")}m(Ea,M);function Au(){M.call(this,"c")}m(Au,M);var Bn={},wd=null;function Ta(){return wd=wd||new Lt}Bn.Ia="serverreachability";function Ru(d){M.call(this,Bn.Ia,d)}m(Ru,M);function ss(d){const y=Ta();Dt(y,new Ru(y))}Bn.STAT_EVENT="statevent";function bu(d,y){M.call(this,Bn.STAT_EVENT,d),this.stat=y}m(bu,M);function Yt(d){const y=Ta();Dt(y,new bu(y,d))}Bn.Ja="timingevent";function Ed(d,y){M.call(this,Bn.Ja,d),this.size=y}m(Ed,M);function go(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},y)}function _o(){this.g=!0}_o.prototype.ua=function(){this.g=!1};function fg(d,y,w,P,z,$){d.info(function(){if(d.g)if($){var te="",ue=$.split("&");for(let ze=0;ze<ue.length;ze++){var pt=ue[ze].split("=");if(pt.length>1){const xt=pt[0];pt=pt[1];const An=xt.split("_");te=An.length>=2&&An[1]=="type"?te+(xt+"="+pt+"&"):te+(xt+"=redacted&")}}}else te=null;else te=$;return"XMLHTTP REQ ("+P+") [attempt "+z+"]: "+y+`
`+w+`
`+te})}function pg(d,y,w,P,z,$,te){d.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+z+"]: "+y+`
`+w+`
`+$+" "+te})}function Fi(d,y,w,P){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+gg(d,w)+(P?" "+P:"")})}function mg(d,y){d.info(function(){return"TIMEOUT: "+y})}_o.prototype.info=function(){};function gg(d,y){if(!d.g)return y;if(!y)return null;try{const $=JSON.parse(y);if($){for(d=0;d<$.length;d++)if(Array.isArray($[d])){var w=$[d];if(!(w.length<2)){var P=w[1];if(Array.isArray(P)&&!(P.length<1)){var z=P[0];if(z!="noop"&&z!="stop"&&z!="close")for(let te=1;te<P.length;te++)P[te]=""}}}}return Iu($)}catch{return y}}var xa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Td={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},zn;function ae(){}m(ae,vd),ae.prototype.g=function(){return new XMLHttpRequest},zn=new ae;function os(d){return encodeURIComponent(String(d))}function xd(d){var y=1;d=d.split(":");const w=[];for(;y>0&&d.length;)w.push(d.shift()),y--;return d.length&&w.push(d.join(":")),w}function gi(d,y,w,P){this.j=d,this.i=y,this.l=w,this.S=P||1,this.V=new _r(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ku}function ku(){this.i=null,this.g="",this.h=!1}var Sa={},Ca={};function ji(d,y,w){d.M=1,d.A=ls(Xt(y)),d.u=w,d.R=!0,Nu(d,null)}function Nu(d,y){d.F=Date.now(),Ia(d),d.B=Xt(d.A);var w=d.B,P=d.S;Array.isArray(P)||(P=[String(P)]),wo(w.i,"t",P),d.C=0,w=d.j.L,d.h=new ku,d.g=Va(d.j,w?y:null,!d.u),d.P>0&&(d.O=new dg(h(d.Y,d,d.g),d.P)),y=d.V,w=d.g,P=d.ba;var z="readystatechange";Array.isArray(z)||(z&&(Su[0]=z.toString()),z=Su);for(let $=0;$<z.length;$++){const te=vu(w,z[$],P||y.handleEvent,!1,y.h||y);if(!te)break;y.g[te.key]=te}y=d.J?le(d.J):{},d.u?(d.v||(d.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,y)):(d.v="GET",d.g.ea(d.B,d.v,null,y)),ss(),fg(d.i,d.v,d.B,d.l,d.S,d.u)}gi.prototype.ba=function(d){d=d.target;const y=this.O;y&&wi(d)==3?y.j():this.Y(d)},gi.prototype.Y=function(d){try{if(d==this.g)e:{const ue=wi(this.g),pt=this.g.ya(),ze=this.g.ca();if(!(ue<3)&&(ue!=3||this.g&&(this.h.h||this.g.la()||Ma(this.g)))){this.K||ue!=4||pt==7||(pt==8||ze<=0?ss(3):ss(2)),Du(this);var y=this.g.ca();this.X=y;var w=_g(this);if(this.o=y==200,pg(this.i,this.v,this.B,this.l,this.S,ue,y),this.o){if(this.U&&!this.L){t:{if(this.g){var P,z=this.g;if((P=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(P)){var $=P;break t}}$=null}if(d=$)Fi(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Mu(this,d);else{this.o=!1,this.m=3,Yt(12),vr(this),Ui(this);break e}}if(this.R){d=!0;let xt;for(;!this.K&&this.C<w.length;)if(xt=yg(this,w),xt==Ca){ue==4&&(this.m=4,Yt(14),d=!1),Fi(this.i,this.l,null,"[Incomplete Response]");break}else if(xt==Sa){this.m=4,Yt(15),Fi(this.i,this.l,w,"[Invalid Chunk]"),d=!1;break}else Fi(this.i,this.l,xt,null),Mu(this,xt);if(Sd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ue!=4||w.length!=0||this.h.h||(this.m=1,Yt(16),d=!1),this.o=this.o&&d,!d)Fi(this.i,this.l,w,"[Invalid Chunked Response]"),vr(this),Ui(this);else if(w.length>0&&!this.W){this.W=!0;var te=this.j;te.g==this&&te.aa&&!te.P&&(te.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),So(te),te.P=!0,Yt(11))}}else Fi(this.i,this.l,w,null),Mu(this,w);ue==4&&vr(this),this.o&&!this.K&&(ue==4?bd(this.j,this):(this.o=!1,Ia(this)))}else Eg(this.g),y==400&&w.indexOf("Unknown SID")>0?(this.m=3,Yt(12)):(this.m=0,Yt(13)),vr(this),Ui(this)}}}catch{}finally{}};function _g(d){if(!Sd(d))return d.g.la();const y=Ma(d.g);if(y==="")return"";let w="";const P=y.length,z=wi(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return vr(d),Ui(d),"";d.h.i=new a.TextDecoder}for(let $=0;$<P;$++)d.h.h=!0,w+=d.h.i.decode(y[$],{stream:!(z&&$==P-1)});return y.length=0,d.h.g+=w,d.C=0,d.h.g}function Sd(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function yg(d,y){var w=d.C,P=y.indexOf(`
`,w);return P==-1?Ca:(w=Number(y.substring(w,P)),isNaN(w)?Sa:(P+=1,P+w>y.length?Ca:(y=y.slice(P,P+w),d.C=P+w,y)))}gi.prototype.cancel=function(){this.K=!0,vr(this)};function Ia(d){d.T=Date.now()+d.H,Lu(d,d.H)}function Lu(d,y){if(d.D!=null)throw Error("WatchDog timer not null");d.D=go(h(d.aa,d),y)}function Du(d){d.D&&(a.clearTimeout(d.D),d.D=null)}gi.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(mg(this.i,this.B),this.M!=2&&(ss(),Yt(17)),vr(this),this.m=2,Ui(this)):Lu(this,this.T-d)};function Ui(d){d.j.I==0||d.K||bd(d.j,d)}function vr(d){Du(d);var y=d.O;y&&typeof y.dispose=="function"&&y.dispose(),d.O=null,Cu(d.V),d.g&&(y=d.g,d.g=null,y.abort(),y.dispose())}function Mu(d,y){try{var w=d.j;if(w.I!=0&&(w.g==d||wr(w.h,d))){if(!d.L&&wr(w.h,d)&&w.I==3){try{var P=w.Ba.g.parse(y)}catch{P=null}if(Array.isArray(P)&&P.length==3){var z=P;if(z[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<d.F)yn(w),on(w);else break e;Wu(w),Yt(18)}}else w.xa=z[1],0<w.xa-w.K&&z[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=go(h(w.Va,w),6e3));Pa(w.h)<=1&&w.ta&&(w.ta=void 0)}else an(w,11)}else if((d.L||w.g==d)&&yn(w),!D(y))for(z=w.Ba.g.parse(y),y=0;y<z.length;y++){let ze=z[y];const xt=ze[0];if(!(xt<=w.K))if(w.K=xt,ze=ze[1],w.I==2)if(ze[0]=="c"){w.M=ze[1],w.ba=ze[2];const An=ze[3];An!=null&&(w.ka=An,w.j.info("VER="+w.ka));const Ei=ze[4];Ei!=null&&(w.za=Ei,w.j.info("SVER="+w.za));const qi=ze[5];qi!=null&&typeof qi=="number"&&qi>0&&(P=1.5*qi,w.O=P,w.j.info("backChannelRequestTimeoutMs_="+P)),P=w;const Gi=d.g;if(Gi){const Io=Gi.g?Gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Io){var $=P.h;$.g||Io.indexOf("spdy")==-1&&Io.indexOf("quic")==-1&&Io.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Aa($,$.h),$.h=null))}if(P.G){const Gu=Gi.g?Gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Gu&&(P.wa=Gu,_e(P.J,P.G,Gu))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-d.F,w.j.info("Handshake RTT: "+w.T+"ms")),P=w;var te=d;if(P.na=qu(P,P.L?P.ba:null,P.W),te.L){Ou(P.h,te);var ue=te,pt=P.O;pt&&(ue.H=pt),ue.D&&(Du(ue),Ia(ue)),P.g=te}else Ad(P);w.i.length>0&&To(w)}else ze[0]!="stop"&&ze[0]!="close"||an(w,7);else w.I==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?an(w,7):Bu(w):ze[0]!="noop"&&w.l&&w.l.qa(ze),w.A=0)}}ss(4)}catch{}}var vg=class{constructor(d,y){this.g=d,this.map=y}};function Cd(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Id(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Pa(d){return d.h?1:d.g?d.g.size:0}function wr(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function Aa(d,y){d.g?d.g.add(y):d.h=y}function Ou(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}Cd.prototype.cancel=function(){if(this.i=as(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function as(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const w of d.g.values())y=y.concat(w.G);return y}return T(d.i)}var Me=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ye(d,y){if(d){d=d.split("&");for(let w=0;w<d.length;w++){const P=d[w].indexOf("=");let z,$=null;P>=0?(z=d[w].substring(0,P),$=d[w].substring(P+1)):z=d[w],y(z,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Wn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;d instanceof Wn?(this.l=d.l,Xn(this,d.j),this.o=d.o,this.g=d.g,Er(this,d.u),this.h=d.h,we(this,ka(d.i)),this.m=d.m):d&&(y=String(d).match(Me))?(this.l=!1,Xn(this,y[1]||"",!0),this.o=Bi(y[2]||""),this.g=Bi(y[3]||"",!0),Er(this,y[4]),this.h=Bi(y[5]||"",!0),we(this,y[6]||"",!0),this.m=Bi(y[7]||"")):(this.l=!1,this.i=new _i(null,this.l))}Wn.prototype.toString=function(){const d=[];var y=this.j;y&&d.push(Bt(y,yo,!0),":");var w=this.g;return(w||y=="file")&&(d.push("//"),(y=this.o)&&d.push(Bt(y,yo,!0),"@"),d.push(os(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&d.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&d.push("/"),d.push(Bt(w,w.charAt(0)=="/"?ft:Tr,!0))),(w=this.i.toString())&&d.push("?",w),(w=this.m)&&d.push("#",Bt(w,vo)),d.join("")},Wn.prototype.resolve=function(d){const y=Xt(this);let w=!!d.j;w?Xn(y,d.j):w=!!d.o,w?y.o=d.o:w=!!d.g,w?y.g=d.g:w=d.u!=null;var P=d.h;if(w)Er(y,d.u);else if(w=!!d.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var z=y.h.lastIndexOf("/");z!=-1&&(P=y.h.slice(0,z+1)+P)}if(z=P,z==".."||z==".")P="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){P=z.lastIndexOf("/",0)==0,z=z.split("/");const $=[];for(let te=0;te<z.length;){const ue=z[te++];ue=="."?P&&te==z.length&&$.push(""):ue==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),P&&te==z.length&&$.push("")):($.push(ue),P=!0)}P=$.join("/")}else P=z}return w?y.h=P:w=d.i.toString()!=="",w?we(y,ka(d.i)):w=!!d.m,w&&(y.m=d.m),y};function Xt(d){return new Wn(d)}function Xn(d,y,w){d.j=w?Bi(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function Er(d,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);d.u=y}else d.u=null}function we(d,y,w){y instanceof _i?(d.i=y,Na(d.i,d.l)):(w||(y=Bt(y,xr)),d.i=new _i(y,d.l))}function _e(d,y,w){d.i.set(y,w)}function ls(d){return _e(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Bi(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Bt(d,y,w){return typeof d=="string"?(d=encodeURI(d).replace(y,wg),w&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function wg(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var yo=/[#\/\?@]/g,Tr=/[#\?:]/g,ft=/[#\?]/g,xr=/[#\?@]/g,vo=/#/g;function _i(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function yi(d){d.g||(d.g=new Map,d.h=0,d.i&&Ye(d.i,function(y,w){d.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}t=_i.prototype,t.add=function(d,y){yi(this),this.i=null,d=zi(this,d);let w=this.g.get(d);return w||this.g.set(d,w=[]),w.push(y),this.h+=1,this};function us(d,y){yi(d),y=zi(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function Ra(d,y){return yi(d),y=zi(d,y),d.g.has(y)}t.forEach=function(d,y){yi(this),this.g.forEach(function(w,P){w.forEach(function(z){d.call(y,z,P,this)},this)},this)};function ba(d,y){yi(d);let w=[];if(typeof y=="string")Ra(d,y)&&(w=w.concat(d.g.get(zi(d,y))));else for(d=Array.from(d.g.values()),y=0;y<d.length;y++)w=w.concat(d[y]);return w}t.set=function(d,y){return yi(this),this.i=null,d=zi(this,d),Ra(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},t.get=function(d,y){return d?(d=ba(this,d),d.length>0?String(d[0]):y):y};function wo(d,y,w){us(d,y),w.length>0&&(d.i=null,d.g.set(zi(d,y),T(w)),d.h+=w.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(let P=0;P<y.length;P++){var w=y[P];const z=os(w);w=ba(this,w);for(let $=0;$<w.length;$++){let te=z;w[$]!==""&&(te+="="+os(w[$])),d.push(te)}}return this.i=d.join("&")};function ka(d){const y=new _i;return y.i=d.i,d.g&&(y.g=new Map(d.g),y.h=d.h),y}function zi(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function Na(d,y){y&&!d.j&&(yi(d),d.i=null,d.g.forEach(function(w,P){const z=P.toLowerCase();P!=z&&(us(this,P),wo(this,z,w))},d)),d.j=y}function Pd(d,y){const w=new _o;if(a.Image){const P=new Image;P.onload=p(Wi,w,"TestLoadImage: loaded",!0,y,P),P.onerror=p(Wi,w,"TestLoadImage: error",!1,y,P),P.onabort=p(Wi,w,"TestLoadImage: abort",!1,y,P),P.ontimeout=p(Wi,w,"TestLoadImage: timeout",!1,y,P),a.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=d}else y(!1)}function Vu(d,y){const w=new _o,P=new AbortController,z=setTimeout(()=>{P.abort(),Wi(w,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:P.signal}).then($=>{clearTimeout(z),$.ok?Wi(w,"TestPingServer: ok",!0,y):Wi(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(z),Wi(w,"TestPingServer: error",!1,y)})}function Wi(d,y,w,P,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),P(w)}catch{}}function Ee(){this.g=new yd}function Pn(d){this.i=d.Sb||null,this.h=d.ab||!1}m(Pn,vd),Pn.prototype.g=function(){return new Ue(this.i,this.h)};function Ue(d,y){Lt.call(this),this.H=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Ue,Lt),t=Ue.prototype,t.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=y,this.readyState=1,Cr(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(y.body=d),(this.H||a).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sr(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Cr(this)),this.g&&(this.readyState=3,Cr(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Fu(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Fu(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Sr(this):Cr(this),this.readyState==3&&Fu(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Sr(this))},t.Na=function(d){this.g&&(this.response=d,Sr(this))},t.ga=function(){this.g&&Sr(this)};function Sr(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Cr(d)}t.setRequestHeader=function(d,y){this.A.append(d,y)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,d.push(w[0]+": "+w[1]),w=y.next();return d.join(`\r
`)};function Cr(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ue.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function La(d){let y="";return re(d,function(w,P){y+=P,y+=":",y+=w,y+=`\r
`}),y}function vi(d,y,w){e:{for(P in w){var P=!1;break e}P=!0}P||(w=La(w),typeof d=="string"?w!=null&&os(w):_e(d,y,w))}function Ke(d){Lt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Ke,Lt);var Eo=/^https?$/i,Mt=["POST","PUT"];t=Ke.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,y,w,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():zn.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch($){Hi(this,$);return}if(d=w||"",w=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var z in P)w.set(z,P[z]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const $ of P.keys())w.set($,P.get($));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(w.keys()).find($=>$.toLowerCase()=="content-type"),z=a.FormData&&d instanceof a.FormData,!(Array.prototype.indexOf.call(Mt,y,void 0)>=0)||P||z||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,te]of w)this.g.setRequestHeader($,te);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch($){Hi(this,$)}};function Hi(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.o=5,ju(d),Da(d)}function ju(d){d.A||(d.A=!0,Dt(d,"complete"),Dt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Dt(this,"complete"),Dt(this,"abort"),Da(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Da(this,!0)),Ke.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Uu(this):this.Xa())},t.Xa=function(){Uu(this)};function Uu(d){if(d.h&&typeof s<"u"){if(d.v&&wi(d)==4)setTimeout(d.Ca.bind(d),0);else if(Dt(d,"readystatechange"),wi(d)==4){d.h=!1;try{const $=d.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var P;if(P=$===0){let te=String(d.D).match(Me)[1]||null;!te&&a.self&&a.self.location&&(te=a.self.location.protocol.slice(0,-1)),P=!Eo.test(te?te.toLowerCase():"")}w=P}if(w)Dt(d,"complete"),Dt(d,"success");else{d.o=6;try{var z=wi(d)>2?d.g.statusText:""}catch{z=""}d.l=z+" ["+d.ca()+"]",ju(d)}}finally{Da(d)}}}}function Da(d,y){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const w=d.g;d.g=null,y||Dt(d,"ready");try{w.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function wi(d){return d.g?d.g.readyState:0}t.ca=function(){try{return wi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),_d(y)}};function Ma(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Eg(d){const y={};d=(d.g&&wi(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<d.length;P++){if(D(d[P]))continue;var w=xd(d[P]);const z=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const $=y[z]||[];y[z]=$,$.push(w)}X(y,function(P){return P.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function cs(d,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[d]||y}function Re(d){this.za=0,this.i=[],this.j=new _o,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=cs("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=cs("baseRetryDelayMs",5e3,d),this.Za=cs("retryDelaySeedMs",1e4,d),this.Ta=cs("forwardChannelMaxRetries",2,d),this.va=cs("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Cd(d&&d.concurrentRequestLimit),this.Ba=new Ee,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Re.prototype,t.ka=8,t.I=1,t.connect=function(d,y,w,P){Yt(0),this.W=d,this.H=y||{},w&&P!==void 0&&(this.H.OSID=w,this.H.OAID=P),this.F=this.X,this.J=qu(this,null,this.W),To(this)};function Bu(d){if(hs(d),d.I==3){var y=d.V++,w=Xt(d.J);if(_e(w,"SID",d.M),_e(w,"RID",y),_e(w,"TYPE","terminate"),xo(d,w),y=new gi(d,d.j,y),y.M=2,y.A=ls(Xt(w)),w=!1,a.navigator&&a.navigator.sendBeacon)try{w=a.navigator.sendBeacon(y.A.toString(),"")}catch{}!w&&a.Image&&(new Image().src=y.A,w=!0),w||(y.g=Va(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Ia(y)}$u(d)}function on(d){d.g&&(So(d),d.g.cancel(),d.g=null)}function hs(d){on(d),d.v&&(a.clearTimeout(d.v),d.v=null),yn(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&a.clearTimeout(d.m),d.m=null)}function To(d){if(!Id(d.h)&&!d.m){d.m=!0;var y=d.Ea;W||I(),K||(W(),K=!0),k.add(y,d),d.D=0}}function Tg(d,y){return Pa(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=y.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=go(h(d.Ea,d,y),Hu(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const z=new gi(this,this.j,d);let $=this.o;if(this.U&&($?($=le($),nt($,this.U)):$=this.U),this.u!==null||this.R||(z.J=$,$=null),this.S)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var P=this.i[w];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(y+=P,y>4096){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=zu(this,z,y),w=Xt(this.J),_e(w,"RID",d),_e(w,"CVER",22),this.G&&_e(w,"X-HTTP-Session-Id",this.G),xo(this,w),$&&(this.R?y="headers="+os(La($))+"&"+y:this.u&&vi(w,this.u,$)),Aa(this.h,z),this.Ra&&_e(w,"TYPE","init"),this.S?(_e(w,"$req",y),_e(w,"SID","null"),z.U=!0,ji(z,w,null)):ji(z,w,y),this.I=2}}else this.I==3&&(d?Oa(this,d):this.i.length==0||Id(this.h)||Oa(this))};function Oa(d,y){var w;y?w=y.l:w=d.V++;const P=Xt(d.J);_e(P,"SID",d.M),_e(P,"RID",w),_e(P,"AID",d.K),xo(d,P),d.u&&d.o&&vi(P,d.u,d.o),w=new gi(d,d.j,w,d.D+1),d.u===null&&(w.J=d.o),y&&(d.i=y.G.concat(d.i)),y=zu(d,w,1e3),w.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Aa(d.h,w),ji(w,P,y)}function xo(d,y){d.H&&re(d.H,function(w,P){_e(y,P,w)}),d.l&&re({},function(w,P){_e(y,P,w)})}function zu(d,y,w){w=Math.min(d.i.length,w);const P=d.l?h(d.l.Ka,d.l,d):null;e:{var z=d.i;let ue=-1;for(;;){const pt=["count="+w];ue==-1?w>0?(ue=z[0].g,pt.push("ofs="+ue)):ue=0:pt.push("ofs="+ue);let ze=!0;for(let xt=0;xt<w;xt++){var $=z[xt].g;const An=z[xt].map;if($-=ue,$<0)ue=Math.max(0,z[xt].g-100),ze=!1;else try{$="req"+$+"_"||"";try{var te=An instanceof Map?An:Object.entries(An);for(const[Ei,qi]of te){let Gi=qi;u(qi)&&(Gi=Iu(qi)),pt.push($+Ei+"="+encodeURIComponent(Gi))}}catch(Ei){throw pt.push($+"type="+encodeURIComponent("_badmap")),Ei}}catch{P&&P(An)}}if(ze){te=pt.join("&");break e}}te=void 0}return d=d.i.splice(0,w),y.G=d,te}function Ad(d){if(!d.g&&!d.v){d.Y=1;var y=d.Da;W||I(),K||(W(),K=!0),k.add(y,d),d.A=0}}function Wu(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=go(h(d.Da,d),Hu(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,Rd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=go(h(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Yt(10),on(this),Rd(this))};function So(d){d.B!=null&&(a.clearTimeout(d.B),d.B=null)}function Rd(d){d.g=new gi(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var y=Xt(d.na);_e(y,"RID","rpc"),_e(y,"SID",d.M),_e(y,"AID",d.K),_e(y,"CI",d.F?"0":"1"),!d.F&&d.ia&&_e(y,"TO",d.ia),_e(y,"TYPE","xmlhttp"),xo(d,y),d.u&&d.o&&vi(y,d.u,d.o),d.O&&(d.g.H=d.O);var w=d.g;d=d.ba,w.M=1,w.A=ls(Xt(y)),w.u=null,w.R=!0,Nu(w,d)}t.Va=function(){this.C!=null&&(this.C=null,on(this),Wu(this),Yt(19))};function yn(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function bd(d,y){var w=null;if(d.g==y){yn(d),So(d),d.g=null;var P=2}else if(wr(d.h,y))w=y.G,Ou(d.h,y),P=1;else return;if(d.I!=0){if(y.o)if(P==1){w=y.u?y.u.length:0,y=Date.now()-y.F;var z=d.D;P=Ta(),Dt(P,new Ed(P,w)),To(d)}else Ad(d);else if(z=y.m,z==3||z==0&&y.X>0||!(P==1&&Tg(d,y)||P==2&&Wu(d)))switch(w&&w.length>0&&(y=d.h,y.i=y.i.concat(w)),z){case 1:an(d,5);break;case 4:an(d,10);break;case 3:an(d,6);break;default:an(d,2)}}}function Hu(d,y){let w=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(w*=2),w*y}function an(d,y){if(d.j.info("Error code "+y),y==2){var w=h(d.bb,d),P=d.Ua;const z=!P;P=new Wn(P||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Xn(P,"https"),ls(P),z?Pd(P.toString(),w):Vu(P.toString(),w)}else Yt(2);d.I=0,d.l&&d.l.pa(y),$u(d),hs(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function $u(d){if(d.I=0,d.ja=[],d.l){const y=as(d.h);(y.length!=0||d.i.length!=0)&&(A(d.ja,y),A(d.ja,d.i),d.h.i.length=0,T(d.i),d.i.length=0),d.l.oa()}}function qu(d,y,w){var P=w instanceof Wn?Xt(w):new Wn(w);if(P.g!="")y&&(P.g=y+"."+P.g),Er(P,P.u);else{var z=a.location;P=z.protocol,y=y?y+"."+z.hostname:z.hostname,z=+z.port;const $=new Wn(null);P&&Xn($,P),y&&($.g=y),z&&Er($,z),w&&($.h=w),P=$}return w=d.G,y=d.wa,w&&y&&_e(P,w,y),_e(P,"VER",d.ka),xo(d,P),P}function Va(d,y,w){if(y&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Aa&&!d.ma?new Ke(new Pn({ab:w})):new Ke(d.ma),y.Fa(d.L),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function kd(){}t=kd.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Co(){}Co.prototype.g=function(d,y){return new ln(d,y)};function ln(d,y){Lt.call(this),this.g=new Re(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(d?d["X-WebChannel-Client-Profile"]=y.sa:d={"X-WebChannel-Client-Profile":y.sa}),this.g.U=d,(d=y&&y.Qb)&&!D(d)&&(this.g.u=d),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!D(y)&&(this.g.G=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new $i(this)}m(ln,Lt),ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){Bu(this.g)},ln.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var w={};w.__data__=d,d=w}else this.v&&(w={},w.__data__=Iu(d),d=w);y.i.push(new vg(y.Ya++,d)),y.I==3&&To(y)},ln.prototype.N=function(){this.g.l=null,delete this.j,Bu(this.g),delete this.g,ln.Z.N.call(this)};function Nd(d){Ea.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const w in y){d=w;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}m(Nd,Ea);function Ld(){Au.call(this),this.status=1}m(Ld,Au);function $i(d){this.g=d}m($i,kd),$i.prototype.ra=function(){Dt(this.g,"a")},$i.prototype.qa=function(d){Dt(this.g,new Nd(d))},$i.prototype.pa=function(d){Dt(this.g,new Ld)},$i.prototype.oa=function(){Dt(this.g,"b")},Co.prototype.createWebChannel=Co.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,UR=function(){return new Co},jR=function(){return Ta()},FR=Bn,Uy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xa.NO_ERROR=0,xa.TIMEOUT=8,xa.HTTP_ERROR=6,Vf=xa,Td.COMPLETE="complete",VR=Td,Pu.EventType=yr,yr.OPEN="a",yr.CLOSE="b",yr.ERROR="c",yr.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,vc=Pu,Ke.prototype.listenOnce=Ke.prototype.K,Ke.prototype.getLastError=Ke.prototype.Ha,Ke.prototype.getLastErrorCode=Ke.prototype.ya,Ke.prototype.getStatus=Ke.prototype.ca,Ke.prototype.getResponseJson=Ke.prototype.La,Ke.prototype.getResponseText=Ke.prototype.la,Ke.prototype.send=Ke.prototype.ea,Ke.prototype.setWithCredentials=Ke.prototype.Fa,OR=Ke}).apply(typeof hf<"u"?hf:typeof self<"u"?self:typeof window<"u"?window:{});const p1="@firebase/firestore",m1="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=new Im("@firebase/firestore");function Ga(){return ra.logLevel}function ie(t,...e){if(ra.logLevel<=be.DEBUG){const n=e.map(J0);ra.debug(`Firestore (${lu}): ${t}`,...n)}}function Kr(t,...e){if(ra.logLevel<=be.ERROR){const n=e.map(J0);ra.error(`Firestore (${lu}): ${t}`,...n)}}function Bl(t,...e){if(ra.logLevel<=be.WARN){const n=e.map(J0);ra.warn(`Firestore (${lu}): ${t}`,...n)}}function J0(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,BR(t,i,n)}function BR(t,e,n){let i=`FIRESTORE (${lu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Kr(i),new Error(i)}function We(t,e,n,i){let r="Unexpected state";typeof n=="string"?r=n:i=n,t||BR(e,r,i)}function Te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends ts{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class s3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(dn.UNAUTHENTICATED))}shutdown(){}}class o3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class a3{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){We(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let s=new Ur;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ur,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},u=c=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ur)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(We(typeof i.accessToken=="string",31837,{l:i}),new zR(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string",2055,{h:e}),new dn(e)}}class l3{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class u3{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new l3(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c3{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){We(this.o===void 0,3512);const i=s=>{s.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,ie("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new g1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(We(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new g1(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=h3(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=e.charAt(r[s]%62))}return i}}function Le(t,e){return t<e?-1:t>e?1:0}function By(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const r=t.charAt(i),s=e.charAt(i);if(r!==s)return l_(r)===l_(s)?Le(r,s):l_(r)?1:-1}return Le(t.length,e.length)}const d3=55296,f3=57343;function l_(t){const e=t.charCodeAt(0);return e>=d3&&e<=f3}function zl(t,e,n){return t.length===e.length&&t.every((i,r)=>n(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1="__name__";class Yi{constructor(e,n,i){n===void 0?n=0:n>e.length&&pe(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&pe(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return Yi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Yi?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let r=0;r<i;r++){const s=Yi.compareSegments(e.get(r),n.get(r));if(s!==0)return s}return Le(e.length,n.length)}static compareSegments(e,n){const i=Yi.isNumericId(e),r=Yi.isNumericId(n);return i&&!r?-1:!i&&r?1:i&&r?Yi.extractNumericId(e).compare(Yi.extractNumericId(n)):By(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class Je extends Yi{construct(e,n,i){return new Je(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new oe(Q.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new Je(n)}static emptyPath(){return new Je([])}}const p3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Yi{construct(e,n,i){return new tn(e,n,i)}static isValidIdentifier(e){return p3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_1}static keyField(){return new tn([_1])}static fromServerFormat(e){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new oe(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let a=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new oe(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new oe(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else u==="`"?(a=!a,r++):u!=="."||a?(i+=u,r++):(s(),r++)}if(s(),a)throw new oe(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(n)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(Je.fromString(e))}static fromName(e){return new ce(Je.fromString(e).popFirst(5))}static empty(){return new ce(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new Je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(t,e,n){if(!n)throw new oe(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function m3(t,e,n,i){if(e===!0&&i===!0)throw new oe(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function y1(t){if(!ce.isDocumentKey(t))throw new oe(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function v1(t){if(ce.isDocumentKey(t))throw new oe(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function HR(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function tw(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":pe(12329,{type:typeof t})}function Oi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tw(t);throw new oe(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t,e){const n={typeString:t};return e&&(n.value=e),n}function ed(t,e){if(!HR(t))throw new oe(Q.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const a=t[i];if(r&&typeof a!==r){n=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&a!==s.value){n=`Expected '${i}' field to equal '${s.value}'`;break}}if(n)throw new oe(Q.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1=-62135596800,E1=1e6;class et{static now(){return et.fromMillis(Date.now())}static fromDate(e){return et.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*E1);return new et(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<w1)throw new oe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/E1}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ed(e,et._jsonSchema))return new et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-w1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}et._jsonSchemaVersion="firestore/timestamp/1.0",et._jsonSchema={type:At("string",et._jsonSchemaVersion),seconds:At("number"),nanoseconds:At("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new et(0,0))}static max(){return new ve(new et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=-1;function g3(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=ve.fromTimestamp(i===1e9?new et(n+1,0):new et(n,i));return new qs(r,ce.empty(),e)}function _3(t){return new qs(t.readTime,t.key,wh)}class qs{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new qs(ve.min(),ce.empty(),wh)}static max(){return new qs(ve.max(),ce.empty(),wh)}}function y3(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uu(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==v3)throw t;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Z((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Z?n:Z.resolve(n)}catch(n){return Z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Z.reject(n)}static resolve(e){return new Z((n,i)=>{n(e)})}static reject(e){return new Z((n,i)=>{i(e)})}static waitFor(e){return new Z((n,i)=>{let r=0,s=0,a=!1;e.forEach(u=>{++r,u.next(()=>{++s,a&&s===r&&n()},c=>i(c))}),a=!0,s===r&&n()})}static or(e){let n=Z.resolve(!1);for(const i of e)n=n.next(r=>r?Z.resolve(r):i());return n}static forEach(e,n){const i=[];return e.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(e,n){return new Z((i,r)=>{const s=e.length,a=new Array(s);let u=0;for(let c=0;c<s;c++){const h=c;n(e[h]).next(p=>{a[h]=p,++u,u===s&&i(a)},p=>r(p))}})}static doWhile(e,n){return new Z((i,r)=>{const s=()=>{e()===!0?n().next(()=>{s()},r):i()};s()})}}function E3(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function cu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Lm.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=-1;function Dm(t){return t==null}function Rp(t){return t===0&&1/t==-1/0}function T3(t){return typeof t=="number"&&Number.isInteger(t)&&!Rp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="";function x3(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=T1(e)),e=S3(t.get(n),e);return T1(e)}function S3(t,e){let n=e;const i=t.length;for(let r=0;r<i;r++){const s=t.charAt(r);switch(s){case"\0":n+="";break;case $R:n+="";break;default:n+=s}}return n}function T1(t){return t+$R+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function co(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kt=class zy{constructor(e,n){this.comparator=e,this.root=n||js.EMPTY}insert(e,n){return new zy(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,js.BLACK,null,null))}remove(e){return new zy(this.comparator,this.root.remove(e,this.comparator).copy(null,null,js.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){const e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new df(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new df(this.root,e,this.comparator,!1)}getReverseIterator(){return new df(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new df(this.root,e,this.comparator,!0)}},df=class{constructor(e,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?i(e.key,n):1,n&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},js=class br{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??br.RED,this.left=r??br.EMPTY,this.right=s??br.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,r,s){return new br(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return br.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return br.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,br.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pe(27949);return e+(this.isRed()?0:1)}};js.EMPTY=null,js.RED=!0,js.BLACK=!1;js.EMPTY=new class{constructor(){this.size=0}get key(){throw pe(57766)}get value(){throw pe(16141)}get color(){throw pe(16727)}get left(){throw pe(29726)}get right(){throw pe(36894)}copy(e,n,i,r,s){return this}insert(e,n,i){return new js(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new S1(this.data.getIterator())}getIteratorFrom(e){return new S1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new jt(this.comparator);return n.data=e,n}}class S1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new qn([])}unionWith(e){let n=new jt(tn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zl(this.fields,e.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new GR("Invalid base64 string: "+s):s}}(e);return new sn(n)}static fromUint8Array(e){const n=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(e);return new sn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const C3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gs(t){if(We(!!t,39018),typeof t=="string"){let e=0;const n=C3.exec(t);if(We(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:wt(t.seconds),nanos:wt(t.nanos)}}function wt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?sn.fromBase64String(t):sn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR="server_timestamp",ZR="__type__",QR="__previous_value__",YR="__local_write_time__";function iw(t){var n,i;return((i=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[ZR])==null?void 0:i.stringValue)===KR}function Mm(t){const e=t.mapValue.fields[QR];return iw(e)?Mm(e):e}function Eh(t){const e=Gs(t.mapValue.fields[YR].timestampValue);return new et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e,n,i,r,s,a,u,c,h,p){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=p}}const bp="(default)";class Th{constructor(e,n){this.projectId=e,this.database=n||bp}static empty(){return new Th("","")}get isDefaultDatabase(){return this.database===bp}isEqual(e){return e instanceof Th&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR="__type__",JR="__max__",ff={mapValue:{fields:{__type__:{stringValue:JR}}}},eb="__vector__",kp="value";function Zs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?iw(t)?4:A3(t)?9007199254740991:P3(t)?10:11:pe(28295,{value:t})}function dr(t,e){if(t===e)return!0;const n=Zs(t);if(n!==Zs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Eh(t).isEqual(Eh(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const a=Gs(r.timestampValue),u=Gs(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Ks(r.bytesValue).isEqual(Ks(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return wt(r.geoPointValue.latitude)===wt(s.geoPointValue.latitude)&&wt(r.geoPointValue.longitude)===wt(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return wt(r.integerValue)===wt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const a=wt(r.doubleValue),u=wt(s.doubleValue);return a===u?Rp(a)===Rp(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return zl(t.arrayValue.values||[],e.arrayValue.values||[],dr);case 10:case 11:return function(r,s){const a=r.mapValue.fields||{},u=s.mapValue.fields||{};if(x1(a)!==x1(u))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(u[c]===void 0||!dr(a[c],u[c])))return!1;return!0}(t,e);default:return pe(52216,{left:t})}}function xh(t,e){return(t.values||[]).find(n=>dr(n,e))!==void 0}function Wl(t,e){if(t===e)return 0;const n=Zs(t),i=Zs(e);if(n!==i)return Le(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(s,a){const u=wt(s.integerValue||s.doubleValue),c=wt(a.integerValue||a.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return C1(t.timestampValue,e.timestampValue);case 4:return C1(Eh(t),Eh(e));case 5:return By(t.stringValue,e.stringValue);case 6:return function(s,a){const u=Ks(s),c=Ks(a);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const u=s.split("/"),c=a.split("/");for(let h=0;h<u.length&&h<c.length;h++){const p=Le(u[h],c[h]);if(p!==0)return p}return Le(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const u=Le(wt(s.latitude),wt(a.latitude));return u!==0?u:Le(wt(s.longitude),wt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return I1(t.arrayValue,e.arrayValue);case 10:return function(s,a){var _,T,A,b;const u=s.fields||{},c=a.fields||{},h=(_=u[kp])==null?void 0:_.arrayValue,p=(T=c[kp])==null?void 0:T.arrayValue,m=Le(((A=h==null?void 0:h.values)==null?void 0:A.length)||0,((b=p==null?void 0:p.values)==null?void 0:b.length)||0);return m!==0?m:I1(h,p)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===ff.mapValue&&a===ff.mapValue)return 0;if(s===ff.mapValue)return 1;if(a===ff.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const _=By(c[m],p[m]);if(_!==0)return _;const T=Wl(u[c[m]],h[p[m]]);if(T!==0)return T}return Le(c.length,p.length)}(t.mapValue,e.mapValue);default:throw pe(23264,{he:n})}}function C1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=Gs(t),i=Gs(e),r=Le(n.seconds,i.seconds);return r!==0?r:Le(n.nanos,i.nanos)}function I1(t,e){const n=t.values||[],i=e.values||[];for(let r=0;r<n.length&&r<i.length;++r){const s=Wl(n[r],i[r]);if(s)return s}return Le(n.length,i.length)}function Hl(t){return Wy(t)}function Wy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const i=Gs(n);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ks(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let i="[",r=!0;for(const s of n.values||[])r?r=!1:i+=",",i+=Wy(s);return i+"]"}(t.arrayValue):"mapValue"in t?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",s=!0;for(const a of i)s?s=!1:r+=",",r+=`${a}:${Wy(n.fields[a])}`;return r+"}"}(t.mapValue):pe(61005,{value:t})}function Ff(t){switch(Zs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mm(t);return e?16+Ff(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+Ff(s),0)}(t.arrayValue);case 10:case 11:return function(i){let r=0;return co(i.fields,(s,a)=>{r+=s.length+Ff(a)}),r}(t.mapValue);default:throw pe(13486,{value:t})}}function Hy(t){return!!t&&"integerValue"in t}function rw(t){return!!t&&"arrayValue"in t}function P1(t){return!!t&&"nullValue"in t}function A1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jf(t){return!!t&&"mapValue"in t}function P3(t){var n,i;return((i=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[XR])==null?void 0:i.stringValue)===eb}function Vc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return co(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=Vc(i)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vc(t.arrayValue.values[n]);return e}return{...t}}function A3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===JR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.value=e}static empty(){return new Ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!jf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vc(n)}setAll(e){let n=tn.emptyPath(),i={},r=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,i,r),i={},r=[],n=u.popLast()}a?i[u.lastSegment()]=Vc(a):r.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(e){const n=this.field(e.popLast());jf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return dr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=n.mapValue.fields[e.get(i)];jf(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,i){co(n,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Ln(Vc(this.value))}}function tb(t){const e=[];return co(t.fields,(n,i)=>{const r=new tn([n]);if(jf(i)){const s=tb(i.mapValue).fields;if(s.length===0)e.push(r);else for(const a of s)e.push(r.child(a))}else e.push(r)}),new qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,n,i,r,s,a,u){this.key=e,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new pn(e,0,ve.min(),ve.min(),ve.min(),Ln.empty(),0)}static newFoundDocument(e,n,i,r){return new pn(e,1,n,ve.min(),i,r,0)}static newNoDocument(e,n){return new pn(e,2,n,ve.min(),ve.min(),Ln.empty(),0)}static newUnknownDocument(e,n){return new pn(e,3,n,ve.min(),ve.min(),Ln.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,n){this.position=e,this.inclusive=n}}function R1(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],a=t.position[r];if(s.field.isKeyField()?i=ce.comparator(ce.fromName(a.referenceValue),n.key):i=Wl(a,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function b1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!dr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,n="asc"){this.field=e,this.dir=n}}function R3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{}class Vt extends nb{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new k3(e,n,i):n==="array-contains"?new D3(e,i):n==="in"?new M3(e,i):n==="not-in"?new O3(e,i):n==="array-contains-any"?new V3(e,i):new Vt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new N3(e,i):new L3(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wl(n,this.value)):n!==null&&Zs(this.value)===Zs(n)&&this.matchesComparison(Wl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fr extends nb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new fr(e,n)}matches(e){return ib(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ib(t){return t.op==="and"}function rb(t){return b3(t)&&ib(t)}function b3(t){for(const e of t.filters)if(e instanceof fr)return!1;return!0}function $y(t){if(t instanceof Vt)return t.field.canonicalString()+t.op.toString()+Hl(t.value);if(rb(t))return t.filters.map(e=>$y(e)).join(",");{const e=t.filters.map(n=>$y(n)).join(",");return`${t.op}(${e})`}}function sb(t,e){return t instanceof Vt?function(i,r){return r instanceof Vt&&i.op===r.op&&i.field.isEqual(r.field)&&dr(i.value,r.value)}(t,e):t instanceof fr?function(i,r){return r instanceof fr&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,a,u)=>s&&sb(a,r.filters[u]),!0):!1}(t,e):void pe(19439)}function ob(t){return t instanceof Vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Hl(n.value)}`}(t):t instanceof fr?function(n){return n.op.toString()+" {"+n.getFilters().map(ob).join(" ,")+"}"}(t):"Filter"}class k3 extends Vt{constructor(e,n,i){super(e,n,i),this.key=ce.fromName(i.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class N3 extends Vt{constructor(e,n){super(e,"in",n),this.keys=ab("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class L3 extends Vt{constructor(e,n){super(e,"not-in",n),this.keys=ab("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function ab(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(i=>ce.fromName(i.referenceValue))}class D3 extends Vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rw(n)&&xh(n.arrayValue,this.value)}}class M3 extends Vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&xh(this.value.arrayValue,n)}}class O3 extends Vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(xh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!xh(this.value.arrayValue,n)}}class V3 extends Vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rw(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>xh(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e,n=null,i=[],r=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=u,this.Te=null}}function k1(t,e=null,n=[],i=[],r=null,s=null,a=null){return new F3(t,e,n,i,r,s,a)}function sw(t){const e=Te(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(i=>$y(i)).join(","),n+="|ob:",n+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Dm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>Hl(i)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>Hl(i)).join(",")),e.Te=n}return e.Te}function ow(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!R3(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!sb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!b1(t.startAt,e.startAt)&&b1(t.endAt,e.endAt)}function qy(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n=null,i=[],r=[],s=null,a="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function j3(t,e,n,i,r,s,a,u){return new Om(t,e,n,i,r,s,a,u)}function aw(t){return new Om(t)}function N1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function U3(t){return t.collectionGroup!==null}function Fc(t){const e=Te(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new jt(tn.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(u=u.add(h.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Lp(s,i))}),n.has(tn.keyField().canonicalString())||e.Ie.push(new Lp(tn.keyField(),i))}return e.Ie}function sr(t){const e=Te(t);return e.Ee||(e.Ee=B3(e,Fc(t))),e.Ee}function B3(t,e){if(t.limitType==="F")return k1(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Lp(r.field,s)});const n=t.endAt?new Np(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Np(t.startAt.position,t.startAt.inclusive):null;return k1(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function Gy(t,e,n){return new Om(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Vm(t,e){return ow(sr(t),sr(e))&&t.limitType===e.limitType}function lb(t){return`${sw(sr(t))}|lt:${t.limitType}`}function Ka(t){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>ob(r)).join(", ")}]`),Dm(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>Hl(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>Hl(r)).join(",")),`Target(${i})`}(sr(t))}; limitType=${t.limitType})`}function Fm(t,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ce.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(t,e)&&function(i,r){for(const s of Fc(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(i,r){return!(i.startAt&&!function(a,u,c){const h=R1(a,u,c);return a.inclusive?h<=0:h<0}(i.startAt,Fc(i),r)||i.endAt&&!function(a,u,c){const h=R1(a,u,c);return a.inclusive?h>=0:h>0}(i.endAt,Fc(i),r))}(t,e)}function z3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ub(t){return(e,n)=>{let i=!1;for(const r of Fc(t)){const s=W3(r,e,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function W3(t,e,n){const i=t.field.isKeyField()?ce.comparator(e.key,n.key):function(s,a,u){const c=a.data.field(s),h=u.data.field(s);return c!==null&&h!==null?Wl(c,h):pe(42886)}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return pe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){co(this.inner,(n,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return qR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3=new kt(ce.comparator);function Zr(){return H3}const cb=new kt(ce.comparator);function wc(...t){let e=cb;for(const n of t)e=e.insert(n.key,n);return e}function hb(t){let e=cb;return t.forEach((n,i)=>e=e.insert(n,i.overlayedDocument)),e}function Fo(){return jc()}function db(){return jc()}function jc(){return new pa(t=>t.toString(),(t,e)=>t.isEqual(e))}const $3=new kt(ce.comparator),q3=new jt(ce.comparator);function De(...t){let e=q3;for(const n of t)e=e.add(n);return e}const G3=new jt(Le);function K3(){return G3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rp(e)?"-0":e}}function fb(t){return{integerValue:""+t}}function Z3(t,e){return T3(e)?fb(e):lw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this._=void 0}}function Q3(t,e,n){return t instanceof Dp?function(r,s){const a={fields:{[ZR]:{stringValue:KR},[YR]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&iw(s)&&(s=Mm(s)),s&&(a.fields[QR]=s),{mapValue:a}}(n,e):t instanceof Sh?mb(t,e):t instanceof Ch?gb(t,e):function(r,s){const a=pb(r,s),u=L1(a)+L1(r.Ae);return Hy(a)&&Hy(r.Ae)?fb(u):lw(r.serializer,u)}(t,e)}function Y3(t,e,n){return t instanceof Sh?mb(t,e):t instanceof Ch?gb(t,e):n}function pb(t,e){return t instanceof Mp?function(i){return Hy(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}class Dp extends jm{}class Sh extends jm{constructor(e){super(),this.elements=e}}function mb(t,e){const n=_b(e);for(const i of t.elements)n.some(r=>dr(r,i))||n.push(i);return{arrayValue:{values:n}}}class Ch extends jm{constructor(e){super(),this.elements=e}}function gb(t,e){let n=_b(e);for(const i of t.elements)n=n.filter(r=>!dr(r,i));return{arrayValue:{values:n}}}class Mp extends jm{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function L1(t){return wt(t.integerValue||t.doubleValue)}function _b(t){return rw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function X3(t,e){return t.field.isEqual(e.field)&&function(i,r){return i instanceof Sh&&r instanceof Sh||i instanceof Ch&&r instanceof Ch?zl(i.elements,r.elements,dr):i instanceof Mp&&r instanceof Mp?dr(i.Ae,r.Ae):i instanceof Dp&&r instanceof Dp}(t.transform,e.transform)}class J3{constructor(e,n){this.version=e,this.transformResults=n}}class hi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new hi}static exists(e){return new hi(void 0,e)}static updateTime(e){return new hi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Um{}function yb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new uw(t.key,hi.none()):new td(t.key,t.data,hi.none());{const n=t.data,i=Ln.empty();let r=new jt(tn.comparator);for(let s of e.fields)if(!r.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?i.delete(s):i.set(s,a),r=r.add(s)}return new ho(t.key,i,new qn(r.toArray()),hi.none())}}function eU(t,e,n){t instanceof td?function(r,s,a){const u=r.value.clone(),c=M1(r.fieldTransforms,s,a.transformResults);u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof ho?function(r,s,a){if(!Uf(r.precondition,s))return void s.convertToUnknownDocument(a.version);const u=M1(r.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(vb(r)),c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Uc(t,e,n,i){return t instanceof td?function(s,a,u,c){if(!Uf(s.precondition,a))return u;const h=s.value.clone(),p=O1(s.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,i):t instanceof ho?function(s,a,u,c){if(!Uf(s.precondition,a))return u;const h=O1(s.fieldTransforms,c,a),p=a.data;return p.setAll(vb(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,i):function(s,a,u){return Uf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function tU(t,e){let n=null;for(const i of t.fieldTransforms){const r=e.data.field(i.field),s=pb(i.transform,r||null);s!=null&&(n===null&&(n=Ln.empty()),n.set(i.field,s))}return n||null}function D1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&zl(i,r,(s,a)=>X3(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class td extends Um{constructor(e,n,i,r=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ho extends Um{constructor(e,n,i,r,s=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function vb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function M1(t,e,n){const i=new Map;We(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const s=t[r],a=s.transform,u=e.data.field(s.field);i.set(s.field,Y3(a,u,n[r]))}return i}function O1(t,e,n){const i=new Map;for(const r of t){const s=r.transform,a=n.data.field(r.field);i.set(r.field,Q3(s,a,e))}return i}class uw extends Um{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nU extends Um{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e,n,i,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&eU(s,e,i[r])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Uc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Uc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=db();return this.mutations.forEach(r=>{const s=e.get(r.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=n.has(r.key)?null:u;const c=yb(a,u);c!==null&&i.set(r.key,c),a.isValidDocument()||a.convertToNoDocument(ve.min())}),i}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),De())}isEqual(e){return this.batchId===e.batchId&&zl(this.mutations,e.mutations,(n,i)=>D1(n,i))&&zl(this.baseMutations,e.baseMutations,(n,i)=>D1(n,i))}}class cw{constructor(e,n,i,r){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(e,n,i){We(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=function(){return $3}();const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new cw(e,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Oe;function oU(t){switch(t){case Q.OK:return pe(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return pe(15467,{code:t})}}function wb(t){if(t===void 0)return Kr("GRPC error has no .code"),Q.UNKNOWN;switch(t){case Ct.OK:return Q.OK;case Ct.CANCELLED:return Q.CANCELLED;case Ct.UNKNOWN:return Q.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return Q.INTERNAL;case Ct.UNAVAILABLE:return Q.UNAVAILABLE;case Ct.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case Ct.NOT_FOUND:return Q.NOT_FOUND;case Ct.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case Ct.ABORTED:return Q.ABORTED;case Ct.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case Ct.DATA_LOSS:return Q.DATA_LOSS;default:return pe(39323,{code:t})}}(Oe=Ct||(Ct={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU=new Fs([4294967295,4294967295],0);function V1(t){const e=aU().encode(t),n=new MR;return n.update(e),new Uint8Array(n.digest())}function F1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fs([n,i],0),new Fs([r,s],0)]}class hw{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Ec(`Invalid padding: ${n}`);if(i<0)throw new Ec(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ec(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Ec(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Fs.fromNumber(this.ge)}ye(e,n,i){let r=e.add(n.multiply(Fs.fromNumber(i)));return r.compare(lU)===1&&(r=new Fs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=V1(e),[i,r]=F1(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(i,r,s);if(!this.we(a))return!1}return!0}static create(e,n,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new hw(s,r,n);return i.forEach(u=>a.insert(u)),a}insert(e){if(this.ge===0)return;const n=V1(e),[i,r]=F1(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(i,r,s);this.Se(a)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,n,i,r,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const r=new Map;return r.set(e,nd.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Bm(ve.min(),r,new kt(Le),Zr(),De())}}class nd{constructor(e,n,i,r,s){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new nd(i,n,De(),De(),De())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,n,i,r){this.be=e,this.removedTargetIds=n,this.key=i,this.De=r}}class Eb{constructor(e,n){this.targetId=e,this.Ce=n}}class Tb{constructor(e,n,i=sn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=r}}class j1{constructor(){this.ve=0,this.Fe=U1(),this.Me=sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=De(),n=De(),i=De();return this.Fe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:pe(38017,{changeType:s})}}),new nd(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=U1()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,We(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uU{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zr(),this.Je=pf(),this.He=pf(),this.Ye=new kt(Le)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:pe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((i,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,i=e.Ce.count,r=this.ot(n);if(r){const s=r.target;if(qy(s))if(i===0){const a=new ce(s.path);this.et(n,a,pn.newNoDocument(a,ve.min()))}else We(i===1,20013,{expectedCount:i});else{const a=this._t(n);if(a!==i){const u=this.ut(e),c=u?this.ct(u,e,a):1;if(c!==0){this.it(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,h)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let a,u;try{a=Ks(i).toUint8Array()}catch(c){if(c instanceof GR)return Bl("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new hw(a,r,s)}catch(c){return Bl(c instanceof Ec?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.ge===0?null:u}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let r=0;return i.forEach(s=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(n,s,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((s,a)=>{const u=this.ot(a);if(u){if(s.current&&qy(u.target)){const c=new ce(u.target.path);this.It(c).has(a)||this.Et(a,c)||this.et(a,c,pn.newNoDocument(c,e))}s.Be&&(n.set(a,s.ke()),s.qe())}});let i=De();this.He.forEach((s,a)=>{let u=!0;a.forEachWhile(c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(i=i.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const r=new Bm(e,n,this.Ye,this.je,i);return this.je=Zr(),this.Je=pf(),this.He=pf(),this.Ye=new kt(Le),r}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new j1,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new jt(Le),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new jt(Le),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ie("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new j1),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function pf(){return new kt(ce.comparator)}function U1(){return new kt(ce.comparator)}const cU=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),hU=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),dU=(()=>({and:"AND",or:"OR"}))();class fU{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ky(t,e){return t.useProto3Json||Dm(e)?e:{value:e}}function Op(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pU(t,e){return Op(t,e.toTimestamp())}function or(t){return We(!!t,49232),ve.fromTimestamp(function(n){const i=Gs(n);return new et(i.seconds,i.nanos)}(t))}function dw(t,e){return Zy(t,e).canonicalString()}function Zy(t,e){const n=function(r){return new Je(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Sb(t){const e=Je.fromString(t);return We(Rb(e),10190,{key:e.toString()}),e}function Qy(t,e){return dw(t.databaseId,e.path)}function u_(t,e){const n=Sb(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(Ib(n))}function Cb(t,e){return dw(t.databaseId,e)}function mU(t){const e=Sb(t);return e.length===4?Je.emptyPath():Ib(e)}function Yy(t){return new Je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ib(t){return We(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function B1(t,e,n){return{name:Qy(t,e),fields:n.value.mapValue.fields}}function gU(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:pe(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(We(p===void 0||typeof p=="string",58123),sn.fromBase64String(p||"")):(We(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),sn.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(h){const p=h.code===void 0?Q.UNKNOWN:wb(h.code);return new oe(p,h.message||"")}(a);n=new Tb(i,r,s,u||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=u_(t,i.document.name),s=or(i.document.updateTime),a=i.document.createTime?or(i.document.createTime):ve.min(),u=new Ln({mapValue:{fields:i.document.fields}}),c=pn.newFoundDocument(r,s,a,u),h=i.targetIds||[],p=i.removedTargetIds||[];n=new Bf(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=u_(t,i.document),s=i.readTime?or(i.readTime):ve.min(),a=pn.newNoDocument(r,s),u=i.removedTargetIds||[];n=new Bf([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=u_(t,i.document),s=i.removedTargetIds||[];n=new Bf([],s,r,null)}else{if(!("filter"in e))return pe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,a=new sU(r,s),u=i.targetId;n=new Eb(u,a)}}return n}function _U(t,e){let n;if(e instanceof td)n={update:B1(t,e.key,e.value)};else if(e instanceof uw)n={delete:Qy(t,e.key)};else if(e instanceof ho)n={update:B1(t,e.key,e.data),updateMask:IU(e.fieldMask)};else{if(!(e instanceof nU))return pe(16599,{Vt:e.type});n={verify:Qy(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(i=>function(s,a){const u=a.transform;if(u instanceof Dp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Sh)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ch)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Mp)return{fieldPath:a.field.canonicalString(),increment:u.Ae};throw pe(20930,{transform:a.transform})}(0,i))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:pU(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:pe(27497)}(t,e.precondition)),n}function yU(t,e){return t&&t.length>0?(We(e!==void 0,14353),t.map(n=>function(r,s){let a=r.updateTime?or(r.updateTime):or(s);return a.isEqual(ve.min())&&(a=or(s)),new J3(a,r.transformResults||[])}(n,e))):[]}function vU(t,e){return{documents:[Cb(t,e.path)]}}function wU(t,e){const n={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Cb(t,r);const s=function(h){if(h.length!==0)return Ab(fr.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:Za(_.field),direction:xU(_.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=Ky(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:n,parent:r}}function EU(t){let e=mU(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){We(i===1,65062);const p=n.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(m){const _=Pb(m);return _ instanceof fr&&rb(_)?_.getFilters():[_]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(_=>function(A){return new Lp(Qa(A.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(_))}(n.orderBy));let u=null;n.limit&&(u=function(m){let _;return _=typeof m=="object"?m.value:m,Dm(_)?null:_}(n.limit));let c=null;n.startAt&&(c=function(m){const _=!!m.before,T=m.values||[];return new Np(T,_)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const _=!m.before,T=m.values||[];return new Np(T,_)}(n.endAt)),j3(e,r,a,s,u,"F",c,h)}function TU(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Pb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Qa(n.unaryFilter.field);return Vt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Qa(n.unaryFilter.field);return Vt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Qa(n.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Qa(n.unaryFilter.field);return Vt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pe(61313);default:return pe(60726)}}(t):t.fieldFilter!==void 0?function(n){return Vt.create(Qa(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pe(58110);default:return pe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return fr.create(n.compositeFilter.filters.map(i=>Pb(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return pe(1026)}}(n.compositeFilter.op))}(t):pe(30097,{filter:t})}function xU(t){return cU[t]}function SU(t){return hU[t]}function CU(t){return dU[t]}function Za(t){return{fieldPath:t.canonicalString()}}function Qa(t){return tn.fromServerFormat(t.fieldPath)}function Ab(t){return t instanceof Vt?function(n){if(n.op==="=="){if(A1(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NAN"}};if(P1(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(A1(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NOT_NAN"}};if(P1(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Za(n.field),op:SU(n.op),value:n.value}}}(t):t instanceof fr?function(n){const i=n.getFilters().map(r=>Ab(r));return i.length===1?i[0]:{compositeFilter:{op:CU(n.op),filters:i}}}(t):pe(54877,{filter:t})}function IU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Rb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n,i,r,s=ve.min(),a=ve.min(),u=sn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new Is(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e){this.yt=e}}function AU(t){const e=EU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gy(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(){this.Cn=new bU}addToCollectionParentIndex(e,n){return this.Cn.add(n),Z.resolve()}getCollectionParents(e,n){return Z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Z.resolve()}deleteFieldIndex(e,n){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,n){return Z.resolve()}getDocumentsMatchingTarget(e,n){return Z.resolve(null)}getIndexType(e,n){return Z.resolve(0)}getFieldIndexes(e,n){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,n){return Z.resolve(qs.min())}getMinOffsetFromCollectionGroup(e,n){return Z.resolve(qs.min())}updateCollectionGroup(e,n,i){return Z.resolve()}updateIndexEntries(e,n){return Z.resolve()}}class bU{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n]||new jt(Je.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(e){return(this.index[e]||new jt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bb=41943040;class bn{static withCacheSize(e){return new bn(e,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn.DEFAULT_COLLECTION_PERCENTILE=10,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bn.DEFAULT=new bn(bb,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bn.DISABLED=new bn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $l(0)}static cr(){return new $l(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="LruGarbageCollector",kU=1048576;function H1([t,e],[n,i]){const r=Le(t,n);return r===0?Le(e,i):r}class NU{constructor(e){this.Ir=e,this.buffer=new jt(H1),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();H1(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class LU{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ie(W1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){cu(n)?ie(W1,"Ignoring IndexedDB error during garbage collection: ",n):await uu(n)}await this.Vr(3e5)})}}class DU{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(i=>Math.floor(n/100*i))}nthSequenceNumber(e,n){if(n===0)return Z.resolve(Lm.ce);const i=new NU(n);return this.mr.forEachTarget(e,r=>i.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>i.Ar(r))).next(()=>i.maxValue)}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ie("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(z1)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),z1):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,r,s,a,u,c,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,a=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(i=m,u=Date.now(),this.removeTargets(e,i,n))).next(m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(m=>(h=Date.now(),Ga()<=be.DEBUG&&ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${r} in `+(u-a)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${m} documents in `+(h-c)+`ms
Total Duration: ${h-p}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m})))}}function MU(t,e){return new DU(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(){this.changes=new pa(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,pn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Z.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e,n,i,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(i!==null&&Uc(i.mutation,r,qn.empty(),et.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.getLocalViewOfDocuments(e,i,De()).next(()=>i))}getLocalViewOfDocuments(e,n,i=De()){const r=Fo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,i).next(s=>{let a=wc();return s.forEach((u,c)=>{a=a.insert(u,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const i=Fo();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,De()))}populateOverlays(e,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,i,r){let s=Zr();const a=jc(),u=function(){return jc()}();return n.forEach((c,h)=>{const p=i.get(h.key);r.has(h.key)&&(p===void 0||p.mutation instanceof ho)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),Uc(p.mutation,h,p.mutation.getFieldMask(),et.now())):a.set(h.key,qn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>u.set(h,new VU(p,a.get(h)??null))),u))}recalculateAndSaveOverlays(e,n){const i=jc();let r=new kt((a,u)=>a-u),s=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=i.get(c)||qn.empty();p=u.applyToLocalView(h,p),i.set(c,p);const m=(r.get(u.batchId)||De()).add(c);r=r.insert(u.batchId,m)})}).next(()=>{const a=[],u=r.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),h=c.key,p=c.value,m=db();p.forEach(_=>{if(!s.has(_)){const T=yb(n.get(_),i.get(_));T!==null&&m.set(_,T),s=s.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Z.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,n,i,r){return function(a){return ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):U3(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,r):this.getDocumentsMatchingCollectionQuery(e,n,i,r)}getNextDocuments(e,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,r-s.size):Z.resolve(Fo());let u=wh,c=s;return a.next(h=>Z.forEach(h,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?Z.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,De())).next(p=>({batchId:u,changes:hb(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(i=>{let r=wc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,i,r){const s=n.collectionGroup;let a=wc();return this.indexManager.getCollectionParents(e,s).next(u=>Z.forEach(u,c=>{const h=function(m,_){return new Om(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next(p=>{p.forEach((m,_)=>{a=a.insert(m,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,s,r))).next(a=>{s.forEach((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,pn.newInvalidDocument(p)))});let u=wc();return a.forEach((c,h)=>{const p=s.get(c);p!==void 0&&Uc(p.mutation,h,qn.empty(),et.now()),Fm(n,h)&&(u=u.insert(c,h))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return Z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:or(r.createTime)}}(n)),Z.resolve()}getNamedQuery(e,n){return Z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:AU(r.bundledQuery),readTime:or(r.readTime)}}(n)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(){this.overlays=new kt(ce.comparator),this.qr=new Map}getOverlay(e,n){return Z.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Fo();return Z.forEach(n,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,n,i){return i.forEach((r,s)=>{this.St(e,n,s)}),Z.resolve()}removeOverlaysForBatchId(e,n,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,n,i){const r=Fo(),s=n.length+1,a=new ce(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const c=u.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,n,i,r){let s=new kt((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>i){let p=s.get(h.largestBatchId);p===null&&(p=Fo(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const u=Fo(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>u.set(h,p)),!(u.size()>=r)););return Z.resolve(u)}St(e,n,i){const r=this.overlays.get(i.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new rU(n,i));let s=this.qr.get(n);s===void 0&&(s=De(),this.qr.set(n,s)),this.qr.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(){this.Qr=new jt(Ht.$r),this.Ur=new jt(Ht.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new Ht(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach(i=>this.addReference(i,n))}removeReference(e,n){this.Gr(new Ht(e,n))}zr(e,n){e.forEach(i=>this.removeReference(i,n))}jr(e){const n=new ce(new Je([])),i=new Ht(n,e),r=new Ht(n,e+1),s=[];return this.Ur.forEachInRange([i,r],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ce(new Je([])),i=new Ht(n,e),r=new Ht(n,e+1);let s=De();return this.Ur.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new Ht(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Ht{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ce.comparator(e.key,n.key)||Le(e.Yr,n.Yr)}static Kr(e,n){return Le(e.Yr,n.Yr)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new jt(Ht.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new iU(s,n,i,r);this.mutationQueue.push(a);for(const u of r)this.Zr=this.Zr.add(new Ht(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Z.resolve(a)}lookupMutationBatch(e,n){return Z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?nw:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Ht(n,0),r=new Ht(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],a=>{const u=this.Xr(a.Yr);s.push(u)}),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new jt(Le);return n.forEach(r=>{const s=new Ht(r,0),a=new Ht(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],u=>{i=i.add(u.Yr)})}),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,r=i.length+1;let s=i;ce.isDocumentKey(s)||(s=s.child(""));const a=new Ht(new ce(s),0);let u=new jt(Le);return this.Zr.forEachWhile(c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(u=u.add(c.Yr)),!0)},a),Z.resolve(this.ti(u))}ti(e){const n=[];return e.forEach(i=>{const r=this.Xr(i);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){We(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(n.mutations,r=>{const s=new Ht(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=i})}ir(e){}containsKey(e,n){const i=new Ht(n,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e){this.ri=e,this.docs=function(){return new kt(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,a=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return Z.resolve(i?i.document.mutableCopy():pn.newInvalidDocument(n))}getEntries(e,n){let i=Zr();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():pn.newInvalidDocument(r))}),Z.resolve(i)}getDocumentsMatchingQuery(e,n,i,r){let s=Zr();const a=n.path,u=new ce(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||y3(_3(p),i)<=0||(r.has(p.key)||Fm(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,n,i,r){pe(9500)}ii(e,n){return Z.forEach(this.docs,i=>n(i))}newChangeBuffer(e){return new HU(this)}getSize(e){return Z.resolve(this.size)}}class HU extends OU{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)}),Z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e){this.persistence=e,this.si=new pa(n=>sw(n),ow),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new fw,this.targetCount=0,this.ai=$l.ur()}forEachTarget(e,n){return this.si.forEach((i,r)=>n(r)),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),Z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new $l(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,Z.resolve()}updateTargetData(e,n){return this.Pr(n),Z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,n,i){let r=0;const s=[];return this.si.forEach((a,u)=>{u.sequenceNumber<=n&&i.get(u.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)}),Z.waitFor(s).next(()=>r)}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return Z.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),Z.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),Z.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),Z.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return Z.resolve(i)}containsKey(e,n){return Z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,n){this.ui={},this.overlays={},this.ci=new Lm(0),this.li=!1,this.li=!0,this.hi=new BU,this.referenceDelegate=e(this),this.Pi=new $U(this),this.indexManager=new RU,this.remoteDocumentCache=function(r){return new WU(r)}(i=>this.referenceDelegate.Ti(i)),this.serializer=new PU(n),this.Ii=new jU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new UU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new zU(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){ie("MemoryPersistence","Starting transaction:",e);const r=new qU(this.ci.next());return this.referenceDelegate.Ei(),i(r).next(s=>this.referenceDelegate.di(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ai(e,n){return Z.or(Object.values(this.ui).map(i=>()=>i.containsKey(e,n)))}}class qU extends w3{constructor(e){super(),this.currentSequenceNumber=e}}class pw{constructor(e){this.persistence=e,this.Ri=new fw,this.Vi=null}static mi(e){return new pw(e)}get fi(){if(this.Vi)return this.Vi;throw pe(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),Z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(s=>this.fi.add(s.toString()))}).next(()=>i.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,i=>{const r=ce.fromPath(i);return this.gi(e,r).next(s=>{s||n.removeEntry(r,ve.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return Z.or([()=>Z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Vp{constructor(e,n){this.persistence=e,this.pi=new pa(i=>x3(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=MU(this,n)}static mi(e,n){return new Vp(e,n)}Ei(){}di(e){return Z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>n.next(r=>i+r))}wr(e){let n=0;return this.pr(e,i=>{n++}).next(()=>n)}pr(e,n){return Z.forEach(this.pi,(i,r)=>this.br(e,i,r).next(s=>s?Z.resolve():n(r)))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,n).next(u=>{u||(i++,s.removeEntry(a,ve.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),Z.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),Z.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),Z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),Z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ff(e.data.value)),n}br(e,n,i){return Z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return Z.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n,i,r){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=r}static As(e,n){let i=De(),r=De();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new mw(e,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return xV()?8:E3(_n())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,r){const s={result:null};return this.ys(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,n,r,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new GU;return this.Ss(e,n,a).next(u=>{if(s.result=u,this.Vs)return this.bs(e,n,a,u.size)})}).next(()=>s.result)}bs(e,n,i,r){return i.documentReadCount<this.fs?(Ga()<=be.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Ka(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Ga()<=be.DEBUG&&ie("QueryEngine","Query:",Ka(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Ga()<=be.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Ka(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,sr(n))):Z.resolve())}ys(e,n){if(N1(n))return Z.resolve(null);let i=sr(n);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Gy(n,null,"F"),i=sr(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const a=De(...s);return this.ps.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,i).next(c=>{const h=this.Ds(n,u);return this.Cs(n,h,a,c.readTime)?this.ys(e,Gy(n,null,"F")):this.vs(e,h,n,c)}))})))}ws(e,n,i,r){return N1(n)||r.isEqual(ve.min())?Z.resolve(null):this.ps.getDocuments(e,i).next(s=>{const a=this.Ds(n,s);return this.Cs(n,a,i,r)?Z.resolve(null):(Ga()<=be.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ka(n)),this.vs(e,a,n,g3(r,wh)).next(u=>u))})}Ds(e,n){let i=new jt(ub(e));return n.forEach((r,s)=>{Fm(e,s)&&(i=i.add(s))}),i}Cs(e,n,i,r){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,n,i){return Ga()<=be.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Ka(n)),this.ps.getDocumentsMatchingQuery(e,n,qs.min(),i)}vs(e,n,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw="LocalStore",ZU=3e8;class QU{constructor(e,n,i,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new kt(Le),this.xs=new pa(s=>sw(s),ow),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FU(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function YU(t,e,n,i){return new QU(t,e,n,i)}async function Nb(t,e){const n=Te(t);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],u=[];let c=De();for(const h of r){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of s){u.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(i,c).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:u}))})})}function XU(t,e){const n=Te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(u,c,h,p){const m=h.batch,_=m.keys();let T=Z.resolve();return _.forEach(A=>{T=T.next(()=>p.getEntry(c,A)).next(b=>{const V=h.docVersions.get(A);We(V!==null,48541),b.version.compareTo(V)<0&&(m.applyToRemoteDocument(b,h),b.isValidDocument()&&(b.setReadTime(h.commitVersion),p.addEntry(b)))})}),T.next(()=>u.mutationQueue.removeMutationBatch(c,m))}(n,i,e,s).next(()=>s.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let c=De();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(c=c.add(u.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(i,r))})}function Lb(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function JU(t,e){const n=Te(t),i=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const u=[];e.targetChanges.forEach((p,m)=>{const _=r.get(m);if(!_)return;u.push(n.Pi.removeMatchingKeys(s,p.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,p.addedDocuments,m)));let T=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?T=T.withResumeToken(sn.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):p.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(p.resumeToken,i)),r=r.insert(m,T),function(b,V,C){return b.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=ZU?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(_,T,p)&&u.push(n.Pi.updateTargetData(s,T))});let c=Zr(),h=De();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(eB(s,a,e.documentUpdates).next(p=>{c=p.ks,h=p.qs})),!i.isEqual(ve.min())){const p=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i));u.push(p)}return Z.waitFor(u).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(n.Ms=r,s))}function eB(t,e,n){let i=De(),r=De();return n.forEach(s=>i=i.add(s)),e.getEntries(t,i).next(s=>{let a=Zr();return n.forEach((u,c)=>{const h=s.get(u);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(u)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(u,c.readTime),a=a.insert(u,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(u,c)):ie(gw,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",c.version)}),{ks:a,qs:r}})}function tB(t,e){const n=Te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=nw),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function nB(t,e){const n=Te(t);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Pi.getTargetData(i,e).next(s=>s?(r=s,Z.resolve(r)):n.Pi.allocateTargetId(i).next(a=>(r=new Is(e,a,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i})}async function Xy(t,e,n){const i=Te(t),r=i.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!cu(a))throw a;ie(gw,`Failed to update sequence numbers for target ${e}: ${a}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function $1(t,e,n){const i=Te(t);let r=ve.min(),s=De();return i.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,p){const m=Te(c),_=m.xs.get(p);return _!==void 0?Z.resolve(m.Ms.get(_)):m.Pi.getTargetData(h,p)}(i,a,sr(e)).next(u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(a,u.targetId).next(c=>{s=c})}).next(()=>i.Fs.getDocumentsMatchingQuery(a,e,n?r:ve.min(),n?s:De())).next(u=>(iB(i,z3(e),u),{documents:u,Qs:s})))}function iB(t,e,n){let i=t.Os.get(e)||ve.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),t.Os.set(e,i)}class q1{constructor(){this.activeTargetIds=K3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rB{constructor(){this.Mo=new q1,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new q1,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="ConnectivityMonitor";class K1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ie(G1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ie(G1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf=null;function Jy(){return mf===null?mf=function(){return 268435456+Math.round(2147483648*Math.random())}():mf++,"0x"+mf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="RestConnection",oB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aB{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===bp?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,n,i,r,s){const a=Jy(),u=this.zo(e,n.toUriEncodedString());ie(c_,`Sending RPC '${e}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(u),p=oo(h);return this.Jo(e,u,c,i,p).then(m=>(ie(c_,`Received RPC '${e}' ${a}: `,m),m),m=>{throw Bl(c_,`RPC '${e}' ${a} failed with error: `,m,"url: ",u,"request:",i),m})}Ho(e,n,i,r,s,a){return this.Go(e,n,i,r,s)}jo(e,n,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+lu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}zo(e,n){const i=oB[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lB{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class uB extends aB{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,r,s){const a=Jy();return new Promise((u,c)=>{const h=new OR;h.setWithCredentials(!0),h.listenOnce(VR.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Vf.NO_ERROR:const m=h.getResponseJson();ie(hn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),u(m);break;case Vf.TIMEOUT:ie(hn,`RPC '${e}' ${a} timed out`),c(new oe(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Vf.HTTP_ERROR:const _=h.getStatus();if(ie(hn,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const A=T==null?void 0:T.error;if(A&&A.status&&A.message){const b=function(C){const S=C.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(S)>=0?S:Q.UNKNOWN}(A.status);c(new oe(b,A.message))}else c(new oe(Q.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new oe(Q.UNAVAILABLE,"Connection failed."));break;default:pe(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ie(hn,`RPC '${e}' ${a} completed.`)}});const p=JSON.stringify(r);ie(hn,`RPC '${e}' ${a} sending request:`,r),h.send(n,"POST",p,i,15)})}T_(e,n,i){const r=Jy(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=UR(),u=jR(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,i),c.encodeInitMessageHeaders=!0;const p=s.join("");ie(hn,`Creating RPC '${e}' stream ${r}: ${p}`,c);const m=a.createWebChannel(p,c);this.I_(m);let _=!1,T=!1;const A=new lB({Yo:V=>{T?ie(hn,`Not sending because RPC '${e}' stream ${r} is closed:`,V):(_||(ie(hn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),_=!0),ie(hn,`RPC '${e}' stream ${r} sending:`,V),m.send(V))},Zo:()=>m.close()}),b=(V,C,S)=>{V.listen(C,R=>{try{S(R)}catch(U){setTimeout(()=>{throw U},0)}})};return b(m,vc.EventType.OPEN,()=>{T||(ie(hn,`RPC '${e}' stream ${r} transport opened.`),A.o_())}),b(m,vc.EventType.CLOSE,()=>{T||(T=!0,ie(hn,`RPC '${e}' stream ${r} transport closed`),A.a_(),this.E_(m))}),b(m,vc.EventType.ERROR,V=>{T||(T=!0,Bl(hn,`RPC '${e}' stream ${r} transport errored. Name:`,V.name,"Message:",V.message),A.a_(new oe(Q.UNAVAILABLE,"The operation could not be completed")))}),b(m,vc.EventType.MESSAGE,V=>{var C;if(!T){const S=V.data[0];We(!!S,16349);const R=S,U=(R==null?void 0:R.error)||((C=R[0])==null?void 0:C.error);if(U){ie(hn,`RPC '${e}' stream ${r} received error:`,U);const W=U.status;let K=function(N){const O=Ct[N];if(O!==void 0)return wb(O)}(W),k=U.message;K===void 0&&(K=Q.INTERNAL,k="Unknown error status: "+W+" with message "+U.message),T=!0,A.a_(new oe(K,k)),m.close()}else ie(hn,`RPC '${e}' stream ${r} received:`,S),A.u_(S)}}),b(u,FR.STAT_EVENT,V=>{V.stat===Uy.PROXY?ie(hn,`RPC '${e}' stream ${r} detected buffering proxy`):V.stat===Uy.NOPROXY&&ie(hn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function h_(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zm(t){return new fU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,n,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-i);r>0&&ie("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="PersistentStream";class Mb{constructor(e,n,i,r,s,a,u,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Db(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(Kr(n.toString()),Kr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===n&&this.G_(i,r)},i=>{e(()=>{const r=new oe(Q.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{i(()=>this.listener.Xo())}),this.stream.t_(()=>{i(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ie(Z1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ie(Z1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cB extends Mb{constructor(e,n,i,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,a),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=gU(this.serializer,e),i=function(s){if(!("targetChange"in s))return ve.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ve.min():a.readTime?or(a.readTime):ve.min()}(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=Yy(this.serializer),n.addTarget=function(s,a){let u;const c=a.target;if(u=qy(c)?{documents:vU(s,c)}:{query:wU(s,c).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=xb(s,a.resumeToken);const h=Ky(s,a.expectedCount);h!==null&&(u.expectedCount=h)}else if(a.snapshotVersion.compareTo(ve.min())>0){u.readTime=Op(s,a.snapshotVersion.toTimestamp());const h=Ky(s,a.expectedCount);h!==null&&(u.expectedCount=h)}return u}(this.serializer,e);const i=TU(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=Yy(this.serializer),n.removeTarget=e,this.q_(n)}}class hB extends Mb{constructor(e,n,i,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return We(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,We(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){We(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=yU(e.writeResults,e.commitTime),i=or(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=Yy(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(i=>_U(this.serializer,i))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dB{}class fB extends dB{constructor(e,n,i,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new oe(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,Zy(n,i),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new oe(Q.UNKNOWN,s.toString())})}Ho(e,n,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Ho(e,Zy(n,i),r,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new oe(Q.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class pB{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kr(n),this.aa=!1):ie("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="RemoteStore";class mB{constructor(e,n,i,r,s){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{i.enqueueAndForget(async()=>{ma(this)&&(ie(sa,"Restarting streams for network reachability change."),await async function(c){const h=Te(c);h.Ea.add(4),await id(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Wm(h)}(this))})}),this.Ra=new pB(i,r)}}async function Wm(t){if(ma(t))for(const e of t.da)await e(!0)}async function id(t){for(const e of t.da)await e(!1)}function Ob(t,e){const n=Te(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ww(n)?vw(n):hu(n).O_()&&yw(n,e))}function _w(t,e){const n=Te(t),i=hu(n);n.Ia.delete(e),i.O_()&&Vb(n,e),n.Ia.size===0&&(i.O_()?i.L_():ma(n)&&n.Ra.set("Unknown"))}function yw(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hu(t).Y_(e)}function Vb(t,e){t.Va.Ue(e),hu(t).Z_(e)}function vw(t){t.Va=new uU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),hu(t).start(),t.Ra.ua()}function ww(t){return ma(t)&&!hu(t).x_()&&t.Ia.size>0}function ma(t){return Te(t).Ea.size===0}function Fb(t){t.Va=void 0}async function gB(t){t.Ra.set("Online")}async function _B(t){t.Ia.forEach((e,n)=>{yw(t,e)})}async function yB(t,e){Fb(t),ww(t)?(t.Ra.ha(e),vw(t)):t.Ra.set("Unknown")}async function vB(t,e,n){if(t.Ra.set("Online"),e instanceof Tb&&e.state===2&&e.cause)try{await async function(r,s){const a=s.cause;for(const u of s.targetIds)r.Ia.has(u)&&(await r.remoteSyncer.rejectListen(u,a),r.Ia.delete(u),r.Va.removeTarget(u))}(t,e)}catch(i){ie(sa,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Fp(t,i)}else if(e instanceof Bf?t.Va.Ze(e):e instanceof Eb?t.Va.st(e):t.Va.tt(e),!n.isEqual(ve.min()))try{const i=await Lb(t.localStore);n.compareTo(i)>=0&&await function(s,a){const u=s.Va.Tt(a);return u.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.Ia.get(h);p&&s.Ia.set(h,p.withResumeToken(c.resumeToken,a))}}),u.targetMismatches.forEach((c,h)=>{const p=s.Ia.get(c);if(!p)return;s.Ia.set(c,p.withResumeToken(sn.EMPTY_BYTE_STRING,p.snapshotVersion)),Vb(s,c);const m=new Is(p.target,c,h,p.sequenceNumber);yw(s,m)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(i){ie(sa,"Failed to raise snapshot:",i),await Fp(t,i)}}async function Fp(t,e,n){if(!cu(e))throw e;t.Ea.add(1),await id(t),t.Ra.set("Offline"),n||(n=()=>Lb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ie(sa,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Wm(t)})}function jb(t,e){return e().catch(n=>Fp(t,n,e))}async function Hm(t){const e=Te(t),n=Qs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:nw;for(;wB(e);)try{const r=await tB(e.localStore,i);if(r===null){e.Ta.length===0&&n.L_();break}i=r.batchId,EB(e,r)}catch(r){await Fp(e,r)}Ub(e)&&Bb(e)}function wB(t){return ma(t)&&t.Ta.length<10}function EB(t,e){t.Ta.push(e);const n=Qs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Ub(t){return ma(t)&&!Qs(t).x_()&&t.Ta.length>0}function Bb(t){Qs(t).start()}async function TB(t){Qs(t).ra()}async function xB(t){const e=Qs(t);for(const n of t.Ta)e.ea(n.mutations)}async function SB(t,e,n){const i=t.Ta.shift(),r=cw.from(i,e,n);await jb(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Hm(t)}async function CB(t,e){e&&Qs(t).X_&&await async function(i,r){if(function(a){return oU(a)&&a!==Q.ABORTED}(r.code)){const s=i.Ta.shift();Qs(i).B_(),await jb(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Hm(i)}}(t,e),Ub(t)&&Bb(t)}async function Q1(t,e){const n=Te(t);n.asyncQueue.verifyOperationInProgress(),ie(sa,"RemoteStore received new credentials");const i=ma(n);n.Ea.add(3),await id(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Wm(n)}async function IB(t,e){const n=Te(t);e?(n.Ea.delete(2),await Wm(n)):e||(n.Ea.add(2),await id(n),n.Ra.set("Unknown"))}function hu(t){return t.ma||(t.ma=function(n,i,r){const s=Te(n);return s.sa(),new cB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{Xo:gB.bind(null,t),t_:_B.bind(null,t),r_:yB.bind(null,t),H_:vB.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),ww(t)?vw(t):t.Ra.set("Unknown")):(await t.ma.stop(),Fb(t))})),t.ma}function Qs(t){return t.fa||(t.fa=function(n,i,r){const s=Te(n);return s.sa(),new hB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:TB.bind(null,t),r_:CB.bind(null,t),ta:xB.bind(null,t),na:SB.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Hm(t)):(await t.fa.stop(),t.Ta.length>0&&(ie(sa,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,n,i,r,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Ur,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,r,s){const a=Date.now()+i,u=new Ew(e,n,a,r,s);return u.start(i),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tw(t,e){if(Kr("AsyncQueue",`${e}: ${t}`),cu(t))return new oe(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{static emptySet(e){return new Cl(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||ce.comparator(n.key,i.key):(n,i)=>ce.comparator(n.key,i.key),this.keyedMap=wc(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,i)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Cl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Cl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(){this.ga=new kt(ce.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):pe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,i)=>{e.push(i)}),e}}class ql{constructor(e,n,i,r,s,a,u,c,h){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,i,r,s){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new ql(e,n,Cl.emptySet(n),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PB{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class AB{constructor(){this.queries=X1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const r=Te(n),s=r.queries;r.queries=X1(),s.forEach((a,u)=>{for(const c of u.Sa)c.onError(i)})})(this,new oe(Q.ABORTED,"Firestore shutting down"))}}function X1(){return new pa(t=>lb(t),Vm)}async function zb(t,e){const n=Te(t);let i=3;const r=e.query;let s=n.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new PB,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await n.onListen(r,!0);break;case 1:s.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const u=Tw(a,`Initialization of query '${Ka(e.query)}' failed`);return void e.onError(u)}n.queries.set(r,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&xw(n)}async function Wb(t,e){const n=Te(t),i=e.query;let r=3;const s=n.queries.get(i);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function RB(t,e){const n=Te(t);let i=!1;for(const r of e){const s=r.query,a=n.queries.get(s);if(a){for(const u of a.Sa)u.Fa(r)&&(i=!0);a.wa=r}}i&&xw(n)}function bB(t,e,n){const i=Te(t),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(n);i.queries.delete(e)}function xw(t){t.Ca.forEach(e=>{e.next()})}var ev,J1;(J1=ev||(ev={})).Ma="default",J1.Cache="cache";class Hb{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new ql(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ql.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ev.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e){this.key=e}}class qb{constructor(e){this.key=e}}class kB{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=De(),this.mutatedKeys=De(),this.eu=ub(e),this.tu=new Cl(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Y1,r=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,a=r,u=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((p,m)=>{const _=r.get(p),T=Fm(this.query,m)?m:null,A=!!_&&this.mutatedKeys.has(_.key),b=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let V=!1;_&&T?_.data.isEqual(T.data)?A!==b&&(i.track({type:3,doc:T}),V=!0):this.su(_,T)||(i.track({type:2,doc:T}),V=!0,(c&&this.eu(T,c)>0||h&&this.eu(T,h)<0)&&(u=!0)):!_&&T?(i.track({type:0,doc:T}),V=!0):_&&!T&&(i.track({type:1,doc:_}),V=!0,(c||h)&&(u=!0)),V&&(T?(a=a.add(T),s=b?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),i.track({type:1,doc:p})}return{tu:a,iu:i,Cs:u,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((p,m)=>function(T,A){const b=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe(20277,{Rt:V})}};return b(T)-b(A)}(p.type,m.type)||this.eu(p.doc,m.doc)),this.ou(i),r=r??!1;const u=n&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,h=c!==this.Za;return this.Za=c,a.length!==0||h?{snapshot:new ql(this.query,e.tu,s,a,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Y1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=De(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))});const n=[];return e.forEach(i=>{this.Xa.has(i)||n.push(new qb(i))}),this.Xa.forEach(i=>{e.has(i)||n.push(new $b(i))}),n}cu(e){this.Ya=e.Qs,this.Xa=De();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ql.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Sw="SyncEngine";class NB{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class LB{constructor(e){this.key=e,this.hu=!1}}class DB{constructor(e,n,i,r,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new pa(u=>lb(u),Vm),this.Iu=new Map,this.Eu=new Set,this.du=new kt(ce.comparator),this.Au=new Map,this.Ru=new fw,this.Vu={},this.mu=new Map,this.fu=$l.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function MB(t,e,n=!0){const i=Xb(t);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await Gb(i,e,n,!0),r}async function OB(t,e){const n=Xb(t);await Gb(n,e,!0,!1)}async function Gb(t,e,n,i){const r=await nB(t.localStore,sr(e)),s=r.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let u;return i&&(u=await VB(t,e,s,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&Ob(t.remoteStore,r),u}async function VB(t,e,n,i,r){t.pu=(m,_,T)=>async function(b,V,C,S){let R=V.view.ru(C);R.Cs&&(R=await $1(b.localStore,V.query,!1).then(({documents:k})=>V.view.ru(k,R)));const U=S&&S.targetChanges.get(V.targetId),W=S&&S.targetMismatches.get(V.targetId)!=null,K=V.view.applyChanges(R,b.isPrimaryClient,U,W);return tS(b,V.targetId,K.au),K.snapshot}(t,m,_,T);const s=await $1(t.localStore,e,!0),a=new kB(e,s.Qs),u=a.ru(s.documents),c=nd.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",r),h=a.applyChanges(u,t.isPrimaryClient,c);tS(t,n,h.au);const p=new NB(e,n,a);return t.Tu.set(e,p),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),h.snapshot}async function FB(t,e,n){const i=Te(t),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter(a=>!Vm(a,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Xy(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&_w(i.remoteStore,r.targetId),tv(i,r.targetId)}).catch(uu)):(tv(i,r.targetId),await Xy(i.localStore,r.targetId,!0))}async function jB(t,e){const n=Te(t),i=n.Tu.get(e),r=n.Iu.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),_w(n.remoteStore,i.targetId))}async function UB(t,e,n){const i=GB(t);try{const r=await function(a,u){const c=Te(a),h=et.now(),p=u.reduce((T,A)=>T.add(A.key),De());let m,_;return c.persistence.runTransaction("Locally write mutations","readwrite",T=>{let A=Zr(),b=De();return c.Ns.getEntries(T,p).next(V=>{A=V,A.forEach((C,S)=>{S.isValidDocument()||(b=b.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(T,A)).next(V=>{m=V;const C=[];for(const S of u){const R=tU(S,m.get(S.key).overlayedDocument);R!=null&&C.push(new ho(S.key,R,tb(R.value.mapValue),hi.exists(!0)))}return c.mutationQueue.addMutationBatch(T,h,C,u)}).next(V=>{_=V;const C=V.applyToLocalDocumentSet(m,b);return c.documentOverlayCache.saveOverlays(T,V.batchId,C)})}).then(()=>({batchId:_.batchId,changes:hb(m)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(a,u,c){let h=a.Vu[a.currentUser.toKey()];h||(h=new kt(Le)),h=h.insert(u,c),a.Vu[a.currentUser.toKey()]=h}(i,r.batchId,n),await rd(i,r.changes),await Hm(i.remoteStore)}catch(r){const s=Tw(r,"Failed to persist write");n.reject(s)}}async function Kb(t,e){const n=Te(t);try{const i=await JU(n.localStore,e);e.targetChanges.forEach((r,s)=>{const a=n.Au.get(s);a&&(We(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?We(a.hu,14607):r.removedDocuments.size>0&&(We(a.hu,42227),a.hu=!1))}),await rd(n,i,e)}catch(i){await uu(i)}}function eS(t,e,n){const i=Te(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.Tu.forEach((s,a)=>{const u=a.view.va(e);u.snapshot&&r.push(u.snapshot)}),function(a,u){const c=Te(a);c.onlineState=u;let h=!1;c.queries.forEach((p,m)=>{for(const _ of m.Sa)_.va(u)&&(h=!0)}),h&&xw(c)}(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function BB(t,e,n){const i=Te(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Au.get(e),s=r&&r.key;if(s){let a=new kt(ce.comparator);a=a.insert(s,pn.newNoDocument(s,ve.min()));const u=De().add(s),c=new Bm(ve.min(),new Map,new kt(Le),a,u);await Kb(i,c),i.du=i.du.remove(s),i.Au.delete(e),Cw(i)}else await Xy(i.localStore,e,!1).then(()=>tv(i,e,n)).catch(uu)}async function zB(t,e){const n=Te(t),i=e.batch.batchId;try{const r=await XU(n.localStore,e);Qb(n,i,null),Zb(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await rd(n,r)}catch(r){await uu(r)}}async function WB(t,e,n){const i=Te(t);try{const r=await function(a,u){const c=Te(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,u).next(m=>(We(m!==null,37113),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(i.localStore,e);Qb(i,e,n),Zb(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await rd(i,r)}catch(r){await uu(r)}}function Zb(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Qb(t,e,n){const i=Te(t);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(n?s.reject(n):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function tv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(i=>{t.Ru.containsKey(i)||Yb(t,i)})}function Yb(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(_w(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Cw(t))}function tS(t,e,n){for(const i of n)i instanceof $b?(t.Ru.addReference(i.key,e),HB(t,i)):i instanceof qb?(ie(Sw,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Yb(t,i.key)):pe(19791,{wu:i})}function HB(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(ie(Sw,"New document in limbo: "+n),t.Eu.add(i),Cw(t))}function Cw(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ce(Je.fromString(e)),i=t.fu.next();t.Au.set(i,new LB(n)),t.du=t.du.insert(n,i),Ob(t.remoteStore,new Is(sr(aw(n.path)),i,"TargetPurposeLimboResolution",Lm.ce))}}async function rd(t,e,n){const i=Te(t),r=[],s=[],a=[];i.Tu.isEmpty()||(i.Tu.forEach((u,c)=>{a.push(i.pu(c,e,n).then(h=>{var p;if((h||n)&&i.isPrimaryClient){const m=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:p.current;i.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){r.push(h);const m=mw.As(c.targetId,h);s.push(m)}}))}),await Promise.all(a),i.Pu.H_(r),await async function(c,h){const p=Te(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Z.forEach(h,_=>Z.forEach(_.Es,T=>p.persistence.referenceDelegate.addReference(m,_.targetId,T)).next(()=>Z.forEach(_.ds,T=>p.persistence.referenceDelegate.removeReference(m,_.targetId,T)))))}catch(m){if(!cu(m))throw m;ie(gw,"Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const T=p.Ms.get(_),A=T.snapshotVersion,b=T.withLastLimboFreeSnapshotVersion(A);p.Ms=p.Ms.insert(_,b)}}}(i.localStore,s))}async function $B(t,e){const n=Te(t);if(!n.currentUser.isEqual(e)){ie(Sw,"User change. New user:",e.toKey());const i=await Nb(n.localStore,e);n.currentUser=e,function(s,a){s.mu.forEach(u=>{u.forEach(c=>{c.reject(new oe(Q.CANCELLED,a))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await rd(n,i.Ls)}}function qB(t,e){const n=Te(t),i=n.Au.get(e);if(i&&i.hu)return De().add(i.key);{let r=De();const s=n.Iu.get(e);if(!s)return r;for(const a of s){const u=n.Tu.get(a);r=r.unionWith(u.view.nu)}return r}}function Xb(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Kb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BB.bind(null,e),e.Pu.H_=RB.bind(null,e.eventManager),e.Pu.yu=bB.bind(null,e.eventManager),e}function GB(t){const e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WB.bind(null,e),e}class jp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return YU(this.persistence,new KU,e.initialUser,this.serializer)}Cu(e){return new kb(pw.mi,this.serializer)}Du(e){return new rB}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jp.provider={build:()=>new jp};class KB extends jp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){We(this.persistence.referenceDelegate instanceof Vp,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new LU(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?bn.withCacheSize(this.cacheSizeBytes):bn.DEFAULT;return new kb(i=>Vp.mi(i,n),this.serializer)}}class nv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>eS(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=$B.bind(null,this.syncEngine),await IB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AB}()}createDatastore(e){const n=zm(e.databaseInfo.databaseId),i=function(s){return new uB(s)}(e.databaseInfo);return function(s,a,u,c){return new fB(s,a,u,c)}(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return function(i,r,s,a,u){return new mB(i,r,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>eS(this.syncEngine,n,0),function(){return K1.v()?new K1:new sB}())}createSyncEngine(e,n){return function(r,s,a,u,c,h,p){const m=new DB(r,s,a,u,c,h);return p&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const s=Te(r);ie(sa,"RemoteStore shutting down."),s.Ea.add(5),await id(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}nv.provider={build:()=>new nv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="FirestoreClient";class ZB{constructor(e,n,i,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=dn.UNAUTHENTICATED,this.clientId=ew.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async a=>{ie(Ys,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(ie(Ys,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ur;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=Tw(n,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function d_(t,e){t.asyncQueue.verifyOperationInProgress(),ie(Ys,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async r=>{i.isEqual(r)||(await Nb(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QB(t);ie(Ys,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(i=>Q1(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,r)=>Q1(e.remoteStore,r)),t._onlineComponents=e}async function QB(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ie(Ys,"Using user provided OfflineComponentProvider");try{await d_(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===Q.FAILED_PRECONDITION||r.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Bl("Error using user provided cache. Falling back to memory cache: "+n),await d_(t,new jp)}}else ie(Ys,"Using default OfflineComponentProvider"),await d_(t,new KB(void 0));return t._offlineComponents}async function ek(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ie(Ys,"Using user provided OnlineComponentProvider"),await nS(t,t._uninitializedComponentsProvider._online)):(ie(Ys,"Using default OnlineComponentProvider"),await nS(t,new nv))),t._onlineComponents}function YB(t){return ek(t).then(e=>e.syncEngine)}async function tk(t){const e=await ek(t),n=e.eventManager;return n.onListen=MB.bind(null,e.syncEngine),n.onUnlisten=FB.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=OB.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jB.bind(null,e.syncEngine),n}function XB(t,e,n={}){const i=new Ur;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,c,h){const p=new Jb({next:_=>{p.Nu(),a.enqueueAndForget(()=>Wb(s,m));const T=_.docs.has(u);!T&&_.fromCache?h.reject(new oe(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&_.fromCache&&c&&c.source==="server"?h.reject(new oe(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new Hb(aw(u.path),p,{includeMetadataChanges:!0,qa:!0});return zb(s,m)}(await tk(t),t.asyncQueue,e,n,i)),i.promise}function JB(t,e,n={}){const i=new Ur;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,c,h){const p=new Jb({next:_=>{p.Nu(),a.enqueueAndForget(()=>Wb(s,m)),_.fromCache&&c.source==="server"?h.reject(new oe(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new Hb(u,p,{includeMetadataChanges:!0,qa:!0});return zb(s,m)}(await tk(t),t.asyncQueue,e,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="firestore.googleapis.com",rS=!0;class sS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new oe(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ik,this.ssl=rS}else this.host=e.host,this.ssl=e.ssl??rS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kU)throw new oe(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}m3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nk(e.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new oe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new oe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new oe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $m{constructor(e,n,i,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new s3;switch(i.type){case"firstParty":return new u3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new oe(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=iS.get(n);i&&(ie("ComponentProvider","Removing Datastore"),iS.delete(n),i.terminate())}(this),Promise.resolve()}}function e6(t,e,n,i={}){var h;t=Oi(t,$m);const r=oo(e),s=t._getSettings(),a={...s,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${n}`;r&&(j0(`https://${u}`),U0("Firestore",!0)),s.host!==ik&&s.host!==u&&Bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:u,ssl:r,emulatorOptions:i};if(!Hs(c,a)&&(t._setSettings(c),i.mockUserToken)){let p,m;if(typeof i.mockUserToken=="string")p=i.mockUserToken,m=dn.MOCK_USER;else{p=$A(i.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new oe(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new dn(_)}t._authCredentials=new o3(new zR(p,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new qm(this.firestore,e,this._query)}}class Rt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Us(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rt(this.firestore,e,this._key)}toJSON(){return{type:Rt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(ed(n,Rt._jsonSchema))return new Rt(e,i||null,new ce(Je.fromString(n.referencePath)))}}Rt._jsonSchemaVersion="firestore/documentReference/1.0",Rt._jsonSchema={type:At("string",Rt._jsonSchemaVersion),referencePath:At("string")};class Us extends qm{constructor(e,n,i){super(e,n,aw(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rt(this.firestore,null,new ce(e))}withConverter(e){return new Us(this.firestore,e,this._path)}}function pr(t,e,...n){if(t=ot(t),WR("collection","path",e),t instanceof $m){const i=Je.fromString(e,...n);return v1(i),new Us(t,null,i)}{if(!(t instanceof Rt||t instanceof Us))throw new oe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Je.fromString(e,...n));return v1(i),new Us(t.firestore,null,i)}}function En(t,e,...n){if(t=ot(t),arguments.length===1&&(e=ew.newId()),WR("doc","path",e),t instanceof $m){const i=Je.fromString(e,...n);return y1(i),new Rt(t,null,new ce(i))}{if(!(t instanceof Rt||t instanceof Us))throw new oe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Je.fromString(e,...n));return y1(i),new Rt(t.firestore,t instanceof Us?t.converter:null,new ce(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="AsyncQueue";class aS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Db(this,"async_queue_retry"),this._c=()=>{const i=h_();i&&ie(oS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=h_();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=h_();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Ur;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!cu(e))throw e;ie(oS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,Kr("INTERNAL UNHANDLED ERROR: ",lS(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Ew.createAndSchedule(this,e,n,i,s=>this.hc(s));return this.tc.push(r),r}uc(){this.nc&&pe(47125,{Pc:lS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function lS(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ga extends $m{constructor(e,n,i,r){super(e,n,i,r),this.type="firestore",this._queue=new aS,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aS(e),this._firestoreClient=void 0,await e}}}function t6(t,e){const n=typeof t=="object"?t:Am(),i=typeof t=="string"?t:e||bp,r=Pm(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=zA("firestore");s&&e6(r,...s)}return r}function Iw(t){if(t._terminated)throw new oe(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||n6(t),t._firestoreClient}function n6(t){var i,r,s;const e=t._freezeSettings(),n=function(u,c,h,p){return new I3(u,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,nk(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(t._databaseId,((i=t._app)==null?void 0:i.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ZB(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ri(sn.fromBase64String(e))}catch(n){throw new oe(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ri(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ri._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ed(e,ri._jsonSchema))return ri.fromBase64String(e.bytes)}}ri._jsonSchemaVersion="firestore/bytes/1.0",ri._jsonSchema={type:At("string",ri._jsonSchemaVersion),bytes:At("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ar._jsonSchemaVersion}}static fromJSON(e){if(ed(e,ar._jsonSchema))return new ar(e.latitude,e.longitude)}}ar._jsonSchemaVersion="firestore/geoPoint/1.0",ar._jsonSchema={type:At("string",ar._jsonSchemaVersion),latitude:At("number"),longitude:At("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:lr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ed(e,lr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new lr(e.vectorValues);throw new oe(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}lr._jsonSchemaVersion="firestore/vectorValue/1.0",lr._jsonSchema={type:At("string",lr._jsonSchemaVersion),vectorValues:At("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6=/^__.*__$/;class r6{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ho(e,this.data,this.fieldMask,n,this.fieldTransforms):new td(e,this.data,n,this.fieldTransforms)}}class rk{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ho(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function sk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe(40011,{Ac:t})}}class Aw{constructor(e,n,i,r,s,a){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Aw({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Up(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sk(this.Ac)&&i6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class s6{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||zm(e)}Cc(e,n,i,r=!1){return new Aw({Ac:e,methodName:n,Dc:i,path:tn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rw(t){const e=t._freezeSettings(),n=zm(t._databaseId);return new s6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ok(t,e,n,i,r,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,n,r);bw("Data must be an object, but it was:",a,i);const u=ak(i,a);let c,h;if(s.merge)c=new qn(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=iv(e,m,n);if(!a.contains(_))throw new oe(Q.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);uk(p,_)||p.push(_)}c=new qn(p),h=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=a.fieldTransforms;return new r6(new Ln(u),c,h)}class Km extends Pw{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Km}}function o6(t,e,n,i){const r=t.Cc(1,e,n);bw("Data must be an object, but it was:",r,i);const s=[],a=Ln.empty();co(i,(c,h)=>{const p=kw(e,c,n);h=ot(h);const m=r.yc(p);if(h instanceof Km)s.push(p);else{const _=Zm(h,m);_!=null&&(s.push(p),a.set(p,_))}});const u=new qn(s);return new rk(a,u,r.fieldTransforms)}function a6(t,e,n,i,r,s){const a=t.Cc(1,e,n),u=[iv(e,i,n)],c=[r];if(s.length%2!=0)throw new oe(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)u.push(iv(e,s[_])),c.push(s[_+1]);const h=[],p=Ln.empty();for(let _=u.length-1;_>=0;--_)if(!uk(h,u[_])){const T=u[_];let A=c[_];A=ot(A);const b=a.yc(T);if(A instanceof Km)h.push(T);else{const V=Zm(A,b);V!=null&&(h.push(T),p.set(T,V))}}const m=new qn(h);return new rk(p,m,a.fieldTransforms)}function Zm(t,e){if(lk(t=ot(t)))return bw("Unsupported field value:",e,t),ak(t,e);if(t instanceof Pw)return function(i,r){if(!sk(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(i,r){const s=[];let a=0;for(const u of i){let c=Zm(u,r.wc(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(i,r){if((i=ot(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Z3(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=et.fromDate(i);return{timestampValue:Op(r.serializer,s)}}if(i instanceof et){const s=new et(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Op(r.serializer,s)}}if(i instanceof ar)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ri)return{bytesValue:xb(r.serializer,i._byteString)};if(i instanceof Rt){const s=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dw(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof lr)return function(a,u){return{mapValue:{fields:{[XR]:{stringValue:eb},[kp]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Sc("VectorValues must only contain numeric values.");return lw(u.serializer,h)})}}}}}}(i,r);throw r.Sc(`Unsupported field value: ${tw(i)}`)}(t,e)}function ak(t,e){const n={};return qR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):co(t,(i,r)=>{const s=Zm(r,e.mc(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function lk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof et||t instanceof ar||t instanceof ri||t instanceof Rt||t instanceof Pw||t instanceof lr)}function bw(t,e,n){if(!lk(n)||!HR(n)){const i=tw(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function iv(t,e,n){if((e=ot(e))instanceof Gm)return e._internalPath;if(typeof e=="string")return kw(t,e);throw Up("Field path arguments must be of type string or ",t,!1,void 0,n)}const l6=new RegExp("[~\\*/\\[\\]]");function kw(t,e,n){if(e.search(l6)>=0)throw Up(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gm(...e.split("."))._internalPath}catch{throw Up(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Up(t,e,n,i,r){const s=i&&!i.isEmpty(),a=r!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${i}`),a&&(c+=` in document ${r}`),c+=")"),new oe(Q.INVALID_ARGUMENT,u+t+c)}function uk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e,n,i,r,s){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(hk("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class u6 extends ck{data(){return super.data()}}function hk(t,e){return typeof e=="string"?kw(t,e):e instanceof Gm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class h6{convertValue(e,n="none"){switch(Zs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw pe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return co(e,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertVectorValue(e){var i,r,s;const n=(s=(r=(i=e.fields)==null?void 0:i[kp].arrayValue)==null?void 0:r.values)==null?void 0:s.map(a=>wt(a.doubleValue));return new lr(n)}convertGeoPoint(e){return new ar(wt(e.latitude),wt(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Mm(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Eh(e));default:return null}}convertTimestamp(e){const n=Gs(e);return new et(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Je.fromString(e);We(Rb(i),9688,{name:e});const r=new Th(i.get(1),i.get(3)),s=new ce(i.popFirst(5));return r.isEqual(n)||Kr(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Tc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $o extends ck{constructor(e,n,i,r,s,a){super(e,n,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new zf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(hk("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=$o._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}$o._jsonSchemaVersion="firestore/documentSnapshot/1.0",$o._jsonSchema={type:At("string",$o._jsonSchemaVersion),bundleSource:At("string","DocumentSnapshot"),bundleName:At("string"),bundle:At("string")};class zf extends $o{data(e={}){return super.data(e)}}class Il{constructor(e,n,i,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Tc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(i=>{e.call(n,new zf(this._firestore,this._userDataWriter,i.key,i,new Tc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(u=>{const c=new zf(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Tc(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new zf(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Tc(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,p=-1;return u.type!==0&&(h=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:d6(u.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Il._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ew.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function d6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(t){t=Oi(t,Rt);const e=Oi(t.firestore,ga);return XB(Iw(e),t._key).then(n=>p6(e,t,n))}Il._jsonSchemaVersion="firestore/querySnapshot/1.0",Il._jsonSchema={type:At("string",Il._jsonSchemaVersion),bundleSource:At("string","QuerySnapshot"),bundleName:At("string"),bundle:At("string")};class fk extends h6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ri(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rt(this.firestore,null,n)}}function Qr(t){t=Oi(t,qm);const e=Oi(t.firestore,ga),n=Iw(e),i=new fk(e);return c6(t._query),JB(n,t._query).then(r=>new Il(e,i,t,r))}function uS(t,e,n){t=Oi(t,Rt);const i=Oi(t.firestore,ga),r=dk(t.converter,e,n);return Qm(i,[ok(Rw(i),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,hi.none())])}function qo(t,e,n,...i){t=Oi(t,Rt);const r=Oi(t.firestore,ga),s=Rw(r);let a;return a=typeof(e=ot(e))=="string"||e instanceof Gm?a6(s,"updateDoc",t._key,e,n,i):o6(s,"updateDoc",t._key,e),Qm(r,[a.toMutation(t._key,hi.exists(!0))])}function pk(t){return Qm(Oi(t.firestore,ga),[new uw(t._key,hi.none())])}function f6(t,e){const n=Oi(t.firestore,ga),i=En(t),r=dk(t.converter,e);return Qm(n,[ok(Rw(t.firestore),"addDoc",i._key,r,t.converter!==null,{}).toMutation(i._key,hi.exists(!1))]).then(()=>i)}function Qm(t,e){return function(i,r){const s=new Ur;return i.asyncQueue.enqueueAndForget(async()=>UB(await YB(i),r,s)),s.promise}(Iw(t),e)}function p6(t,e,n){const i=n.docs.get(e._key),r=new fk(t);return new $o(t,r,e._key,i,new Tc(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(r){lu=r})(fa),ta(new $s("firestore",(i,{instanceIdentifier:r,options:s})=>{const a=i.getProvider("app").getImmediate(),u=new ga(new a3(i.getProvider("auth-internal")),new c3(a,i.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new oe(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Th(h.options.projectId,p)}(a,r),a);return s={useFetchStreams:n,...s},u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),ir(p1,m1,e),ir(p1,m1,"esm2020")})();const cS="@firebase/database",hS="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mk="";function m6(t){mk=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Kt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:mh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return mr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new g6(e)}}catch{}return new _6},jo=gk("localStorage"),rv=gk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Im("@firebase/database"),y6=function(){let t=1;return function(){return t++}}(),_k=function(t){const e=MV(t),n=new kV;n.update(e);const i=n.digest();return F0.encodeByteArray(i)},sd=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=sd.apply(null,i):typeof i=="object"?e+=Kt(i):e+=i,e+=" "}return e};let Go=null,dS=!0;const v6=function(t,e){ee(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Pl.logLevel=be.VERBOSE,Go=Pl.log.bind(Pl),e&&rv.set("logging_enabled",!0)):typeof t=="function"?Go=t:(Go=null,rv.remove("logging_enabled"))},Gt=function(...t){if(dS===!0&&(dS=!1,Go===null&&rv.get("logging_enabled")===!0&&v6(!0)),Go){const e=sd.apply(null,t);Go(e)}},od=function(t){return function(...e){Gt(t,...e)}},sv=function(...t){const e="FIREBASE INTERNAL ERROR: "+sd(...t);Pl.error(e)},Yr=function(...t){const e=`FIREBASE FATAL ERROR: ${sd(...t)}`;throw Pl.error(e),new Error(e)},Sn=function(...t){const e="FIREBASE WARNING: "+sd(...t);Pl.warn(e)},w6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Sn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ym=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},E6=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Gl="[MIN_NAME]",oa="[MAX_NAME]",_a=function(t,e){if(t===e)return 0;if(t===Gl||e===oa)return-1;if(e===Gl||t===oa)return 1;{const n=fS(t),i=fS(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},T6=function(t,e){return t===e?0:t<e?-1:1},ac=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Kt(e))},Nw=function(t){if(typeof t!="object"||t===null)return Kt(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Kt(e[i]),n+=":",n+=Nw(t[e[i]]);return n+="}",n},yk=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function Qt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const vk=function(t){ee(!Ym(t),"Invalid JSON number");const e=11,n=52,i=(1<<e-1)-1;let r,s,a,u,c;t===0?(s=0,a=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(u=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=u+i,a=Math.round(t*Math.pow(2,n-u)-Math.pow(2,n))):(s=0,a=Math.round(t/Math.pow(2,1-i-n))));const h=[];for(c=n;c;c-=1)h.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(r?1:0),h.reverse();const p=h.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(p.substr(c,8),2).toString(16);_.length===1&&(_="0"+_),m=m+_}return m.toLowerCase()},x6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},S6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function C6(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}const I6=new RegExp("^-?(0*)\\d{1,10}$"),P6=-2147483648,A6=2147483647,fS=function(t){if(I6.test(t)){const e=Number(t);if(e>=P6&&e<=A6)return e}return null},du=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Sn("Exception was thrown by user callback.",n),e},Math.floor(0))}},R6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bc=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Nn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Sn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Gt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Sn(e)}}class Al{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Al.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw="5",wk="v",Ek="s",Tk="r",xk="f",Sk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ck="ls",Ik="p",ov="ac",Pk="websocket",Ak="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,n,i,r,s=!1,a="",u=!1,c=!1,h=null){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=c,this.emulatorOptions=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=jo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&jo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function N6(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function bk(t,e,n){ee(typeof e=="string","typeof type must == string"),ee(typeof n=="object","typeof params must == object");let i;if(e===Pk)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Ak)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);N6(t)&&(n.ns=t.namespace);const r=[];return Qt(n,(s,a)=>{r.push(s+"="+a)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(){this.counters_={}}incrementCounter(e,n=1){mr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return hV(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_={},p_={};function Dw(t){const e=t.toString();return f_[e]||(f_[e]=new L6),f_[e]}function D6(t,e){const n=t.toString();return p_[n]||(p_[n]=e()),p_[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&du(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="start",O6="close",V6="pLPCommand",F6="pRTLPCB",kk="id",Nk="pw",Lk="ser",j6="cb",U6="seg",B6="ts",z6="d",W6="dframe",Dk=1870,Mk=30,H6=Dk-Mk,$6=25e3,q6=3e4;class ul{constructor(e,n,i,r,s,a,u){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=a,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=od(e),this.stats_=Dw(n),this.urlFn=c=>(this.appCheckToken&&(c[ov]=this.appCheckToken),bk(n,Ak,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new M6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(q6)),E6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mw((...s)=>{const[a,u,c,h,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===pS)this.id=u,this.password=c;else if(a===O6)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{const[a,u]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,u)},()=>{this.onClosed_()},this.urlFn);const i={};i[pS]="t",i[Lk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[j6]=this.scriptTagHolder.uniqueCallbackIdentifier),i[wk]=Lw,this.transportSessionId&&(i[Ek]=this.transportSessionId),this.lastSessionId&&(i[Ck]=this.lastSessionId),this.applicationId&&(i[Ik]=this.applicationId),this.appCheckToken&&(i[ov]=this.appCheckToken),typeof location<"u"&&location.hostname&&Sk.test(location.hostname)&&(i[Tk]=xk);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ul.forceAllow_=!0}static forceDisallow(){ul.forceDisallow_=!0}static isAvailable(){return ul.forceAllow_?!0:!ul.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!x6()&&!S6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Kt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=jA(n),r=yk(i,H6);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[W6]="t",i[kk]=e,i[Nk]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Kt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Mw{constructor(e,n,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=y6(),window[V6+this.uniqueCallbackIdentifier]=e,window[F6+this.uniqueCallbackIdentifier]=n,this.myIFrame=Mw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(u){Gt("frame writing exception"),u.stack&&Gt(u.stack),Gt(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Gt("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[kk]=this.myID,e[Nk]=this.myPW,e[Lk]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Mk+i.length<=Dk;){const a=this.pendingSegs.shift();i=i+"&"+U6+r+"="+a.seg+"&"+B6+r+"="+a.ts+"&"+z6+r+"="+a.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor($6)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{Gt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6=16384,K6=45e3;let Bp=null;typeof MozWebSocket<"u"?Bp=MozWebSocket:typeof WebSocket<"u"&&(Bp=WebSocket);class Ai{constructor(e,n,i,r,s,a,u){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=od(this.connId),this.stats_=Dw(n),this.connURL=Ai.connectionURL_(n,a,u,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,i,r,s){const a={};return a[wk]=Lw,typeof location<"u"&&location.hostname&&Sk.test(location.hostname)&&(a[Tk]=xk),n&&(a[Ek]=n),i&&(a[Ck]=i),r&&(a[ov]=r),s&&(a[Ik]=s),bk(e,Pk,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,jo.set("previous_websocket_failure",!0);try{let i;GA(),this.mySock=new Bp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Ai.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Bp!==null&&!Ai.forceDisallow_}static previouslyFailed(){return jo.isInMemoryStorage||jo.get("previous_websocket_failure")===!0}markConnectionHealthy(){jo.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=mh(n);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ee(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const n=Kt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=yk(n,G6);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(K6))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ai.responsesRequiredToBeHealthy=2;Ai.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{static get ALL_TRANSPORTS(){return[ul,Ai]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Ai&&Ai.isAvailable();let i=n&&!Ai.previouslyFailed();if(e.webSocketOnly&&(n||Sn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ai];else{const r=this.transports_=[];for(const s of Ih.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);Ih.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ih.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6=6e4,Q6=5e3,Y6=10*1024,X6=100*1024,m_="t",mS="d",J6="s",gS="r",ez="e",_S="o",yS="a",vS="n",wS="p",tz="h";class nz{constructor(e,n,i,r,s,a,u,c,h,p){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=a,this.onReady_=u,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=od("c:"+this.id+":"),this.transportManager_=new Ih(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Bc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>X6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Y6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(m_ in e){const n=e[m_];n===yS?this.upgradeIfSecondaryHealthy_():n===gS?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===_S&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=ac("t",e),i=ac("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:wS,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:yS,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:vS,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=ac("t",e),i=ac("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=ac(m_,e);if(mS in e){const i=e[mS];if(n===tz){const r={...i};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===vS){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===J6?this.onConnectionShutdown_(i):n===gS?this.onReset_(i):n===ez?sv("Server Error: "+i):n===_S?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):sv("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Lw!==i&&Sn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Bc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Z6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Q6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:wS,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(jo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e){this.allowedEvents_=e,this.listeners_={},ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});const r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){ee(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp extends Vk{static getInstance(){return new zp}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!B0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return ee(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES=32,TS=768;class $e{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Be(){return new $e("")}function Ce(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Xs(t){return t.pieces_.length-t.pieceNum_}function qe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new $e(t.pieces_,e)}function Ow(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function iz(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ph(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Fk(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new $e(e,0)}function lt(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof $e)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new $e(n,0)}function Pe(t){return t.pieceNum_>=t.pieces_.length}function Mn(t,e){const n=Ce(t),i=Ce(e);if(n===null)return e;if(n===i)return Mn(qe(t),qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function rz(t,e){const n=Ph(t,0),i=Ph(e,0);for(let r=0;r<n.length&&r<i.length;r++){const s=_a(n[r],i[r]);if(s!==0)return s}return n.length===i.length?0:n.length<i.length?-1:1}function Vw(t,e){if(Xs(t)!==Xs(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function ai(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Xs(t)>Xs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class sz{constructor(e,n){this.errorPrefix_=n,this.parts_=Ph(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Cm(this.parts_[i]);jk(this)}}function oz(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Cm(e),jk(t)}function az(t){const e=t.parts_.pop();t.byteLength_-=Cm(e),t.parts_.length>0&&(t.byteLength_-=1)}function jk(t){if(t.byteLength_>TS)throw new Error(t.errorPrefix_+"has a key path longer than "+TS+" bytes ("+t.byteLength_+").");if(t.parts_.length>ES)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ES+") or object contains a cycle "+No(t))}function No(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw extends Vk{static getInstance(){return new Fw}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return ee(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=1e3,lz=60*5*1e3,xS=30*1e3,uz=1.3,cz=3e4,hz="server_kill",SS=3;class Br extends Ok{constructor(e,n,i,r,s,a,u,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=Br.nextPersistentConnectionId_++,this.log_=od("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=lc,this.maxReconnectDelay_=lz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!GA())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Fw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&zp.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,i){const r=++this.requestNumber_,s={r,a:e,b:n};this.log_(Kt(s)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const n=new Ji,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const u=a.d;a.s==="ok"?n.resolve(u):n.reject(u)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,i,r){this.initConnection_();const s=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");const u={onComplete:r,hashFn:n,query:e,tag:i};this.listens.get(a).set(s,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(e){const n=e.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},a="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(a,s,u=>{const c=u.d,h=u.s;Br.warnOnListenWarnings_(c,n),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",u),h!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(h,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&mr(e,"w")){const i=jl(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();Sn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||bV(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=xS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=RV(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{const s=r.s,a=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,i=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(e,n){const i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,n)}sendUnlisten_(e,n,i,r){this.log_("Unlisten on "+e+" for "+n);const s={p:e},a="n";r&&(s.q=i,s.t=r),this.sendRequest(a,s)}onDisconnectPut(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:i})}onDisconnectMerge(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:i})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,i,r){const s={p:n,d:i};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,a=>{r&&setTimeout(()=>{r(a.s,a.d)},Math.floor(0))})}put(e,n,i,r){this.putInternal("p",e,n,i,r)}merge(e,n,i,r){this.putInternal("m",e,n,i,r)}putInternal(e,n,i,r,s){this.initConnection_();const a={p:n,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Kt(e));const n=e.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):sv("Unrecognized action received from server: "+Kt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=lc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=lc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cz&&(this.reconnectDelay_=lc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*uz)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Br.nextConnectionId_++,s=this.lastSessionId;let a=!1,u=null;const c=function(){u?u.close():(a=!0,i())},h=function(m){ee(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(m)};this.realtime_={close:c,sendRequest:h};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,_]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);a?Gt("getToken() completed but was canceled"):(Gt("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,u=new nz(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,i,T=>{Sn(T+" ("+this.repoInfo_.toString()+")"),this.interrupt(hz)},s))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&Sn(m),c())}}}interrupt(e){Gt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Gt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ep(this.interruptReasons_)&&(this.reconnectDelay_=lc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let i;n?i=n.map(s=>Nw(s)).join("$"):i="default";const r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const i=new $e(e).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,n){Gt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=SS&&(this.reconnectDelay_=xS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Gt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=SS&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+mk.replace(/\./g,"-")]=1,B0()?e["framework.cordova"]=1:qA()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=zp.getInstance().currentlyOnline();return Ep(this.interruptReasons_)&&e}}Br.nextPersistentConnectionId_=0;Br.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Ae(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const i=new Ae(Gl,e),r=new Ae(Gl,n);return this.compare(i,r)!==0}minPost(){return Ae.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf;class Uk extends Xm{static get __EMPTY_NODE(){return gf}static set __EMPTY_NODE(e){gf=e}compare(e,n){return _a(e.name,n.name)}isDefinedOn(e){throw su("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ae.MIN}maxPost(){return new Ae(oa,gf)}makePost(e,n){return ee(typeof e=="string","KeyIndex indexValue must always be a string."),new Ae(e,gf)}toString(){return".key"}}const Rl=new Uk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?i(e.key,n):1,r&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class qt{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??qt.RED,this.left=r??On.EMPTY_NODE,this.right=s??On.EMPTY_NODE}copy(e,n,i,r,s){return new qt(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const s=i(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return On.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let i,r;if(i=this,n(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(e,i.key)===0){if(i.right.isEmpty())return On.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}qt.RED=!0;qt.BLACK=!1;class dz{copy(e,n,i,r,s){return this}insert(e,n,i){return new qt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class On{constructor(e,n=On.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new On(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,qt.BLACK,null,null))}remove(e){return new On(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qt.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new _f(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new _f(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new _f(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new _f(this.root_,null,this.comparator_,!0,e)}}On.EMPTY_NODE=new dz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fz(t,e){return _a(t.name,e.name)}function jw(t,e){return _a(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let av;function pz(t){av=t}const Bk=function(t){return typeof t=="number"?"number:"+vk(t):"string:"+t},zk=function(t){if(t.isLeafNode()){const e=t.val();ee(typeof e=="string"||typeof e=="number"||typeof e=="object"&&mr(e,".sv"),"Priority must be a string or number.")}else ee(t===av||t.isEmpty(),"priority of unexpected type.");ee(t===av||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CS;class Wt{static set __childrenNodeConstructor(e){CS=e}static get __childrenNodeConstructor(){return CS}constructor(e,n=Wt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),zk(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Wt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Wt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Pe(e)?this:Ce(e)===".priority"?this.priorityNode_:Wt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Wt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const i=Ce(e);return i===null?n:n.isEmpty()&&i!==".priority"?this:(ee(i!==".priority"||Xs(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Wt.__childrenNodeConstructor.EMPTY_NODE.updateChild(qe(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Bk(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=vk(this.value_):e+=this.value_,this.lazyHash_=_k(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Wt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Wt.__childrenNodeConstructor?-1:(ee(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,i=typeof this.value_,r=Wt.VALUE_TYPE_ORDER.indexOf(n),s=Wt.VALUE_TYPE_ORDER.indexOf(i);return ee(r>=0,"Unknown leaf type: "+n),ee(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Wt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wk,Hk;function mz(t){Wk=t}function gz(t){Hk=t}class _z extends Xm{compare(e,n){const i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?_a(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ae.MIN}maxPost(){return new Ae(oa,new Wt("[PRIORITY-POST]",Hk))}makePost(e,n){const i=Wk(e);return new Ae(n,new Wt("[PRIORITY-POST]",i))}toString(){return".priority"}}const ct=new _z;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz=Math.log(2);class vz{constructor(e){const n=s=>parseInt(Math.log(s)/yz,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Wp=function(t,e,n,i){t.sort(e);const r=function(c,h){const p=h-c;let m,_;if(p===0)return null;if(p===1)return m=t[c],_=n?n(m):m,new qt(_,m.node,qt.BLACK,null,null);{const T=parseInt(p/2,10)+c,A=r(c,T),b=r(T+1,h);return m=t[T],_=n?n(m):m,new qt(_,m.node,qt.BLACK,A,b)}},s=function(c){let h=null,p=null,m=t.length;const _=function(A,b){const V=m-A,C=m;m-=A;const S=r(V+1,C),R=t[V],U=n?n(R):R;T(new qt(U,R.node,b,null,S))},T=function(A){h?(h.left=A,h=A):(p=A,h=A)};for(let A=0;A<c.count;++A){const b=c.nextBitIsOne(),V=Math.pow(2,c.count-(A+1));b?_(V,qt.BLACK):(_(V,qt.BLACK),_(V,qt.RED))}return p},a=new vz(t.length),u=s(a);return new On(i||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g_;const $a={};class Vr{static get Default(){return ee($a&&ct,"ChildrenNode.ts has not been loaded"),g_=g_||new Vr({".priority":$a},{".priority":ct}),g_}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=jl(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof On?n:null}hasIndex(e){return mr(this.indexSet_,e.toString())}addIndex(e,n){ee(e!==Rl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=n.getIterator(Ae.Wrap);let a=s.getNext();for(;a;)r=r||e.isDefinedOn(a.node),i.push(a),a=s.getNext();let u;r?u=Wp(i,e.getCompare()):u=$a;const c=e.toString(),h={...this.indexSet_};h[c]=e;const p={...this.indexes_};return p[c]=u,new Vr(p,h)}addToIndexes(e,n){const i=Tp(this.indexes_,(r,s)=>{const a=jl(this.indexSet_,s);if(ee(a,"Missing index implementation for "+s),r===$a)if(a.isDefinedOn(e.node)){const u=[],c=n.getIterator(Ae.Wrap);let h=c.getNext();for(;h;)h.name!==e.name&&u.push(h),h=c.getNext();return u.push(e),Wp(u,a.getCompare())}else return $a;else{const u=n.get(e.name);let c=r;return u&&(c=c.remove(new Ae(e.name,u))),c.insert(e,e.node)}});return new Vr(i,this.indexSet_)}removeFromIndexes(e,n){const i=Tp(this.indexes_,r=>{if(r===$a)return r;{const s=n.get(e.name);return s?r.remove(new Ae(e.name,s)):r}});return new Vr(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uc;class ge{static get EMPTY_NODE(){return uc||(uc=new ge(new On(jw),null,Vr.Default))}constructor(e,n,i){this.children_=e,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&zk(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||uc}updatePriority(e){return this.children_.isEmpty()?this:new ge(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?uc:n}}getChild(e){const n=Ce(e);return n===null?this:this.getImmediateChild(n).getChild(qe(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(ee(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const i=new Ae(e,n);let r,s;n.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(i,this.children_));const a=r.isEmpty()?uc:this.priorityNode_;return new ge(r,a,s)}}updateChild(e,n){const i=Ce(e);if(i===null)return n;{ee(Ce(e)!==".priority"||Xs(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(qe(e),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(ct,(a,u)=>{n[a]=u.val(e),i++,s&&ge.INTEGER_REGEXP_.test(a)?r=Math.max(r,Number(a)):s=!1}),!e&&s&&r<2*i){const a=[];for(const u in n)a[u]=n[u];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Bk(this.getPriority().val())+":"),this.forEachChild(ct,(n,i)=>{const r=i.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":_k(e)}return this.lazyHash_}getPredecessorChildName(e,n,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new Ae(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Ae(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Ae(n,this.children_.get(n)):null}forEachChild(e,n){const i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Ae.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Ae.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ad?-1:0}withIndex(e){if(e===Rl||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ge(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Rl||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(ct),r=n.getIterator(ct);let s=i.getNext(),a=r.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=r.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===Rl?null:this.indexMap_.get(e.toString())}}ge.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class wz extends ge{constructor(){super(new On(jw),ge.EMPTY_NODE,Vr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ge.EMPTY_NODE}isEmpty(){return!1}}const ad=new wz;Object.defineProperties(Ae,{MIN:{value:new Ae(Gl,ge.EMPTY_NODE)},MAX:{value:new Ae(oa,ad)}});Uk.__EMPTY_NODE=ge.EMPTY_NODE;Wt.__childrenNodeConstructor=ge;pz(ad);gz(ad);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ez=!0;function Tt(t,e=null){if(t===null)return ge.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),ee(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Wt(n,Tt(e))}if(!(t instanceof Array)&&Ez){const n=[];let i=!1;if(Qt(t,(a,u)=>{if(a.substring(0,1)!=="."){const c=Tt(u);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new Ae(a,c)))}}),n.length===0)return ge.EMPTY_NODE;const s=Wp(n,fz,a=>a.name,jw);if(i){const a=Wp(n,ct.getCompare());return new ge(s,Tt(e),new Vr({".priority":a},{".priority":ct}))}else return new ge(s,Tt(e),Vr.Default)}else{let n=ge.EMPTY_NODE;return Qt(t,(i,r)=>{if(mr(t,i)&&i.substring(0,1)!=="."){const s=Tt(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(Tt(e))}}mz(Tt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tz extends Xm{constructor(e){super(),this.indexPath_=e,ee(!Pe(e)&&Ce(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?_a(e.name,n.name):s}makePost(e,n){const i=Tt(e),r=ge.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ae(n,r)}maxPost(){const e=ge.EMPTY_NODE.updateChild(this.indexPath_,ad);return new Ae(oa,e)}toString(){return Ph(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz extends Xm{compare(e,n){const i=e.node.compareTo(n.node);return i===0?_a(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ae.MIN}maxPost(){return Ae.MAX}makePost(e,n){const i=Tt(e);return new Ae(n,i)}toString(){return".value"}}const Sz=new xz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t){return{type:"value",snapshotNode:t}}function Kl(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ah(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Rh(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Cz(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e){this.index_=e}updateChild(e,n,i,r,s,a){ee(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(n);return u.getChild(r).equals(i.getChild(r))&&u.isEmpty()===i.isEmpty()||(a!=null&&(i.isEmpty()?e.hasChild(n)?a.trackChildChange(Ah(n,u)):ee(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?a.trackChildChange(Kl(n,i)):a.trackChildChange(Rh(n,i,u))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(ct,(r,s)=>{n.hasChild(r)||i.trackChildChange(Ah(r,s))}),n.isLeafNode()||n.forEachChild(ct,(r,s)=>{if(e.hasChild(r)){const a=e.getImmediateChild(r);a.equals(s)||i.trackChildChange(Rh(r,s,a))}else i.trackChildChange(Kl(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ge.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e){this.indexedFilter_=new Uw(e.getIndex()),this.index_=e.getIndex(),this.startPost_=bh.getStartPost_(e),this.endPost_=bh.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,r,s,a){return this.matches(new Ae(n,i))||(i=ge.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,a)}updateFullNode(e,n,i){n.isLeafNode()&&(n=ge.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(ge.EMPTY_NODE);const s=this;return n.forEachChild(ct,(a,u)=>{s.matches(new Ae(a,u))||(r=r.updateImmediateChild(a,ge.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{const i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new bh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,r,s,a){return this.rangedFilter_.matches(new Ae(n,i))||(i=ge.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,a):this.fullLimitUpdateChild_(e,n,i,s,a)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=ge.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=ge.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){const u=s.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))r=r.updateImmediateChild(u.name,u.node),a++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(ge.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let a=0;for(;s.hasNext();){const u=s.getNext();a<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?a++:r=r.updateImmediateChild(u.name,ge.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let a;if(this.reverse_){const m=this.index_.getCompare();a=(_,T)=>m(T,_)}else a=this.index_.getCompare();const u=e;ee(u.numChildren()===this.limit_,"");const c=new Ae(n,i),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(u.hasChild(n)){const m=u.getImmediateChild(n);let _=r.getChildAfterChild(this.index_,h,this.reverse_);for(;_!=null&&(_.name===n||u.hasChild(_.name));)_=r.getChildAfterChild(this.index_,_,this.reverse_);const T=_==null?1:a(_,c);if(p&&!i.isEmpty()&&T>=0)return s!=null&&s.trackChildChange(Rh(n,i,m)),u.updateImmediateChild(n,i);{s!=null&&s.trackChildChange(Ah(n,m));const b=u.updateImmediateChild(n,ge.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(s!=null&&s.trackChildChange(Kl(_.name,_.node)),b.updateImmediateChild(_.name,_.node)):b}}else return i.isEmpty()?e:p&&a(h,c)>=0?(s!=null&&(s.trackChildChange(Ah(h.name,h.node)),s.trackChildChange(Kl(n,i))),u.updateImmediateChild(n,i).updateImmediateChild(h.name,ge.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ct}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gl}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:oa}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ct}copy(){const e=new Bw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Pz(t){return t.loadsAllData()?new Uw(t.getIndex()):t.hasLimit()?new Iz(t):new bh(t)}function IS(t){const e={};if(t.isDefault())return e;let n;if(t.index_===ct?n="$priority":t.index_===Sz?n="$value":t.index_===Rl?n="$key":(ee(t.index_ instanceof Tz,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Kt(n),t.startSet_){const i=t.startAfterSet_?"startAfter":"startAt";e[i]=Kt(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Kt(t.indexStartName_))}if(t.endSet_){const i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Kt(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Kt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function PS(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ct&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp extends Ok{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=od("p:rest:"),this.listens_={}}listen(e,n,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const a=Hp.getListenId_(e,i),u={};this.listens_[a]=u;const c=IS(e._queryParams);this.restRequest_(s+".json",c,(h,p)=>{let m=p;if(h===404&&(m=null,h=null),h===null&&this.onDataUpdate_(s,m,!1,i),jl(this.listens_,a)===u){let _;h?h===401?_="permission_denied":_="rest_error:"+h:_="ok",r(_,null)}})}unlisten(e,n){const i=Hp.getListenId_(e,n);delete this.listens_[i]}get(e){const n=IS(e._queryParams),i=e._path.toString(),r=new Ji;return this.restRequest_(i+".json",n,(s,a)=>{let u=a;s===404&&(u=null,s=null),s===null?(this.onDataUpdate_(i,u,!1,null),r.resolve(u)):r.reject(new Error(u))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ou(n);this.log_("Sending REST request for "+a);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(i&&u.readyState===4){this.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);let c=null;if(u.status>=200&&u.status<300){try{c=mh(u.responseText)}catch{Sn("Failed to parse JSON response for "+a+": "+u.responseText)}i(null,c)}else u.status!==401&&u.status!==404&&Sn("Got unsuccessful REST response for "+a+" Status: "+u.status),i(u.status);i=null}},u.open("GET",a,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(){this.rootNode_=ge.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(){return{value:null,children:new Map}}function fu(t,e,n){if(Pe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const i=Ce(e);t.children.has(i)||t.children.set(i,$p());const r=t.children.get(i);e=qe(e),fu(r,e,n)}}function lv(t,e){if(Pe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(ct,(i,r)=>{fu(t,new $e(i),r)}),lv(t,e)}}else if(t.children.size>0){const n=Ce(e);return e=qe(e),t.children.has(n)&&lv(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function uv(t,e,n){t.value!==null?n(e,t.value):Rz(t,(i,r)=>{const s=new $e(e.toString()+"/"+i);uv(r,s,n)})}function Rz(t,e){t.children.forEach((n,i)=>{e(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bz{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Qt(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=10*1e3,kz=30*1e3,Nz=5*60*1e3;class Lz{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new bz(e);const i=AS+(kz-AS)*Math.random();Bc(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),n={};let i=!1;Qt(e,(r,s)=>{s>0&&mr(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),Bc(this.reportStats_.bind(this),Math.floor(Math.random()*2*Nz))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bi;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(bi||(bi={}));function zw(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ww(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Hw(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=bi.ACK_USER_WRITE,this.source=zw()}operationForChild(e){if(Pe(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new $e(e));return new qp(Be(),n,this.revert)}}else return ee(Ce(this.path)===e,"operationForChild called for unrelated child."),new qp(qe(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n){this.source=e,this.path=n,this.type=bi.LISTEN_COMPLETE}operationForChild(e){return Pe(this.path)?new kh(this.source,Be()):new kh(this.source,qe(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=bi.OVERWRITE}operationForChild(e){return Pe(this.path)?new aa(this.source,Be(),this.snap.getImmediateChild(e)):new aa(this.source,qe(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=bi.MERGE}operationForChild(e){if(Pe(this.path)){const n=this.children.subtree(new $e(e));return n.isEmpty()?null:n.value?new aa(this.source,Be(),n.value):new Zl(this.source,Be(),n)}else return ee(Ce(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zl(this.source,qe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Pe(e))return this.isFullyInitialized()&&!this.filtered_;const n=Ce(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dz{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Mz(t,e,n,i){const r=[],s=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(Cz(a.childName,a.snapshotNode))}),cc(t,r,"child_removed",e,i,n),cc(t,r,"child_added",e,i,n),cc(t,r,"child_moved",s,i,n),cc(t,r,"child_changed",e,i,n),cc(t,r,"value",e,i,n),r}function cc(t,e,n,i,r,s){const a=i.filter(u=>u.type===n);a.sort((u,c)=>Vz(t,u,c)),a.forEach(u=>{const c=Oz(t,u,s);r.forEach(h=>{h.respondsTo(u.type)&&e.push(h.createEvent(c,t.query_))})})}function Oz(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Vz(t,e,n){if(e.childName==null||n.childName==null)throw su("Should only compare child_ events.");const i=new Ae(e.childName,e.snapshotNode),r=new Ae(n.childName,n.snapshotNode);return t.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(t,e){return{eventCache:t,serverCache:e}}function zc(t,e,n,i){return Jm(new la(e,n,i),t.serverCache)}function qk(t,e,n,i){return Jm(t.eventCache,new la(e,n,i))}function cv(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ua(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __;const Fz=()=>(__||(__=new On(T6)),__);class Ze{static fromObject(e){let n=new Ze(null);return Qt(e,(i,r)=>{n=n.set(new $e(i),r)}),n}constructor(e,n=Fz()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Be(),value:this.value};if(Pe(e))return null;{const i=Ce(e),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(qe(e),n);return s!=null?{path:lt(new $e(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Pe(e))return this;{const n=Ce(e),i=this.children.get(n);return i!==null?i.subtree(qe(e)):new Ze(null)}}set(e,n){if(Pe(e))return new Ze(n,this.children);{const i=Ce(e),s=(this.children.get(i)||new Ze(null)).set(qe(e),n),a=this.children.insert(i,s);return new Ze(this.value,a)}}remove(e){if(Pe(e))return this.children.isEmpty()?new Ze(null):new Ze(null,this.children);{const n=Ce(e),i=this.children.get(n);if(i){const r=i.remove(qe(e));let s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new Ze(null):new Ze(this.value,s)}else return this}}get(e){if(Pe(e))return this.value;{const n=Ce(e),i=this.children.get(n);return i?i.get(qe(e)):null}}setTree(e,n){if(Pe(e))return n;{const i=Ce(e),s=(this.children.get(i)||new Ze(null)).setTree(qe(e),n);let a;return s.isEmpty()?a=this.children.remove(i):a=this.children.insert(i,s),new Ze(this.value,a)}}fold(e){return this.fold_(Be(),e)}fold_(e,n){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(lt(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,Be(),n)}findOnPath_(e,n,i){const r=this.value?i(n,this.value):!1;if(r)return r;if(Pe(e))return null;{const s=Ce(e),a=this.children.get(s);return a?a.findOnPath_(qe(e),lt(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Be(),n)}foreachOnPath_(e,n,i){if(Pe(e))return this;{this.value&&i(n,this.value);const r=Ce(e),s=this.children.get(r);return s?s.foreachOnPath_(qe(e),lt(n,r),i):new Ze(null)}}foreach(e){this.foreach_(Be(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(lt(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.writeTree_=e}static empty(){return new Di(new Ze(null))}}function Wc(t,e,n){if(Pe(e))return new Di(new Ze(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){const r=i.path;let s=i.value;const a=Mn(r,e);return s=s.updateChild(a,n),new Di(t.writeTree_.set(r,s))}else{const r=new Ze(n),s=t.writeTree_.setTree(e,r);return new Di(s)}}}function hv(t,e,n){let i=t;return Qt(n,(r,s)=>{i=Wc(i,lt(e,r),s)}),i}function RS(t,e){if(Pe(e))return Di.empty();{const n=t.writeTree_.setTree(e,new Ze(null));return new Di(n)}}function dv(t,e){return ya(t,e)!=null}function ya(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Mn(n.path,e)):null}function bS(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ct,(i,r)=>{e.push(new Ae(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new Ae(i,r.value))}),e}function Bs(t,e){if(Pe(e))return t;{const n=ya(t,e);return n!=null?new Di(new Ze(n)):new Di(t.writeTree_.subtree(e))}}function fv(t){return t.writeTree_.isEmpty()}function Ql(t,e){return Gk(Be(),t.writeTree_,e)}function Gk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(ee(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=Gk(lt(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(lt(t,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(t,e){return Yk(e,t)}function jz(t,e,n,i,r){ee(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Wc(t.visibleWrites,e,n)),t.lastWriteId=i}function Uz(t,e,n,i){ee(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=hv(t.visibleWrites,e,n),t.lastWriteId=i}function Bz(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}function zz(t,e){const n=t.allWrites.findIndex(u=>u.writeId===e);ee(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,a=t.allWrites.length-1;for(;r&&a>=0;){const u=t.allWrites[a];u.visible&&(a>=n&&Wz(u,i.path)?r=!1:ai(i.path,u.path)&&(s=!0)),a--}if(r){if(s)return Hz(t),!0;if(i.snap)t.visibleWrites=RS(t.visibleWrites,i.path);else{const u=i.children;Qt(u,c=>{t.visibleWrites=RS(t.visibleWrites,lt(i.path,c))})}return!0}else return!1}function Wz(t,e){if(t.snap)return ai(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ai(lt(t.path,n),e))return!0;return!1}function Hz(t){t.visibleWrites=Kk(t.allWrites,$z,Be()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function $z(t){return t.visible}function Kk(t,e,n){let i=Di.empty();for(let r=0;r<t.length;++r){const s=t[r];if(e(s)){const a=s.path;let u;if(s.snap)ai(n,a)?(u=Mn(n,a),i=Wc(i,u,s.snap)):ai(a,n)&&(u=Mn(a,n),i=Wc(i,Be(),s.snap.getChild(u)));else if(s.children){if(ai(n,a))u=Mn(n,a),i=hv(i,u,s.children);else if(ai(a,n))if(u=Mn(a,n),Pe(u))i=hv(i,Be(),s.children);else{const c=jl(s.children,Ce(u));if(c){const h=c.getChild(qe(u));i=Wc(i,Be(),h)}}}else throw su("WriteRecord should have .snap or .children")}}return i}function Zk(t,e,n,i,r){if(!i&&!r){const s=ya(t.visibleWrites,e);if(s!=null)return s;{const a=Bs(t.visibleWrites,e);if(fv(a))return n;if(n==null&&!dv(a,Be()))return null;{const u=n||ge.EMPTY_NODE;return Ql(a,u)}}}else{const s=Bs(t.visibleWrites,e);if(!r&&fv(s))return n;if(!r&&n==null&&!dv(s,Be()))return null;{const a=function(h){return(h.visible||r)&&(!i||!~i.indexOf(h.writeId))&&(ai(h.path,e)||ai(e,h.path))},u=Kk(t.allWrites,a,e),c=n||ge.EMPTY_NODE;return Ql(u,c)}}}function qz(t,e,n){let i=ge.EMPTY_NODE;const r=ya(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(ct,(s,a)=>{i=i.updateImmediateChild(s,a)}),i;if(n){const s=Bs(t.visibleWrites,e);return n.forEachChild(ct,(a,u)=>{const c=Ql(Bs(s,new $e(a)),u);i=i.updateImmediateChild(a,c)}),bS(s).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}else{const s=Bs(t.visibleWrites,e);return bS(s).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}}function Gz(t,e,n,i,r){ee(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=lt(e,n);if(dv(t.visibleWrites,s))return null;{const a=Bs(t.visibleWrites,s);return fv(a)?r.getChild(n):Ql(a,r.getChild(n))}}function Kz(t,e,n,i){const r=lt(e,n),s=ya(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){const a=Bs(t.visibleWrites,r);return Ql(a,i.getNode().getImmediateChild(n))}else return null}function Zz(t,e){return ya(t.visibleWrites,e)}function Qz(t,e,n,i,r,s,a){let u;const c=Bs(t.visibleWrites,e),h=ya(c,Be());if(h!=null)u=h;else if(n!=null)u=Ql(c,n);else return[];if(u=u.withIndex(a),!u.isEmpty()&&!u.isLeafNode()){const p=[],m=a.getCompare(),_=s?u.getReverseIteratorFrom(i,a):u.getIteratorFrom(i,a);let T=_.getNext();for(;T&&p.length<r;)m(T,i)!==0&&p.push(T),T=_.getNext();return p}else return[]}function Yz(){return{visibleWrites:Di.empty(),allWrites:[],lastWriteId:-1}}function Gp(t,e,n,i){return Zk(t.writeTree,t.treePath,e,n,i)}function qw(t,e){return qz(t.writeTree,t.treePath,e)}function kS(t,e,n,i){return Gz(t.writeTree,t.treePath,e,n,i)}function Kp(t,e){return Zz(t.writeTree,lt(t.treePath,e))}function Xz(t,e,n,i,r,s){return Qz(t.writeTree,t.treePath,e,n,i,r,s)}function Gw(t,e,n){return Kz(t.writeTree,t.treePath,e,n)}function Qk(t,e){return Yk(lt(t.treePath,e),t.writeTree)}function Yk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,i=e.childName;ee(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ee(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Rh(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Ah(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Kl(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Rh(i,e.snapshotNode,r.oldSnap));else throw su("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}}const Xk=new e5;class Kw{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new la(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Gw(this.writes_,e,i)}}getChildAfterChild(e,n,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ua(this.viewCache_),s=Xz(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t5(t){return{filter:t}}function n5(t,e){ee(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),ee(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function i5(t,e,n,i,r){const s=new Jz;let a,u;if(n.type===bi.OVERWRITE){const h=n;h.source.fromUser?a=pv(t,e,h.path,h.snap,i,r,s):(ee(h.source.fromServer,"Unknown source."),u=h.source.tagged||e.serverCache.isFiltered()&&!Pe(h.path),a=Zp(t,e,h.path,h.snap,i,r,u,s))}else if(n.type===bi.MERGE){const h=n;h.source.fromUser?a=s5(t,e,h.path,h.children,i,r,s):(ee(h.source.fromServer,"Unknown source."),u=h.source.tagged||e.serverCache.isFiltered(),a=mv(t,e,h.path,h.children,i,r,u,s))}else if(n.type===bi.ACK_USER_WRITE){const h=n;h.revert?a=l5(t,e,h.path,i,r,s):a=o5(t,e,h.path,h.affectedTree,i,r,s)}else if(n.type===bi.LISTEN_COMPLETE)a=a5(t,e,n.path,i,s);else throw su("Unknown operation type: "+n.type);const c=s.getChanges();return r5(e,a,c),{viewCache:a,changes:c}}function r5(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=cv(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push($k(cv(e)))}}function Jk(t,e,n,i,r,s){const a=e.eventCache;if(Kp(i,n)!=null)return e;{let u,c;if(Pe(n))if(ee(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const h=ua(e),p=h instanceof ge?h:ge.EMPTY_NODE,m=qw(i,p);u=t.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const h=Gp(i,ua(e));u=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const h=Ce(n);if(h===".priority"){ee(Xs(n)===1,"Can't have a priority with additional path components");const p=a.getNode();c=e.serverCache.getNode();const m=kS(i,n,p,c);m!=null?u=t.filter.updatePriority(p,m):u=a.getNode()}else{const p=qe(n);let m;if(a.isCompleteForChild(h)){c=e.serverCache.getNode();const _=kS(i,n,a.getNode(),c);_!=null?m=a.getNode().getImmediateChild(h).updateChild(p,_):m=a.getNode().getImmediateChild(h)}else m=Gw(i,h,e.serverCache);m!=null?u=t.filter.updateChild(a.getNode(),h,m,p,r,s):u=a.getNode()}}return zc(e,u,a.isFullyInitialized()||Pe(n),t.filter.filtersNodes())}}function Zp(t,e,n,i,r,s,a,u){const c=e.serverCache;let h;const p=a?t.filter:t.filter.getIndexedFilter();if(Pe(n))h=p.updateFullNode(c.getNode(),i,null);else if(p.filtersNodes()&&!c.isFiltered()){const T=c.getNode().updateChild(n,i);h=p.updateFullNode(c.getNode(),T,null)}else{const T=Ce(n);if(!c.isCompleteForPath(n)&&Xs(n)>1)return e;const A=qe(n),V=c.getNode().getImmediateChild(T).updateChild(A,i);T===".priority"?h=p.updatePriority(c.getNode(),V):h=p.updateChild(c.getNode(),T,V,A,Xk,null)}const m=qk(e,h,c.isFullyInitialized()||Pe(n),p.filtersNodes()),_=new Kw(r,m,s);return Jk(t,m,n,r,_,u)}function pv(t,e,n,i,r,s,a){const u=e.eventCache;let c,h;const p=new Kw(r,e,s);if(Pe(n))h=t.filter.updateFullNode(e.eventCache.getNode(),i,a),c=zc(e,h,!0,t.filter.filtersNodes());else{const m=Ce(n);if(m===".priority")h=t.filter.updatePriority(e.eventCache.getNode(),i),c=zc(e,h,u.isFullyInitialized(),u.isFiltered());else{const _=qe(n),T=u.getNode().getImmediateChild(m);let A;if(Pe(_))A=i;else{const b=p.getCompleteChild(m);b!=null?Ow(_)===".priority"&&b.getChild(Fk(_)).isEmpty()?A=b:A=b.updateChild(_,i):A=ge.EMPTY_NODE}if(T.equals(A))c=e;else{const b=t.filter.updateChild(u.getNode(),m,A,_,p,a);c=zc(e,b,u.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function NS(t,e){return t.eventCache.isCompleteForChild(e)}function s5(t,e,n,i,r,s,a){let u=e;return i.foreach((c,h)=>{const p=lt(n,c);NS(e,Ce(p))&&(u=pv(t,u,p,h,r,s,a))}),i.foreach((c,h)=>{const p=lt(n,c);NS(e,Ce(p))||(u=pv(t,u,p,h,r,s,a))}),u}function LS(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function mv(t,e,n,i,r,s,a,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,h;Pe(n)?h=i:h=new Ze(null).setTree(n,i);const p=e.serverCache.getNode();return h.children.inorderTraversal((m,_)=>{if(p.hasChild(m)){const T=e.serverCache.getNode().getImmediateChild(m),A=LS(t,T,_);c=Zp(t,c,new $e(m),A,r,s,a,u)}}),h.children.inorderTraversal((m,_)=>{const T=!e.serverCache.isCompleteForChild(m)&&_.value===null;if(!p.hasChild(m)&&!T){const A=e.serverCache.getNode().getImmediateChild(m),b=LS(t,A,_);c=Zp(t,c,new $e(m),b,r,s,a,u)}}),c}function o5(t,e,n,i,r,s,a){if(Kp(r,n)!=null)return e;const u=e.serverCache.isFiltered(),c=e.serverCache;if(i.value!=null){if(Pe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Zp(t,e,n,c.getNode().getChild(n),r,s,u,a);if(Pe(n)){let h=new Ze(null);return c.getNode().forEachChild(Rl,(p,m)=>{h=h.set(new $e(p),m)}),mv(t,e,n,h,r,s,u,a)}else return e}else{let h=new Ze(null);return i.foreach((p,m)=>{const _=lt(n,p);c.isCompleteForPath(_)&&(h=h.set(p,c.getNode().getChild(_)))}),mv(t,e,n,h,r,s,u,a)}}function a5(t,e,n,i,r){const s=e.serverCache,a=qk(e,s.getNode(),s.isFullyInitialized()||Pe(n),s.isFiltered());return Jk(t,a,n,i,Xk,r)}function l5(t,e,n,i,r,s){let a;if(Kp(i,n)!=null)return e;{const u=new Kw(i,e,r),c=e.eventCache.getNode();let h;if(Pe(n)||Ce(n)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Gp(i,ua(e));else{const m=e.serverCache.getNode();ee(m instanceof ge,"serverChildren would be complete if leaf node"),p=qw(i,m)}p=p,h=t.filter.updateFullNode(c,p,s)}else{const p=Ce(n);let m=Gw(i,p,e.serverCache);m==null&&e.serverCache.isCompleteForChild(p)&&(m=c.getImmediateChild(p)),m!=null?h=t.filter.updateChild(c,p,m,qe(n),u,s):e.eventCache.getNode().hasChild(p)?h=t.filter.updateChild(c,p,ge.EMPTY_NODE,qe(n),u,s):h=c,h.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Gp(i,ua(e)),a.isLeafNode()&&(h=t.filter.updateFullNode(h,a,s)))}return a=e.serverCache.isFullyInitialized()||Kp(i,Be())!=null,zc(e,h,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new Uw(i.getIndex()),s=Pz(i);this.processor_=t5(s);const a=n.serverCache,u=n.eventCache,c=r.updateFullNode(ge.EMPTY_NODE,a.getNode(),null),h=s.updateFullNode(ge.EMPTY_NODE,u.getNode(),null),p=new la(c,a.isFullyInitialized(),r.filtersNodes()),m=new la(h,u.isFullyInitialized(),s.filtersNodes());this.viewCache_=Jm(m,p),this.eventGenerator_=new Dz(this.query_)}get query(){return this.query_}}function c5(t){return t.viewCache_.serverCache.getNode()}function h5(t,e){const n=ua(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Pe(e)&&!n.getImmediateChild(Ce(e)).isEmpty())?n.getChild(e):null}function DS(t){return t.eventRegistrations_.length===0}function d5(t,e){t.eventRegistrations_.push(e)}function MS(t,e,n){const i=[];if(n){ee(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(s=>{const a=s.createCancelEvent(n,r);a&&i.push(a)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){const a=t.eventRegistrations_[s];if(!a.matches(e))r.push(a);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return i}function OS(t,e,n,i){e.type===bi.MERGE&&e.source.queryId!==null&&(ee(ua(t.viewCache_),"We should always have a full cache before handling merges"),ee(cv(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,s=i5(t.processor_,r,e,n,i);return n5(t.processor_,s.viewCache),ee(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,eN(t,s.changes,s.viewCache.eventCache.getNode(),null)}function f5(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ct,(s,a)=>{i.push(Kl(s,a))}),n.isFullyInitialized()&&i.push($k(n.getNode())),eN(t,i,n.getNode(),e)}function eN(t,e,n,i){const r=i?[i]:t.eventRegistrations_;return Mz(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qp;class p5{constructor(){this.views=new Map}}function m5(t){ee(!Qp,"__referenceConstructor has already been defined"),Qp=t}function g5(){return ee(Qp,"Reference.ts has not been loaded"),Qp}function _5(t){return t.views.size===0}function Zw(t,e,n,i){const r=e.source.queryId;if(r!==null){const s=t.views.get(r);return ee(s!=null,"SyncTree gave us an op for an invalid query."),OS(s,e,n,i)}else{let s=[];for(const a of t.views.values())s=s.concat(OS(a,e,n,i));return s}}function y5(t,e,n,i,r){const s=e._queryIdentifier,a=t.views.get(s);if(!a){let u=Gp(n,r?i:null),c=!1;u?c=!0:i instanceof ge?(u=qw(n,i),c=!1):(u=ge.EMPTY_NODE,c=!1);const h=Jm(new la(u,c,!1),new la(i,r,!1));return new u5(e,h)}return a}function v5(t,e,n,i,r,s){const a=y5(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),d5(a,n),f5(a,n)}function w5(t,e,n,i){const r=e._queryIdentifier,s=[];let a=[];const u=Js(t);if(r==="default")for(const[c,h]of t.views.entries())a=a.concat(MS(h,n,i)),DS(h)&&(t.views.delete(c),h.query._queryParams.loadsAllData()||s.push(h.query));else{const c=t.views.get(r);c&&(a=a.concat(MS(c,n,i)),DS(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||s.push(c.query)))}return u&&!Js(t)&&s.push(new(g5())(e._repo,e._path)),{removed:s,events:a}}function tN(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function bl(t,e){let n=null;for(const i of t.views.values())n=n||h5(i,e);return n}function nN(t,e){if(e._queryParams.loadsAllData())return eg(t);{const i=e._queryIdentifier;return t.views.get(i)}}function iN(t,e){return nN(t,e)!=null}function Js(t){return eg(t)!=null}function eg(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yp;function E5(t){ee(!Yp,"__referenceConstructor has already been defined"),Yp=t}function T5(){return ee(Yp,"Reference.ts has not been loaded"),Yp}let x5=1;class VS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ze(null),this.pendingWriteTree_=Yz(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function rN(t,e,n,i,r){return jz(t.pendingWriteTree_,e,n,i,r),r?pu(t,new aa(zw(),e,n)):[]}function S5(t,e,n,i){Uz(t.pendingWriteTree_,e,n,i);const r=Ze.fromObject(n);return pu(t,new Zl(zw(),e,r))}function Ps(t,e,n=!1){const i=Bz(t.pendingWriteTree_,e);if(zz(t.pendingWriteTree_,e)){let s=new Ze(null);return i.snap!=null?s=s.set(Be(),!0):Qt(i.children,a=>{s=s.set(new $e(a),!0)}),pu(t,new qp(i.path,s,n))}else return[]}function tg(t,e,n){return pu(t,new aa(Ww(),e,n))}function C5(t,e,n){const i=Ze.fromObject(n);return pu(t,new Zl(Ww(),e,i))}function I5(t,e){return pu(t,new kh(Ww(),e))}function P5(t,e,n){const i=Yw(t,n);if(i){const r=Xw(i),s=r.path,a=r.queryId,u=Mn(s,e),c=new kh(Hw(a),u);return Jw(t,s,c)}else return[]}function gv(t,e,n,i,r=!1){const s=e._path,a=t.syncPointTree_.get(s);let u=[];if(a&&(e._queryIdentifier==="default"||iN(a,e))){const c=w5(a,e,n,i);_5(a)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const h=c.removed;if(u=c.events,!r){const p=h.findIndex(_=>_._queryParams.loadsAllData())!==-1,m=t.syncPointTree_.findOnPath(s,(_,T)=>Js(T));if(p&&!m){const _=t.syncPointTree_.subtree(s);if(!_.isEmpty()){const T=b5(_);for(let A=0;A<T.length;++A){const b=T[A],V=b.query,C=aN(t,b);t.listenProvider_.startListening(Hc(V),Xp(t,V),C.hashFn,C.onComplete)}}}!m&&h.length>0&&!i&&(p?t.listenProvider_.stopListening(Hc(e),null):h.forEach(_=>{const T=t.queryToTagMap.get(ng(_));t.listenProvider_.stopListening(Hc(_),T)}))}k5(t,h)}return u}function A5(t,e,n,i){const r=Yw(t,i);if(r!=null){const s=Xw(r),a=s.path,u=s.queryId,c=Mn(a,e),h=new aa(Hw(u),c,n);return Jw(t,a,h)}else return[]}function R5(t,e,n,i){const r=Yw(t,i);if(r){const s=Xw(r),a=s.path,u=s.queryId,c=Mn(a,e),h=Ze.fromObject(n),p=new Zl(Hw(u),c,h);return Jw(t,a,p)}else return[]}function FS(t,e,n,i=!1){const r=e._path;let s=null,a=!1;t.syncPointTree_.foreachOnPath(r,(_,T)=>{const A=Mn(_,r);s=s||bl(T,A),a=a||Js(T)});let u=t.syncPointTree_.get(r);u?(a=a||Js(u),s=s||bl(u,Be())):(u=new p5,t.syncPointTree_=t.syncPointTree_.set(r,u));let c;s!=null?c=!0:(c=!1,s=ge.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((T,A)=>{const b=bl(A,Be());b&&(s=s.updateImmediateChild(T,b))}));const h=iN(u,e);if(!h&&!e._queryParams.loadsAllData()){const _=ng(e);ee(!t.queryToTagMap.has(_),"View does not exist, but we have a tag");const T=N5();t.queryToTagMap.set(_,T),t.tagToQueryMap.set(T,_)}const p=$w(t.pendingWriteTree_,r);let m=v5(u,e,n,p,s,c);if(!h&&!a&&!i){const _=nN(u,e);m=m.concat(L5(t,e,_))}return m}function Qw(t,e,n){const r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(a,u)=>{const c=Mn(a,e),h=bl(u,c);if(h)return h});return Zk(r,e,s,n,!0)}function pu(t,e){return sN(e,t.syncPointTree_,null,$w(t.pendingWriteTree_,Be()))}function sN(t,e,n,i){if(Pe(t.path))return oN(t,e,n,i);{const r=e.get(Be());n==null&&r!=null&&(n=bl(r,Be()));let s=[];const a=Ce(t.path),u=t.operationForChild(a),c=e.children.get(a);if(c&&u){const h=n?n.getImmediateChild(a):null,p=Qk(i,a);s=s.concat(sN(u,c,h,p))}return r&&(s=s.concat(Zw(r,t,i,n))),s}}function oN(t,e,n,i){const r=e.get(Be());n==null&&r!=null&&(n=bl(r,Be()));let s=[];return e.children.inorderTraversal((a,u)=>{const c=n?n.getImmediateChild(a):null,h=Qk(i,a),p=t.operationForChild(a);p&&(s=s.concat(oN(p,u,c,h)))}),r&&(s=s.concat(Zw(r,t,i,n))),s}function aN(t,e){const n=e.query,i=Xp(t,n);return{hashFn:()=>(c5(e)||ge.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?P5(t,n._path,i):I5(t,n._path);{const s=C6(r,n);return gv(t,n,null,s)}}}}function Xp(t,e){const n=ng(e);return t.queryToTagMap.get(n)}function ng(t){return t._path.toString()+"$"+t._queryIdentifier}function Yw(t,e){return t.tagToQueryMap.get(e)}function Xw(t){const e=t.indexOf("$");return ee(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new $e(t.substr(0,e))}}function Jw(t,e,n){const i=t.syncPointTree_.get(e);ee(i,"Missing sync point for query tag that we're tracking");const r=$w(t.pendingWriteTree_,e);return Zw(i,n,r,null)}function b5(t){return t.fold((e,n,i)=>{if(n&&Js(n))return[eg(n)];{let r=[];return n&&(r=tN(n)),Qt(i,(s,a)=>{r=r.concat(a)}),r}})}function Hc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(T5())(t._repo,t._path):t}function k5(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const r=ng(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function N5(){return x5++}function L5(t,e,n){const i=e._path,r=Xp(t,e),s=aN(t,n),a=t.listenProvider_.startListening(Hc(e),r,s.hashFn,s.onComplete),u=t.syncPointTree_.subtree(i);if(r)ee(!Js(u.value),"If we're adding a query, it shouldn't be shadowed");else{const c=u.fold((h,p,m)=>{if(!Pe(h)&&p&&Js(p))return[eg(p).query];{let _=[];return p&&(_=_.concat(tN(p).map(T=>T.query))),Qt(m,(T,A)=>{_=_.concat(A)}),_}});for(let h=0;h<c.length;++h){const p=c[h];t.listenProvider_.stopListening(Hc(p),Xp(t,p))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new eE(n)}node(){return this.node_}}class tE{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=lt(this.path_,e);return new tE(this.syncTree_,n)}node(){return Qw(this.syncTree_,this.path_)}}const D5=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},jS=function(t,e,n){if(!t||typeof t!="object")return t;if(ee(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return M5(t[".sv"],e,n);if(typeof t[".sv"]=="object")return O5(t[".sv"],e);ee(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},M5=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:ee(!1,"Unexpected server value: "+t)}},O5=function(t,e,n){t.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;typeof i!="number"&&ee(!1,"Unexpected increment value: "+i);const r=e.node();if(ee(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const a=r.getValue();return typeof a!="number"?i:a+i},lN=function(t,e,n,i){return nE(e,new tE(n,t),i)},uN=function(t,e,n){return nE(t,new eE(e),n)};function nE(t,e,n){const i=t.getPriority().val(),r=jS(i,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const a=t,u=jS(a.getValue(),e,n);return u!==a.getValue()||r!==a.getPriority().val()?new Wt(u,Tt(r)):t}else{const a=t;return s=a,r!==a.getPriority().val()&&(s=s.updatePriority(new Wt(r))),a.forEachChild(ct,(u,c)=>{const h=nE(c,e.getImmediateChild(u),n);h!==c&&(s=s.updateImmediateChild(u,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}}function rE(t,e){let n=e instanceof $e?e:new $e(e),i=t,r=Ce(n);for(;r!==null;){const s=jl(i.node.children,r)||{children:{},childCount:0};i=new iE(r,i,s),n=qe(n),r=Ce(n)}return i}function mu(t){return t.node.value}function cN(t,e){t.node.value=e,_v(t)}function hN(t){return t.node.childCount>0}function V5(t){return mu(t)===void 0&&!hN(t)}function ig(t,e){Qt(t.node.children,(n,i)=>{e(new iE(n,t,i))})}function dN(t,e,n,i){n&&!i&&e(t),ig(t,r=>{dN(r,e,!0,i)}),n&&i&&e(t)}function F5(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function ld(t){return new $e(t.parent===null?t.name:ld(t.parent)+"/"+t.name)}function _v(t){t.parent!==null&&j5(t.parent,t.name,t)}function j5(t,e,n){const i=V5(n),r=mr(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,_v(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,_v(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5=/[\[\].#$\/\u0000-\u001F\u007F]/,B5=/[\[\].#$\u0000-\u001F\u007F]/,y_=10*1024*1024,sE=function(t){return typeof t=="string"&&t.length!==0&&!U5.test(t)},fN=function(t){return typeof t=="string"&&t.length!==0&&!B5.test(t)},z5=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),fN(t)},pN=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Ym(t)||t&&typeof t=="object"&&mr(t,".sv")},Jp=function(t,e,n,i){i&&e===void 0||rg(Ul(t,"value"),e,n)},rg=function(t,e,n){const i=n instanceof $e?new sz(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+No(i));if(typeof e=="function")throw new Error(t+"contains a function "+No(i)+" with contents = "+e.toString());if(Ym(e))throw new Error(t+"contains "+e.toString()+" "+No(i));if(typeof e=="string"&&e.length>y_/3&&Cm(e)>y_)throw new Error(t+"contains a string greater than "+y_+" utf8 bytes "+No(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Qt(e,(a,u)=>{if(a===".value")r=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!sE(a)))throw new Error(t+" contains an invalid key ("+a+") "+No(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);oz(i,a),rg(t,u,i),az(i)}),r&&s)throw new Error(t+' contains ".value" child '+No(i)+" in addition to actual children.")}},W5=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];const s=Ph(i);for(let a=0;a<s.length;a++)if(!(s[a]===".priority"&&a===s.length-1)){if(!sE(s[a]))throw new Error(t+"contains an invalid key ("+s[a]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(rz);let r=null;for(n=0;n<e.length;n++){if(i=e[n],r!==null&&ai(r,i))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},mN=function(t,e,n,i){if(i&&e===void 0)return;const r=Ul(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const s=[];Qt(e,(a,u)=>{const c=new $e(a);if(rg(r,u,lt(n,c)),Ow(c)===".priority"&&!pN(u))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),W5(r,s)},H5=function(t,e,n){if(!(n&&e===void 0)){if(Ym(e))throw new Error(Ul(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!pN(e))throw new Error(Ul(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},gN=function(t,e,n,i){if(!(i&&n===void 0)&&!fN(n))throw new Error(Ul(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},$5=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),gN(t,e,n,i)},cl=function(t,e){if(Ce(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},q5=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!sE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!z5(n))throw new Error(Ul(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function sg(t,e){let n=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();n!==null&&!Vw(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function _N(t,e,n){sg(t,n),yN(t,i=>Vw(i,e))}function Vi(t,e,n){sg(t,n),yN(t,i=>ai(i,e)||ai(e,i))}function yN(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const r=t.eventLists_[i];if(r){const s=r.path;e(s)?(K5(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function K5(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const i=n.getEventRunner();Go&&Gt("event: "+n.toString()),du(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z5="repo_interrupt",Q5=25;class Y5{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new G5,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$p(),this.transactionQueueTree_=new iE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function X5(t,e,n){if(t.stats_=Dw(t.repoInfo_),t.forceRestClient_||R6())t.server_=new Hp(t.repoInfo_,(i,r,s,a)=>{US(t,i,r,s,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>BS(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Kt(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Br(t.repoInfo_,e,(i,r,s,a)=>{US(t,i,r,s,a)},i=>{BS(t,i)},i=>{J5(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=D6(t.repoInfo_,()=>new Lz(t.stats_,t.server_)),t.infoData_=new Az,t.infoSyncTree_=new VS({startListening:(i,r,s,a)=>{let u=[];const c=t.infoData_.getNode(i._path);return c.isEmpty()||(u=tg(t.infoSyncTree_,i._path,c),setTimeout(()=>{a("ok")},0)),u},stopListening:()=>{}}),oE(t,"connected",!1),t.serverSyncTree_=new VS({startListening:(i,r,s,a)=>(t.server_.listen(i,s,r,(u,c)=>{const h=a(u,c);Vi(t.eventQueue_,i._path,h)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function vN(t){const n=t.infoData_.getNode(new $e(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function og(t){return D5({timestamp:vN(t)})}function US(t,e,n,i,r){t.dataUpdateCount++;const s=new $e(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(r)if(i){const c=Tp(n,h=>Tt(h));a=R5(t.serverSyncTree_,s,c,r)}else{const c=Tt(n);a=A5(t.serverSyncTree_,s,c,r)}else if(i){const c=Tp(n,h=>Tt(h));a=C5(t.serverSyncTree_,s,c)}else{const c=Tt(n);a=tg(t.serverSyncTree_,s,c)}let u=s;a.length>0&&(u=Yl(t,s)),Vi(t.eventQueue_,u,a)}function BS(t,e){oE(t,"connected",e),e===!1&&n9(t)}function J5(t,e){Qt(e,(n,i)=>{oE(t,n,i)})}function oE(t,e,n){const i=new $e("/.info/"+e),r=Tt(n);t.infoData_.updateSnapshot(i,r);const s=tg(t.infoSyncTree_,i,r);Vi(t.eventQueue_,i,s)}function aE(t){return t.nextWriteId_++}function e9(t,e,n,i,r){ag(t,"set",{path:e.toString(),value:n,priority:i});const s=og(t),a=Tt(n,i),u=Qw(t.serverSyncTree_,e),c=uN(a,u,s),h=aE(t),p=rN(t.serverSyncTree_,e,c,h,!0);sg(t.eventQueue_,p),t.server_.put(e.toString(),a.val(!0),(_,T)=>{const A=_==="ok";A||Sn("set at "+e+" failed: "+_);const b=Ps(t.serverSyncTree_,h,!A);Vi(t.eventQueue_,e,b),eo(t,r,_,T)});const m=uE(t,e);Yl(t,m),Vi(t.eventQueue_,m,[])}function t9(t,e,n,i){ag(t,"update",{path:e.toString(),value:n});let r=!0;const s=og(t),a={};if(Qt(n,(u,c)=>{r=!1,a[u]=lN(lt(e,u),Tt(c),t.serverSyncTree_,s)}),r)Gt("update() called with empty data.  Don't do anything."),eo(t,i,"ok",void 0);else{const u=aE(t),c=S5(t.serverSyncTree_,e,a,u);sg(t.eventQueue_,c),t.server_.merge(e.toString(),n,(h,p)=>{const m=h==="ok";m||Sn("update at "+e+" failed: "+h);const _=Ps(t.serverSyncTree_,u,!m),T=_.length>0?Yl(t,e):e;Vi(t.eventQueue_,T,_),eo(t,i,h,p)}),Qt(n,h=>{const p=uE(t,lt(e,h));Yl(t,p)}),Vi(t.eventQueue_,e,[])}}function n9(t){ag(t,"onDisconnectEvents");const e=og(t),n=$p();uv(t.onDisconnect_,Be(),(r,s)=>{const a=lN(r,s,t.serverSyncTree_,e);fu(n,r,a)});let i=[];uv(n,Be(),(r,s)=>{i=i.concat(tg(t.serverSyncTree_,r,s));const a=uE(t,r);Yl(t,a)}),t.onDisconnect_=$p(),Vi(t.eventQueue_,Be(),i)}function i9(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,r)=>{i==="ok"&&lv(t.onDisconnect_,e),eo(t,n,i,r)})}function zS(t,e,n,i){const r=Tt(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(s,a)=>{s==="ok"&&fu(t.onDisconnect_,e,r),eo(t,i,s,a)})}function r9(t,e,n,i,r){const s=Tt(n,i);t.server_.onDisconnectPut(e.toString(),s.val(!0),(a,u)=>{a==="ok"&&fu(t.onDisconnect_,e,s),eo(t,r,a,u)})}function s9(t,e,n,i){if(Ep(n)){Gt("onDisconnect().update() called with empty data.  Don't do anything."),eo(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,s)=>{r==="ok"&&Qt(n,(a,u)=>{const c=Tt(u);fu(t.onDisconnect_,lt(e,a),c)}),eo(t,i,r,s)})}function o9(t,e,n){let i;Ce(e._path)===".info"?i=FS(t.infoSyncTree_,e,n):i=FS(t.serverSyncTree_,e,n),_N(t.eventQueue_,e._path,i)}function WS(t,e,n){let i;Ce(e._path)===".info"?i=gv(t.infoSyncTree_,e,n):i=gv(t.serverSyncTree_,e,n),_N(t.eventQueue_,e._path,i)}function a9(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Z5)}function ag(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Gt(n,...e)}function eo(t,e,n,i){e&&du(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let s=r;i&&(s+=": "+i);const a=new Error(s);a.code=r,e(a)}})}function wN(t,e,n){return Qw(t.serverSyncTree_,e,n)||ge.EMPTY_NODE}function lE(t,e=t.transactionQueueTree_){if(e||lg(t,e),mu(e)){const n=TN(t,e);ee(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&l9(t,ld(e),n)}else hN(e)&&ig(e,n=>{lE(t,n)})}function l9(t,e,n){const i=n.map(h=>h.currentWriteId),r=wN(t,e,i);let s=r;const a=r.hash();for(let h=0;h<n.length;h++){const p=n[h];ee(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const m=Mn(e,p.path);s=s.updateChild(m,p.currentOutputSnapshotRaw)}const u=s.val(!0),c=e;t.server_.put(c.toString(),u,h=>{ag(t,"transaction put response",{path:c.toString(),status:h});let p=[];if(h==="ok"){const m=[];for(let _=0;_<n.length;_++)n[_].status=2,p=p.concat(Ps(t.serverSyncTree_,n[_].currentWriteId)),n[_].onComplete&&m.push(()=>n[_].onComplete(null,!0,n[_].currentOutputSnapshotResolved)),n[_].unwatcher();lg(t,rE(t.transactionQueueTree_,e)),lE(t,t.transactionQueueTree_),Vi(t.eventQueue_,e,p);for(let _=0;_<m.length;_++)du(m[_])}else{if(h==="datastale")for(let m=0;m<n.length;m++)n[m].status===3?n[m].status=4:n[m].status=0;else{Sn("transaction at "+c.toString()+" failed: "+h);for(let m=0;m<n.length;m++)n[m].status=4,n[m].abortReason=h}Yl(t,e)}},a)}function Yl(t,e){const n=EN(t,e),i=ld(n),r=TN(t,n);return u9(t,r,i),i}function u9(t,e,n){if(e.length===0)return;const i=[];let r=[];const a=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const c=e[u],h=Mn(n,c.path);let p=!1,m;if(ee(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,m=c.abortReason,r=r.concat(Ps(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Q5)p=!0,m="maxretry",r=r.concat(Ps(t.serverSyncTree_,c.currentWriteId,!0));else{const _=wN(t,c.path,a);c.currentInputSnapshot=_;const T=e[u].update(_.val());if(T!==void 0){rg("transaction failed: Data returned ",T,c.path);let A=Tt(T);typeof T=="object"&&T!=null&&mr(T,".priority")||(A=A.updatePriority(_.getPriority()));const V=c.currentWriteId,C=og(t),S=uN(A,_,C);c.currentOutputSnapshotRaw=A,c.currentOutputSnapshotResolved=S,c.currentWriteId=aE(t),a.splice(a.indexOf(V),1),r=r.concat(rN(t.serverSyncTree_,c.path,S,c.currentWriteId,c.applyLocally)),r=r.concat(Ps(t.serverSyncTree_,V,!0))}else p=!0,m="nodata",r=r.concat(Ps(t.serverSyncTree_,c.currentWriteId,!0))}Vi(t.eventQueue_,n,r),r=[],p&&(e[u].status=2,function(_){setTimeout(_,Math.floor(0))}(e[u].unwatcher),e[u].onComplete&&(m==="nodata"?i.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):i.push(()=>e[u].onComplete(new Error(m),!1,null))))}lg(t,t.transactionQueueTree_);for(let u=0;u<i.length;u++)du(i[u]);lE(t,t.transactionQueueTree_)}function EN(t,e){let n,i=t.transactionQueueTree_;for(n=Ce(e);n!==null&&mu(i)===void 0;)i=rE(i,n),e=qe(e),n=Ce(e);return i}function TN(t,e){const n=[];return xN(t,e,n),n.sort((i,r)=>i.order-r.order),n}function xN(t,e,n){const i=mu(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);ig(e,r=>{xN(t,r,n)})}function lg(t,e){const n=mu(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,cN(e,n.length>0?n:void 0)}ig(e,i=>{lg(t,i)})}function uE(t,e){const n=ld(EN(t,e)),i=rE(t.transactionQueueTree_,e);return F5(i,r=>{v_(t,r)}),v_(t,i),dN(i,r=>{v_(t,r)}),n}function v_(t,e){const n=mu(e);if(n){const i=[];let r=[],s=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(ee(s===a-1,"All SENT items should be at beginning of queue."),s=a,n[a].status=3,n[a].abortReason="set"):(ee(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),r=r.concat(Ps(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&i.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?cN(e,void 0):n.length=s+1,Vi(t.eventQueue_,ld(e),r);for(let a=0;a<i.length;a++)du(i[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(t){let e="";const n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function h9(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Sn(`Invalid query segment '${n}' in query '${t}'`)}return e}const HS=function(t,e){const n=d9(t),i=n.namespace;n.domain==="firebase.com"&&Yr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Yr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||w6();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Rk(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new $e(n.pathString)}},d9=function(t){let e="",n="",i="",r="",s="",a=!0,u="https",c=443;if(typeof t=="string"){let h=t.indexOf("//");h>=0&&(u=t.substring(0,h-1),t=t.substring(h+2));let p=t.indexOf("/");p===-1&&(p=t.length);let m=t.indexOf("?");m===-1&&(m=t.length),e=t.substring(0,Math.min(p,m)),p<m&&(r=c9(t.substring(p,m)));const _=h9(t.substring(Math.min(t.length,m)));h=e.indexOf(":"),h>=0?(a=u==="https"||u==="wss",c=parseInt(e.substring(h+1),10)):h=e.length;const T=e.slice(0,h);if(T.toLowerCase()==="localhost")n="localhost";else if(T.split(".").length<=2)n=T;else{const A=e.indexOf(".");i=e.substring(0,A).toLowerCase(),n=e.substring(A+1),s=i}"ns"in _&&(s=_.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:a,scheme:u,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",f9=function(){let t=0;const e=[];return function(n){const i=n===t;t=n;let r;const s=new Array(8);for(r=7;r>=0;r--)s[r]=$S.charAt(n%64),n=Math.floor(n/64);ee(n===0,"Cannot push at time == 0");let a=s.join("");if(i){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)a+=$S.charAt(e[r]);return ee(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n,i,r){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Kt(this.snapshot.exportVal())}}class CN{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m9{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Ji;return i9(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){cl("OnDisconnect.remove",this._path);const e=new Ji;return zS(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){cl("OnDisconnect.set",this._path),Jp("OnDisconnect.set",e,this._path,!1);const n=new Ji;return zS(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){cl("OnDisconnect.setWithPriority",this._path),Jp("OnDisconnect.setWithPriority",e,this._path,!1),H5("OnDisconnect.setWithPriority",n,!1);const i=new Ji;return r9(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){cl("OnDisconnect.update",this._path),mN("OnDisconnect.update",e,this._path,!1);const n=new Ji;return s9(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return Pe(this._path)?null:Ow(this._path)}get ref(){return new ns(this._repo,this._path)}get _queryIdentifier(){const e=PS(this._queryParams),n=Nw(e);return n==="{}"?"default":n}get _queryObject(){return PS(this._queryParams)}isEqual(e){if(e=ot(e),!(e instanceof cE))return!1;const n=this._repo===e._repo,i=Vw(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+iz(this._path)}}class ns extends cE{constructor(e,n){super(e,n,new Bw,!1)}get parent(){const e=Fk(this._path);return e===null?null:new ns(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Nh{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new $e(e),i=Xl(this.ref,e);return new Nh(this._node.getChild(n),i,ct)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new Nh(r,Xl(this.ref,i),ct)))}hasChild(e){const n=new $e(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function yt(t,e){return t=ot(t),t._checkNotDeleted("ref"),e!==void 0?Xl(t._root,e):t._root}function Xl(t,e){return t=ot(t),Ce(t._path)===null?$5("child","path",e,!1):gN("child","path",e,!1),new ns(t._repo,lt(t._path,e))}function qS(t){return t=ot(t),new m9(t._repo,t._path)}function GS(t,e){t=ot(t),cl("push",t._path),Jp("push",e,t._path,!0);const n=vN(t._repo),i=f9(n),r=Xl(t,i),s=Xl(t,i);let a;return e!=null?a=Lh(s,e).then(()=>s):a=Promise.resolve(s),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}function Lh(t,e){t=ot(t),cl("set",t._path),Jp("set",e,t._path,!1);const n=new Ji;return e9(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function xc(t,e){mN("update",e,t._path,!1);const n=new Ji;return t9(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}class hE{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const i=n._queryParams.getIndex();return new SN("value",this,new Nh(e.snapshotNode,new ns(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new CN(this,e,n):null}matches(e){return e instanceof hE?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class dE{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new CN(this,e,n):null}createEvent(e,n){ee(e.childName!=null,"Child events should have a childName.");const i=Xl(new ns(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new SN(e.type,this,new Nh(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof dE?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function g9(t,e,n,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){const c=n,h=(p,m)=>{WS(t._repo,t,u),c(p,m)};h.userCallback=n.userCallback,h.context=n.context,n=h}const a=new p9(n,s||void 0),u=e==="value"?new hE(a):new dE(e,a);return o9(t._repo,t,u),()=>WS(t._repo,t,u)}function ur(t,e,n,i){return g9(t,"value",e,n,i)}m5(ns);E5(ns);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9="FIREBASE_DATABASE_EMULATOR_HOST",yv={};let y9=!1;function v9(t,e,n,i){const r=e.lastIndexOf(":"),s=e.substring(0,r),a=oo(s);t.repoInfo_=new Rk(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),i&&(t.authTokenProvider_=i)}function w9(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||Yr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Gt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=HS(s,r),u=a.repoInfo,c,h;typeof process<"u"&&process.env&&(h=process.env[_9]),h?(c=!0,s=`http://${h}?ns=${u.namespace}`,a=HS(s,r),u=a.repoInfo):c=!a.repoInfo.secure;const p=r&&c?new Al(Al.OWNER):new k6(t.name,t.options,e);q5("Invalid Firebase Database URL",a),Pe(a.path)||Yr("Database URL must point to the root of a Firebase Database (not including a child path).");const m=T9(u,t,p,new b6(t,n));return new x9(m,t)}function E9(t,e){const n=yv[e];(!n||n[t.key]!==t)&&Yr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),a9(t),delete n[t.key]}function T9(t,e,n,i){let r=yv[e.name];r||(r={},yv[e.name]=r);let s=r[t.toURLString()];return s&&Yr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Y5(t,y9,n,i),r[t.toURLString()]=s,s}class x9{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(X5(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ns(this._repo,Be())),this._rootInternal}_delete(){return this._rootInternal!==null&&(E9(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Yr("Cannot call "+e+" on a deleted database.")}}function S9(t=Am(),e){const n=Pm(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const i=zA("database");i&&C9(n,...i)}return n}function C9(t,e,n,i={}){t=ot(t),t._checkNotDeleted("useEmulator");const r=`${e}:${n}`,s=t._repoInternal;if(t._instanceStarted){if(r===t._repoInternal.repoInfo_.host&&Hs(i,s.repoInfo_.emulatorOptions))return;Yr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Yr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Al(Al.OWNER);else if(i.mockUserToken){const u=typeof i.mockUserToken=="string"?i.mockUserToken:$A(i.mockUserToken,t.app.options.projectId);a=new Al(u)}oo(e)&&(j0(e),U0("Database",!0)),v9(s,r,i,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(t){m6(fa),ta(new $s("database",(e,{instanceIdentifier:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return w9(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),ir(cS,hS,t),ir(cS,hS,"esm2020")}Br.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Br.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};I9();const P9={apiKey:"AIzaSyBqN_39amumZ8cyv5MWIZ1sxHS04iwCD0Q",authDomain:"bustrackerinstituto.firebaseapp.com",databaseURL:"https://bustrackerinstituto-default-rtdb.firebaseio.com",projectId:"bustrackerinstituto",storageBucket:"bustrackerinstituto.firebasestorage.app",messagingSenderId:"294028478490",appId:"1:294028478490:web:63f042d5dbff08b244a9a3"},fE=DF().length?Am():YA(P9),si=DR(fE),rt=t6(fE),vt=S9(fE);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),R9=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,i)=>i?i.toUpperCase():n.toLowerCase()),KS=t=>{const e=R9(t);return e.charAt(0).toUpperCase()+e.slice(1)},IN=(...t)=>t.filter((e,n,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===n).join(" ").trim(),b9=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var k9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N9=B.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:a,...u},c)=>B.createElement("svg",{ref:c,...k9,width:e,height:e,stroke:t,strokeWidth:i?Number(n)*24/Number(e):n,className:IN("lucide",r),...!s&&!b9(u)&&{"aria-hidden":"true"},...u},[...a.map(([h,p])=>B.createElement(h,p)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=(t,e)=>{const n=B.forwardRef(({className:i,...r},s)=>B.createElement(N9,{ref:s,iconNode:e,className:IN(`lucide-${A9(KS(t))}`,`lucide-${t}`,i),...r}));return n.displayName=KS(t),n};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],PN=gr("bell",L9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=[["path",{d:"M8 6v6",key:"18i7km"}],["path",{d:"M15 6v6",key:"1sg6z9"}],["path",{d:"M2 12h19.6",key:"de5uta"}],["path",{d:"M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3",key:"1wwztk"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M9 18h5",key:"lrx6i"}],["circle",{cx:"16",cy:"18",r:"2",key:"1v4tcr"}]],pE=gr("bus",D9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],w_=gr("calendar",M9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ZS=gr("clock",O9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V9=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],F9=gr("layout-dashboard",V9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],mE=gr("log-out",j9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Dh=gr("map-pin",U9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Sc=gr("route",B9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],W9=gr("user",z9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$9=gr("users",H9),AN=B.createContext({});function q9(t){const e=B.useRef(null);return e.current===null&&(e.current=t()),e.current}const gE=typeof window<"u",G9=gE?B.useLayoutEffect:B.useEffect,_E=B.createContext(null);function yE(t,e){t.indexOf(e)===-1&&t.push(e)}function vE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Xr=(t,e,n)=>n>e?e:n<t?t:n;let wE=()=>{};const Jr={},RN=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function bN(t){return typeof t=="object"&&t!==null}const kN=t=>/^0[^.\s]+$/u.test(t);function EE(t){let e;return()=>(e===void 0&&(e=t()),e)}const di=t=>t,K9=(t,e)=>n=>e(t(n)),ud=(...t)=>t.reduce(K9),Mh=(t,e,n)=>{const i=e-t;return i===0?1:(n-t)/i};class TE{constructor(){this.subscriptions=[]}add(e){return yE(this.subscriptions,e),()=>vE(this.subscriptions,e)}notify(e,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,i);else for(let s=0;s<r;s++){const a=this.subscriptions[s];a&&a(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const cr=t=>t*1e3,li=t=>t/1e3;function NN(t,e){return e?t*(1e3/e):0}const LN=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Z9=1e-7,Q9=12;function Y9(t,e,n,i,r){let s,a,u=0;do a=e+(n-e)/2,s=LN(a,i,r)-t,s>0?n=a:e=a;while(Math.abs(s)>Z9&&++u<Q9);return a}function cd(t,e,n,i){if(t===e&&n===i)return di;const r=s=>Y9(s,0,1,t,n);return s=>s===0||s===1?s:LN(r(s),e,i)}const DN=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,MN=t=>e=>1-t(1-e),ON=cd(.33,1.53,.69,.99),xE=MN(ON),VN=DN(xE),FN=t=>(t*=2)<1?.5*xE(t):.5*(2-Math.pow(2,-10*(t-1))),SE=t=>1-Math.sin(Math.acos(t)),jN=MN(SE),UN=DN(SE),X9=cd(.42,0,1,1),J9=cd(0,0,.58,1),BN=cd(.42,0,.58,1),eW=t=>Array.isArray(t)&&typeof t[0]!="number",zN=t=>Array.isArray(t)&&typeof t[0]=="number",tW={linear:di,easeIn:X9,easeInOut:BN,easeOut:J9,circIn:SE,circInOut:UN,circOut:jN,backIn:xE,backInOut:VN,backOut:ON,anticipate:FN},nW=t=>typeof t=="string",QS=t=>{if(zN(t)){wE(t.length===4);const[e,n,i,r]=t;return cd(e,n,i,r)}else if(nW(t))return tW[t];return t},yf=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],YS={value:null,addProjectionMetrics:null};function iW(t,e){let n=new Set,i=new Set,r=!1,s=!1;const a=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1},c=0;function h(m){a.has(m)&&(p.schedule(m),t()),c++,m(u)}const p={schedule:(m,_=!1,T=!1)=>{const b=T&&r?n:i;return _&&a.add(m),b.has(m)||b.add(m),m},cancel:m=>{i.delete(m),a.delete(m)},process:m=>{if(u=m,r){s=!0;return}r=!0,[n,i]=[i,n],n.forEach(h),e&&YS.value&&YS.value.frameloop[e].push(c),c=0,n.clear(),r=!1,s&&(s=!1,p.process(m))}};return p}const rW=40;function WN(t,e){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,a=yf.reduce((R,U)=>(R[U]=iW(s,e?U:void 0),R),{}),{setup:u,read:c,resolveKeyframes:h,preUpdate:p,update:m,preRender:_,render:T,postRender:A}=a,b=()=>{const R=Jr.useManualTiming?r.timestamp:performance.now();n=!1,Jr.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,rW),1)),r.timestamp=R,r.isProcessing=!0,u.process(r),c.process(r),h.process(r),p.process(r),m.process(r),_.process(r),T.process(r),A.process(r),r.isProcessing=!1,n&&e&&(i=!1,t(b))},V=()=>{n=!0,i=!0,r.isProcessing||t(b)};return{schedule:yf.reduce((R,U)=>{const W=a[U];return R[U]=(K,k=!1,I=!1)=>(n||V(),W.schedule(K,k,I)),R},{}),cancel:R=>{for(let U=0;U<yf.length;U++)a[yf[U]].cancel(R)},state:r,steps:a}}const{schedule:st,cancel:to,state:en,steps:E_}=WN(typeof requestAnimationFrame<"u"?requestAnimationFrame:di,!0);let Hf;function sW(){Hf=void 0}const Vn={now:()=>(Hf===void 0&&Vn.set(en.isProcessing||Jr.useManualTiming?en.timestamp:performance.now()),Hf),set:t=>{Hf=t,queueMicrotask(sW)}},HN=t=>e=>typeof e=="string"&&e.startsWith(t),CE=HN("--"),oW=HN("var(--"),IE=t=>oW(t)?aW.test(t.split("/*")[0].trim()):!1,aW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,gu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Oh={...gu,transform:t=>Xr(0,1,t)},vf={...gu,default:1},$c=t=>Math.round(t*1e5)/1e5,PE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lW(t){return t==null}const uW=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AE=(t,e)=>n=>!!(typeof n=="string"&&uW.test(n)&&n.startsWith(t)||e&&!lW(n)&&Object.prototype.hasOwnProperty.call(n,e)),$N=(t,e,n)=>i=>{if(typeof i!="string")return i;const[r,s,a,u]=i.match(PE);return{[t]:parseFloat(r),[e]:parseFloat(s),[n]:parseFloat(a),alpha:u!==void 0?parseFloat(u):1}},cW=t=>Xr(0,255,t),T_={...gu,transform:t=>Math.round(cW(t))},Uo={test:AE("rgb","red"),parse:$N("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+T_.transform(t)+", "+T_.transform(e)+", "+T_.transform(n)+", "+$c(Oh.transform(i))+")"};function hW(t){let e="",n="",i="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const vv={test:AE("#"),parse:hW,transform:Uo.transform},hd=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),ms=hd("deg"),hr=hd("%"),me=hd("px"),dW=hd("vh"),fW=hd("vw"),XS=(()=>({...hr,parse:t=>hr.parse(t)/100,transform:t=>hr.transform(t*100)}))(),hl={test:AE("hsl","hue"),parse:$N("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+hr.transform($c(e))+", "+hr.transform($c(n))+", "+$c(Oh.transform(i))+")"},It={test:t=>Uo.test(t)||vv.test(t)||hl.test(t),parse:t=>Uo.test(t)?Uo.parse(t):hl.test(t)?hl.parse(t):vv.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Uo.transform(t):hl.transform(t),getAnimatableNone:t=>{const e=It.parse(t);return e.alpha=0,It.transform(e)}},pW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mW(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(PE))==null?void 0:e.length)||0)+(((n=t.match(pW))==null?void 0:n.length)||0)>0}const qN="number",GN="color",gW="var",_W="var(",JS="${}",yW=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vh(t){const e=t.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const u=e.replace(yW,c=>(It.test(c)?(i.color.push(s),r.push(GN),n.push(It.parse(c))):c.startsWith(_W)?(i.var.push(s),r.push(gW),n.push(c)):(i.number.push(s),r.push(qN),n.push(parseFloat(c))),++s,JS)).split(JS);return{values:n,split:u,indexes:i,types:r}}function KN(t){return Vh(t).values}function ZN(t){const{split:e,types:n}=Vh(t),i=e.length;return r=>{let s="";for(let a=0;a<i;a++)if(s+=e[a],r[a]!==void 0){const u=n[a];u===qN?s+=$c(r[a]):u===GN?s+=It.transform(r[a]):s+=r[a]}return s}}const vW=t=>typeof t=="number"?0:It.test(t)?It.getAnimatableNone(t):t;function wW(t){const e=KN(t);return ZN(t)(e.map(vW))}const no={test:mW,parse:KN,createTransformer:ZN,getAnimatableNone:wW};function x_(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function EW({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,e/=100,n/=100;let r=0,s=0,a=0;if(!e)r=s=a=n;else{const u=n<.5?n*(1+e):n+e-n*e,c=2*n-u;r=x_(c,u,t+1/3),s=x_(c,u,t),a=x_(c,u,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:i}}function em(t,e){return n=>n>0?e:t}const ut=(t,e,n)=>t+(e-t)*n,S_=(t,e,n)=>{const i=t*t,r=n*(e*e-i)+i;return r<0?0:Math.sqrt(r)},TW=[vv,Uo,hl],xW=t=>TW.find(e=>e.test(t));function eC(t){const e=xW(t);if(!e)return!1;let n=e.parse(t);return e===hl&&(n=EW(n)),n}const tC=(t,e)=>{const n=eC(t),i=eC(e);if(!n||!i)return em(t,e);const r={...n};return s=>(r.red=S_(n.red,i.red,s),r.green=S_(n.green,i.green,s),r.blue=S_(n.blue,i.blue,s),r.alpha=ut(n.alpha,i.alpha,s),Uo.transform(r))},wv=new Set(["none","hidden"]);function SW(t,e){return wv.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function CW(t,e){return n=>ut(t,e,n)}function RE(t){return typeof t=="number"?CW:typeof t=="string"?IE(t)?em:It.test(t)?tC:AW:Array.isArray(t)?QN:typeof t=="object"?It.test(t)?tC:IW:em}function QN(t,e){const n=[...t],i=n.length,r=t.map((s,a)=>RE(s)(s,e[a]));return s=>{for(let a=0;a<i;a++)n[a]=r[a](s);return n}}function IW(t,e){const n={...t,...e},i={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(i[r]=RE(t[r])(t[r],e[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}}function PW(t,e){const n=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],a=t.indexes[s][i[s]],u=t.values[a]??0;n[r]=u,i[s]++}return n}const AW=(t,e)=>{const n=no.createTransformer(e),i=Vh(t),r=Vh(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?wv.has(t)&&!r.values.length||wv.has(e)&&!i.values.length?SW(t,e):ud(QN(PW(i,r),r.values),n):em(t,e)};function YN(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?ut(t,e,n):RE(t)(t,e)}const RW=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>st.update(e,n),stop:()=>to(e),now:()=>en.isProcessing?en.timestamp:Vn.now()}},XN=(t,e,n=10)=>{let i="";const r=Math.max(Math.round(e/n),2);for(let s=0;s<r;s++)i+=Math.round(t(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},tm=2e4;function bE(t){let e=0;const n=50;let i=t.next(e);for(;!i.done&&e<tm;)e+=n,i=t.next(e);return e>=tm?1/0:e}function bW(t,e=100,n){const i=n({...t,keyframes:[0,e]}),r=Math.min(bE(i),tm);return{type:"keyframes",ease:s=>i.next(r*s).value/e,duration:li(r)}}const kW=5;function JN(t,e,n){const i=Math.max(e-kW,0);return NN(n-t(i),e-i)}const mt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},C_=.001;function NW({duration:t=mt.duration,bounce:e=mt.bounce,velocity:n=mt.velocity,mass:i=mt.mass}){let r,s,a=1-e;a=Xr(mt.minDamping,mt.maxDamping,a),t=Xr(mt.minDuration,mt.maxDuration,li(t)),a<1?(r=h=>{const p=h*a,m=p*t,_=p-n,T=Ev(h,a),A=Math.exp(-m);return C_-_/T*A},s=h=>{const m=h*a*t,_=m*n+n,T=Math.pow(a,2)*Math.pow(h,2)*t,A=Math.exp(-m),b=Ev(Math.pow(h,2),a);return(-r(h)+C_>0?-1:1)*((_-T)*A)/b}):(r=h=>{const p=Math.exp(-h*t),m=(h-n)*t+1;return-C_+p*m},s=h=>{const p=Math.exp(-h*t),m=(n-h)*(t*t);return p*m});const u=5/t,c=DW(r,s,u);if(t=cr(t),isNaN(c))return{stiffness:mt.stiffness,damping:mt.damping,duration:t};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:a*2*Math.sqrt(i*h),duration:t}}}const LW=12;function DW(t,e,n){let i=n;for(let r=1;r<LW;r++)i=i-t(i)/e(i);return i}function Ev(t,e){return t*Math.sqrt(1-e*e)}const MW=["duration","bounce"],OW=["stiffness","damping","mass"];function nC(t,e){return e.some(n=>t[n]!==void 0)}function VW(t){let e={velocity:mt.velocity,stiffness:mt.stiffness,damping:mt.damping,mass:mt.mass,isResolvedFromDuration:!1,...t};if(!nC(t,OW)&&nC(t,MW))if(t.visualDuration){const n=t.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,s=2*Xr(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:mt.mass,stiffness:r,damping:s}}else{const n=NW(t);e={...e,...n,mass:mt.mass},e.isResolvedFromDuration=!0}return e}function nm(t=mt.visualDuration,e=mt.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],u={done:!1,value:s},{stiffness:c,damping:h,mass:p,duration:m,velocity:_,isResolvedFromDuration:T}=VW({...n,velocity:-li(n.velocity||0)}),A=_||0,b=h/(2*Math.sqrt(c*p)),V=a-s,C=li(Math.sqrt(c/p)),S=Math.abs(V)<5;i||(i=S?mt.restSpeed.granular:mt.restSpeed.default),r||(r=S?mt.restDelta.granular:mt.restDelta.default);let R;if(b<1){const W=Ev(C,b);R=K=>{const k=Math.exp(-b*C*K);return a-k*((A+b*C*V)/W*Math.sin(W*K)+V*Math.cos(W*K))}}else if(b===1)R=W=>a-Math.exp(-C*W)*(V+(A+C*V)*W);else{const W=C*Math.sqrt(b*b-1);R=K=>{const k=Math.exp(-b*C*K),I=Math.min(W*K,300);return a-k*((A+b*C*V)*Math.sinh(I)+W*V*Math.cosh(I))/W}}const U={calculatedDuration:T&&m||null,next:W=>{const K=R(W);if(T)u.done=W>=m;else{let k=W===0?A:0;b<1&&(k=W===0?cr(A):JN(R,W,K));const I=Math.abs(k)<=i,N=Math.abs(a-K)<=r;u.done=I&&N}return u.value=u.done?a:K,u},toString:()=>{const W=Math.min(bE(U),tm),K=XN(k=>U.next(W*k).value,W,30);return W+"ms "+K},toTransition:()=>{}};return U}nm.applyToOptions=t=>{const e=bW(t,100,nm);return t.ease=e.ease,t.duration=cr(e.duration),t.type="keyframes",t};function Tv({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:a,min:u,max:c,restDelta:h=.5,restSpeed:p}){const m=t[0],_={done:!1,value:m},T=I=>u!==void 0&&I<u||c!==void 0&&I>c,A=I=>u===void 0?c:c===void 0||Math.abs(u-I)<Math.abs(c-I)?u:c;let b=n*e;const V=m+b,C=a===void 0?V:a(V);C!==V&&(b=C-m);const S=I=>-b*Math.exp(-I/i),R=I=>C+S(I),U=I=>{const N=S(I),O=R(I);_.done=Math.abs(N)<=h,_.value=_.done?C:O};let W,K;const k=I=>{T(_.value)&&(W=I,K=nm({keyframes:[_.value,A(_.value)],velocity:JN(R,I,_.value),damping:r,stiffness:s,restDelta:h,restSpeed:p}))};return k(0),{calculatedDuration:null,next:I=>{let N=!1;return!K&&W===void 0&&(N=!0,U(I),k(I)),W!==void 0&&I>=W?K.next(I-W):(!N&&U(I),_)}}}function FW(t,e,n){const i=[],r=n||Jr.mix||YN,s=t.length-1;for(let a=0;a<s;a++){let u=r(t[a],t[a+1]);if(e){const c=Array.isArray(e)?e[a]||di:e;u=ud(c,u)}i.push(u)}return i}function jW(t,e,{clamp:n=!0,ease:i,mixer:r}={}){const s=t.length;if(wE(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const u=FW(e,i,r),c=u.length,h=p=>{if(a&&p<t[0])return e[0];let m=0;if(c>1)for(;m<t.length-2&&!(p<t[m+1]);m++);const _=Mh(t[m],t[m+1],p);return u[m](_)};return n?p=>h(Xr(t[0],t[s-1],p)):h}function UW(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=Mh(0,e,i);t.push(ut(n,1,r))}}function BW(t){const e=[0];return UW(e,t.length-1),e}function zW(t,e){return t.map(n=>n*e)}function WW(t,e){return t.map(()=>e||BN).splice(0,t.length-1)}function qc({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const r=eW(i)?i.map(QS):QS(i),s={done:!1,value:e[0]},a=zW(n&&n.length===e.length?n:BW(e),t),u=jW(a,e,{ease:Array.isArray(r)?r:WW(e,r)});return{calculatedDuration:t,next:c=>(s.value=u(c),s.done=c>=t,s)}}const HW=t=>t!==null;function kE(t,{repeat:e,repeatType:n="loop"},i,r=1){const s=t.filter(HW),u=r<0||e&&n!=="loop"&&e%2===1?0:s.length-1;return!u||i===void 0?s[u]:i}const $W={decay:Tv,inertia:Tv,tween:qc,keyframes:qc,spring:nm};function eL(t){typeof t.type=="string"&&(t.type=$W[t.type])}class NE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const qW=t=>t/100;class LE extends NE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:n}=this.options;n&&n.updatedAt!==Vn.now()&&this.tick(Vn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;eL(e);const{type:n=qc,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:a=0}=e;let{keyframes:u}=e;const c=n||qc;c!==qc&&typeof u[0]!="number"&&(this.mixKeyframes=ud(qW,YN(u[0],u[1])),u=[0,100]);const h=c({...e,keyframes:u});s==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...u].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=bE(h));const{calculatedDuration:p}=h;this.calculatedDuration=p,this.resolvedDuration=p+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=h}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:u,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:h=0,keyframes:p,repeat:m,repeatType:_,repeatDelay:T,type:A,onUpdate:b,finalKeyframe:V}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const C=this.currentTime-h*(this.playbackSpeed>=0?1:-1),S=this.playbackSpeed>=0?C<0:C>r;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let R=this.currentTime,U=i;if(m){const I=Math.min(this.currentTime,r)/u;let N=Math.floor(I),O=I%1;!O&&I>=1&&(O=1),O===1&&N--,N=Math.min(N,m+1),!!(N%2)&&(_==="reverse"?(O=1-O,T&&(O-=T/u)):_==="mirror"&&(U=a)),R=Xr(0,1,O)*u}const W=S?{done:!1,value:p[0]}:U.next(R);s&&(W.value=s(W.value));let{done:K}=W;!S&&c!==null&&(K=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&K);return k&&A!==Tv&&(W.value=kE(p,this.options,V,this.speed)),b&&b(W.value),k&&this.finish(),W}then(e,n){return this.finished.then(e,n)}get duration(){return li(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+li(e)}get time(){return li(this.currentTime)}set time(e){var n;e=cr(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Vn.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=li(this.currentTime))}play(){var r,s;if(this.isStopped)return;const{driver:e=RW,startTime:n}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(s=(r=this.options).onPlay)==null||s.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Vn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function GW(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Bo=t=>t*180/Math.PI,xv=t=>{const e=Bo(Math.atan2(t[1],t[0]));return Sv(e)},KW={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:xv,rotateZ:xv,skewX:t=>Bo(Math.atan(t[1])),skewY:t=>Bo(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Sv=t=>(t=t%360,t<0&&(t+=360),t),iC=xv,rC=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),sC=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),ZW={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:rC,scaleY:sC,scale:t=>(rC(t)+sC(t))/2,rotateX:t=>Sv(Bo(Math.atan2(t[6],t[5]))),rotateY:t=>Sv(Bo(Math.atan2(-t[2],t[0]))),rotateZ:iC,rotate:iC,skewX:t=>Bo(Math.atan(t[4])),skewY:t=>Bo(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Cv(t){return t.includes("scale")?1:0}function Iv(t,e){if(!t||t==="none")return Cv(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=ZW,r=n;else{const u=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=KW,r=u}if(!r)return Cv(e);const s=i[e],a=r[1].split(",").map(YW);return typeof s=="function"?s(a):a[s]}const QW=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Iv(n,e)};function YW(t){return parseFloat(t.trim())}const _u=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yu=(()=>new Set(_u))(),oC=t=>t===gu||t===me,XW=new Set(["x","y","z"]),JW=_u.filter(t=>!XW.has(t));function e8(t){const e=[];return JW.forEach(n=>{const i=t.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e}const Ko={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Iv(e,"x"),y:(t,{transform:e})=>Iv(e,"y")};Ko.translateX=Ko.x;Ko.translateY=Ko.y;const Zo=new Set;let Pv=!1,Av=!1,Rv=!1;function tL(){if(Av){const t=Array.from(Zo).filter(i=>i.needsMeasurement),e=new Set(t.map(i=>i.element)),n=new Map;e.forEach(i=>{const r=e8(i);r.length&&(n.set(i,r),i.render())}),t.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([s,a])=>{var u;(u=i.getValue(s))==null||u.set(a)})}),t.forEach(i=>i.measureEndState()),t.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Av=!1,Pv=!1,Zo.forEach(t=>t.complete(Rv)),Zo.clear()}function nL(){Zo.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Av=!0)})}function t8(){Rv=!0,nL(),tL(),Rv=!1}class DE{constructor(e,n,i,r,s,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=i,this.motionValue=r,this.element=s,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(Zo.add(this),Pv||(Pv=!0,st.read(nL),st.resolveKeyframes(tL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:i,motionValue:r}=this;if(e[0]===null){const s=r==null?void 0:r.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(i&&n){const u=i.readValue(n,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),r&&s===void 0&&r.set(e[0])}GW(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Zo.delete(this)}cancel(){this.state==="scheduled"&&(Zo.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const n8=t=>t.startsWith("--");function i8(t,e,n){n8(e)?t.style.setProperty(e,n):t.style[e]=n}const r8=EE(()=>window.ScrollTimeline!==void 0),s8={};function o8(t,e){const n=EE(t);return()=>s8[e]??n()}const iL=o8(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Cc=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,aC={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Cc([0,.65,.55,1]),circOut:Cc([.55,0,1,.45]),backIn:Cc([.31,.01,.66,-.59]),backOut:Cc([.33,1.53,.69,.99])};function rL(t,e){if(t)return typeof t=="function"?iL()?XN(t,e):"ease-out":zN(t)?Cc(t):Array.isArray(t)?t.map(n=>rL(n,e)||aC.easeOut):aC[t]}function a8(t,e,n,{delay:i=0,duration:r=300,repeat:s=0,repeatType:a="loop",ease:u="easeOut",times:c}={},h=void 0){const p={[e]:n};c&&(p.offset=c);const m=rL(u,r);Array.isArray(m)&&(p.easing=m);const _={delay:i,duration:r,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return h&&(_.pseudoElement=h),t.animate(p,_)}function sL(t){return typeof t=="function"&&"applyToOptions"in t}function l8({type:t,...e}){return sL(t)&&iL()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class u8 extends NE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:i,keyframes:r,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:u,onComplete:c}=e;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=e,wE(typeof e.type!="string");const h=l8(e);this.animation=a8(n,i,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const p=kE(r,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(p):i8(n,i,p),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,i;const e=((i=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:i.call(n).duration)||0;return li(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+li(e)}get time(){return li(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=cr(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&r8()?(this.animation.timeline=e,di):n(this)}}const oL={anticipate:FN,backInOut:VN,circInOut:UN};function c8(t){return t in oL}function h8(t){typeof t.ease=="string"&&c8(t.ease)&&(t.ease=oL[t.ease])}const lC=10;class d8 extends u8{constructor(e){h8(e),eL(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:i,onComplete:r,element:s,...a}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const u=new LE({...a,autoplay:!1}),c=cr(this.finishedTime??this.time);n.setWithVelocity(u.sample(c-lC).value,u.sample(c).value,lC),u.stop()}}const uC=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(no.test(t)||t==="0")&&!t.startsWith("url("));function f8(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function p8(t,e,n,i){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],a=uC(r,e),u=uC(s,e);return!a||!u?!1:f8(t)||(n==="spring"||sL(n))&&i}function bv(t){t.duration=0,t.type="keyframes"}const m8=new Set(["opacity","clipPath","filter","transform"]),g8=EE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function _8(t){var p;const{motionValue:e,name:n,repeatDelay:i,repeatType:r,damping:s,type:a}=t;if(!(((p=e==null?void 0:e.owner)==null?void 0:p.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=e.owner.getProps();return g8()&&n&&m8.has(n)&&(n!=="transform"||!h)&&!c&&!i&&r!=="mirror"&&s!==0&&a!=="inertia"}const y8=40;class v8 extends NE{constructor({autoplay:e=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:a="loop",keyframes:u,name:c,motionValue:h,element:p,...m}){var A;super(),this.stop=()=>{var b,V;this._animation&&(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)),(V=this.keyframeResolver)==null||V.cancel()},this.createdAt=Vn.now();const _={autoplay:e,delay:n,type:i,repeat:r,repeatDelay:s,repeatType:a,name:c,motionValue:h,element:p,...m},T=(p==null?void 0:p.KeyframeResolver)||DE;this.keyframeResolver=new T(u,(b,V,C)=>this.onKeyframesResolved(b,V,_,!C),c,h,p),(A=this.keyframeResolver)==null||A.scheduleResolve()}onKeyframesResolved(e,n,i,r){this.keyframeResolver=void 0;const{name:s,type:a,velocity:u,delay:c,isHandoff:h,onUpdate:p}=i;this.resolvedAt=Vn.now(),p8(e,s,a,u)||((Jr.instantAnimations||!c)&&(p==null||p(kE(e,i,n))),e[0]=e[e.length-1],bv(i),i.repeat=0);const _={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>y8?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:e},T=!h&&_8(_)?new d8({..._,element:_.motionValue.owner.current}):new LE(_);T.finished.then(()=>this.notifyFinished()).catch(di),this.pendingTimeline&&(this.stopTimeline=T.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=T}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),t8()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const w8=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function E8(t){const e=w8.exec(t);if(!e)return[,];const[,n,i,r]=e;return[`--${n??i}`,r]}function aL(t,e,n=1){const[i,r]=E8(t);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const a=s.trim();return RN(a)?parseFloat(a):a}return IE(r)?aL(r,e,n+1):r}function ME(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const lL=new Set(["width","height","top","left","right","bottom",..._u]),T8={test:t=>t==="auto",parse:t=>t},uL=t=>e=>e.test(t),cL=[gu,me,hr,ms,fW,dW,T8],cC=t=>cL.find(uL(t));function x8(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||kN(t):!0}const S8=new Set(["brightness","contrast","saturate","opacity"]);function C8(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=n.match(PE)||[];if(!i)return t;const r=n.replace(i,"");let s=S8.has(e)?1:0;return i!==n&&(s*=100),e+"("+s+r+")"}const I8=/\b([a-z-]*)\(.*?\)/gu,kv={...no,getAnimatableNone:t=>{const e=t.match(I8);return e?e.map(C8).join(" "):t}},hC={...gu,transform:Math.round},P8={rotate:ms,rotateX:ms,rotateY:ms,rotateZ:ms,scale:vf,scaleX:vf,scaleY:vf,scaleZ:vf,skew:ms,skewX:ms,skewY:ms,distance:me,translateX:me,translateY:me,translateZ:me,x:me,y:me,z:me,perspective:me,transformPerspective:me,opacity:Oh,originX:XS,originY:XS,originZ:me},OE={borderWidth:me,borderTopWidth:me,borderRightWidth:me,borderBottomWidth:me,borderLeftWidth:me,borderRadius:me,radius:me,borderTopLeftRadius:me,borderTopRightRadius:me,borderBottomRightRadius:me,borderBottomLeftRadius:me,width:me,maxWidth:me,height:me,maxHeight:me,top:me,right:me,bottom:me,left:me,padding:me,paddingTop:me,paddingRight:me,paddingBottom:me,paddingLeft:me,margin:me,marginTop:me,marginRight:me,marginBottom:me,marginLeft:me,backgroundPositionX:me,backgroundPositionY:me,...P8,zIndex:hC,fillOpacity:Oh,strokeOpacity:Oh,numOctaves:hC},A8={...OE,color:It,backgroundColor:It,outlineColor:It,fill:It,stroke:It,borderColor:It,borderTopColor:It,borderRightColor:It,borderBottomColor:It,borderLeftColor:It,filter:kv,WebkitFilter:kv},hL=t=>A8[t];function dL(t,e){let n=hL(t);return n!==kv&&(n=no),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const R8=new Set(["auto","none","0"]);function b8(t,e,n){let i=0,r;for(;i<t.length&&!r;){const s=t[i];typeof s=="string"&&!R8.has(s)&&Vh(s).values.length&&(r=t[i]),i++}if(r&&n)for(const s of e)t[s]=dL(n,r)}class k8 extends DE{constructor(e,n,i,r,s){super(e,n,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),IE(h))){const p=aL(h,n.current);p!==void 0&&(e[c]=p),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!lL.has(i)||e.length!==2)return;const[r,s]=e,a=cC(r),u=cC(s);if(a!==u)if(oC(a)&&oC(u))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else Ko[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,i=[];for(let r=0;r<e.length;r++)(e[r]===null||x8(e[r]))&&i.push(r);i.length&&b8(e,i,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ko[i](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var u;const{element:e,name:n,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const r=e.getValue(n);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,a=i[s];i[s]=Ko[n](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([c,h])=>{e.getValue(c).set(h)}),this.resolveNoneKeyframes()}}function N8(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let i=document;e&&(i=e.current);const r=(n==null?void 0:n[t])??i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}const fL=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function L8(t){return bN(t)&&"offsetHeight"in t}const dC=30,D8=t=>!isNaN(parseFloat(t));class M8{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var s;const r=Vn.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Vn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=D8(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new TE);const i=this.events[e].add(n);return e==="change"?()=>{i(),st.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Vn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>dC)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,dC);return NN(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Jl(t,e){return new M8(t,e)}const{schedule:VE,cancel:gq}=WN(queueMicrotask,!1),Si={x:!1,y:!1};function pL(){return Si.x||Si.y}function O8(t){return t==="x"||t==="y"?Si[t]?null:(Si[t]=!0,()=>{Si[t]=!1}):Si.x||Si.y?null:(Si.x=Si.y=!0,()=>{Si.x=Si.y=!1})}function mL(t,e){const n=N8(t),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[n,r,()=>i.abort()]}function fC(t){return!(t.pointerType==="touch"||pL())}function V8(t,e,n={}){const[i,r,s]=mL(t,n),a=u=>{if(!fC(u))return;const{target:c}=u,h=e(c,u);if(typeof h!="function"||!c)return;const p=m=>{fC(m)&&(h(m),c.removeEventListener("pointerleave",p))};c.addEventListener("pointerleave",p,r)};return i.forEach(u=>{u.addEventListener("pointerenter",a,r)}),s}const gL=(t,e)=>e?t===e?!0:gL(t,e.parentElement):!1,FE=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,F8=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function j8(t){return F8.has(t.tagName)||t.tabIndex!==-1}const $f=new WeakSet;function pC(t){return e=>{e.key==="Enter"&&t(e)}}function I_(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const U8=(t,e)=>{const n=t.currentTarget;if(!n)return;const i=pC(()=>{if($f.has(n))return;I_(n,"down");const r=pC(()=>{I_(n,"up")}),s=()=>I_(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",s,e)});n.addEventListener("keydown",i,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),e)};function mC(t){return FE(t)&&!pL()}function B8(t,e,n={}){const[i,r,s]=mL(t,n),a=u=>{const c=u.currentTarget;if(!mC(u))return;$f.add(c);const h=e(c,u),p=(T,A)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",_),$f.has(c)&&$f.delete(c),mC(T)&&typeof h=="function"&&h(T,{success:A})},m=T=>{p(T,c===window||c===document||n.useGlobalTarget||gL(c,T.target))},_=T=>{p(T,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",_,r)};return i.forEach(u=>{(n.useGlobalTarget?window:u).addEventListener("pointerdown",a,r),L8(u)&&(u.addEventListener("focus",h=>U8(h,r)),!j8(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),s}function _L(t){return bN(t)&&"ownerSVGElement"in t}function z8(t){return _L(t)&&t.tagName==="svg"}const mn=t=>!!(t&&t.getVelocity),W8=[...cL,It,no],H8=t=>W8.find(uL(t)),yL=B.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function $8(t=!0){const e=B.useContext(_E);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=e,s=B.useId();B.useEffect(()=>{if(t)return r(s)},[t]);const a=B.useCallback(()=>t&&i&&i(s),[s,i,t]);return!n&&i?[!1,a]:[!0]}const vL=B.createContext({strict:!1}),gC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eu={};for(const t in gC)eu[t]={isEnabled:e=>gC[t].some(n=>!!e[n])};function q8(t){for(const e in t)eu[e]={...eu[e],...t[e]}}const G8=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function im(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||G8.has(t)}let wL=t=>!im(t);function K8(t){typeof t=="function"&&(wL=e=>e.startsWith("on")?!im(e):t(e))}try{K8(require("@emotion/is-prop-valid").default)}catch{}function Z8(t,e,n){const i={};for(const r in t)r==="values"&&typeof t.values=="object"||(wL(r)||n===!0&&im(r)||!e&&!im(r)||t.draggable&&r.startsWith("onDrag"))&&(i[r]=t[r]);return i}const ug=B.createContext({});function cg(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Fh(t){return typeof t=="string"||Array.isArray(t)}const jE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],UE=["initial",...jE];function hg(t){return cg(t.animate)||UE.some(e=>Fh(t[e]))}function EL(t){return!!(hg(t)||t.variants)}function Q8(t,e){if(hg(t)){const{initial:n,animate:i}=t;return{initial:n===!1||Fh(n)?n:void 0,animate:Fh(i)?i:void 0}}return t.inherit!==!1?e:{}}function Y8(t){const{initial:e,animate:n}=Q8(t,B.useContext(ug));return B.useMemo(()=>({initial:e,animate:n}),[_C(e),_C(n)])}function _C(t){return Array.isArray(t)?t.join(" "):t}const jh={};function X8(t){for(const e in t)jh[e]=t[e],CE(e)&&(jh[e].isCSSVariable=!0)}function TL(t,{layout:e,layoutId:n}){return yu.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!jh[t]||t==="opacity")}const J8={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},eH=_u.length;function tH(t,e,n){let i="",r=!0;for(let s=0;s<eH;s++){const a=_u[s],u=t[a];if(u===void 0)continue;let c=!0;if(typeof u=="number"?c=u===(a.startsWith("scale")?1:0):c=parseFloat(u)===0,!c||n){const h=fL(u,OE[a]);if(!c){r=!1;const p=J8[a]||a;i+=`${p}(${h}) `}n&&(e[a]=h)}}return i=i.trim(),n?i=n(e,r?"":i):r&&(i="none"),i}function BE(t,e,n){const{style:i,vars:r,transformOrigin:s}=t;let a=!1,u=!1;for(const c in e){const h=e[c];if(yu.has(c)){a=!0;continue}else if(CE(c)){r[c]=h;continue}else{const p=fL(h,OE[c]);c.startsWith("origin")?(u=!0,s[c]=p):i[c]=p}}if(e.transform||(a||n?i.transform=tH(e,t.transform,n):i.transform&&(i.transform="none")),u){const{originX:c="50%",originY:h="50%",originZ:p=0}=s;i.transformOrigin=`${c} ${h} ${p}`}}const zE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function xL(t,e,n){for(const i in e)!mn(e[i])&&!TL(i,n)&&(t[i]=e[i])}function nH({transformTemplate:t},e){return B.useMemo(()=>{const n=zE();return BE(n,e,t),Object.assign({},n.vars,n.style)},[e])}function iH(t,e){const n=t.style||{},i={};return xL(i,n,t),Object.assign(i,nH(t,e)),i}function rH(t,e){const n={},i=iH(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=i,n}const sH={offset:"stroke-dashoffset",array:"stroke-dasharray"},oH={offset:"strokeDashoffset",array:"strokeDasharray"};function aH(t,e,n=1,i=0,r=!0){t.pathLength=1;const s=r?sH:oH;t[s.offset]=me.transform(-i);const a=me.transform(e),u=me.transform(n);t[s.array]=`${a} ${u}`}function SL(t,{attrX:e,attrY:n,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:a=0,...u},c,h,p){if(BE(t,u,h),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:_}=t;m.transform&&(_.transform=m.transform,delete m.transform),(_.transform||m.transformOrigin)&&(_.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),_.transform&&(_.transformBox=(p==null?void 0:p.transformBox)??"fill-box",delete m.transformBox),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),i!==void 0&&(m.scale=i),r!==void 0&&aH(m,r,s,a,!1)}const CL=()=>({...zE(),attrs:{}}),IL=t=>typeof t=="string"&&t.toLowerCase()==="svg";function lH(t,e,n,i){const r=B.useMemo(()=>{const s=CL();return SL(s,e,IL(i),t.transformTemplate,t.style),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};xL(s,t.style,t),r.style={...s,...r.style}}return r}const uH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function WE(t){return typeof t!="string"||t.includes("-")?!1:!!(uH.indexOf(t)>-1||/[A-Z]/u.test(t))}function cH(t,e,n,{latestValues:i},r,s=!1){const u=(WE(t)?lH:rH)(e,i,r,t),c=Z8(e,typeof t=="string",s),h=t!==B.Fragment?{...c,...u,ref:n}:{},{children:p}=e,m=B.useMemo(()=>mn(p)?p.get():p,[p]);return B.createElement(t,{...h,children:m})}function yC(t){const e=[{},{}];return t==null||t.values.forEach((n,i)=>{e[0][i]=n.get(),e[1][i]=n.getVelocity()}),e}function HE(t,e,n,i){if(typeof e=="function"){const[r,s]=yC(i);e=e(n!==void 0?n:t.custom,r,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,s]=yC(i);e=e(n!==void 0?n:t.custom,r,s)}return e}function qf(t){return mn(t)?t.get():t}function hH({scrapeMotionValuesFromProps:t,createRenderState:e},n,i,r){return{latestValues:dH(n,i,r,t),renderState:e()}}function dH(t,e,n,i){const r={},s=i(t,{});for(const _ in s)r[_]=qf(s[_]);let{initial:a,animate:u}=t;const c=hg(t),h=EL(t);e&&h&&!c&&t.inherit!==!1&&(a===void 0&&(a=e.initial),u===void 0&&(u=e.animate));let p=n?n.initial===!1:!1;p=p||a===!1;const m=p?u:a;if(m&&typeof m!="boolean"&&!cg(m)){const _=Array.isArray(m)?m:[m];for(let T=0;T<_.length;T++){const A=HE(t,_[T]);if(A){const{transitionEnd:b,transition:V,...C}=A;for(const S in C){let R=C[S];if(Array.isArray(R)){const U=p?R.length-1:0;R=R[U]}R!==null&&(r[S]=R)}for(const S in b)r[S]=b[S]}}}return r}const PL=t=>(e,n)=>{const i=B.useContext(ug),r=B.useContext(_E),s=()=>hH(t,e,i,r);return n?s():q9(s)};function $E(t,e,n){var s;const{style:i}=t,r={};for(const a in i)(mn(i[a])||e.style&&mn(e.style[a])||TL(a,t)||((s=n==null?void 0:n.getValue(a))==null?void 0:s.liveStyle)!==void 0)&&(r[a]=i[a]);return r}const fH=PL({scrapeMotionValuesFromProps:$E,createRenderState:zE});function AL(t,e,n){const i=$E(t,e,n);for(const r in t)if(mn(t[r])||mn(e[r])){const s=_u.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=t[r]}return i}const pH=PL({scrapeMotionValuesFromProps:AL,createRenderState:CL}),mH=Symbol.for("motionComponentSymbol");function dl(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function gH(t,e,n){return B.useCallback(i=>{i&&t.onMount&&t.onMount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):dl(n)&&(n.current=i))},[e])}const qE=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),_H="framerAppearId",RL="data-"+qE(_H),bL=B.createContext({});function yH(t,e,n,i,r){var b,V;const{visualElement:s}=B.useContext(ug),a=B.useContext(vL),u=B.useContext(_E),c=B.useContext(yL).reducedMotion,h=B.useRef(null);i=i||a.renderer,!h.current&&i&&(h.current=i(t,{visualState:e,parent:s,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const p=h.current,m=B.useContext(bL);p&&!p.projection&&r&&(p.type==="html"||p.type==="svg")&&vH(h.current,n,r,m);const _=B.useRef(!1);B.useInsertionEffect(()=>{p&&_.current&&p.update(n,u)});const T=n[RL],A=B.useRef(!!T&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,T))&&((V=window.MotionHasOptimisedAnimation)==null?void 0:V.call(window,T)));return G9(()=>{p&&(_.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),A.current&&p.animationState&&p.animationState.animateChanges())}),B.useEffect(()=>{p&&(!A.current&&p.animationState&&p.animationState.animateChanges(),A.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,T)}),A.current=!1),p.enteringChildren=void 0)}),p}function vH(t,e,n,i){const{layoutId:r,layout:s,drag:a,dragConstraints:u,layoutScroll:c,layoutRoot:h,layoutCrossfade:p}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:kL(t.parent)),t.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!a||u&&dl(u),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:p,layoutScroll:c,layoutRoot:h})}function kL(t){if(t)return t.options.allowProjection!==!1?t.projection:kL(t.parent)}function P_(t,{forwardMotionProps:e=!1}={},n,i){n&&q8(n);const r=WE(t)?pH:fH;function s(u,c){let h;const p={...B.useContext(yL),...u,layoutId:wH(u)},{isStatic:m}=p,_=Y8(u),T=r(u,m);if(!m&&gE){EH();const A=TH(p);h=A.MeasureLayout,_.visualElement=yH(t,T,p,i,A.ProjectionNode)}return E.jsxs(ug.Provider,{value:_,children:[h&&_.visualElement?E.jsx(h,{visualElement:_.visualElement,...p}):null,cH(t,u,gH(T,_.visualElement,c),T,m,e)]})}s.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=B.forwardRef(s);return a[mH]=t,a}function wH({layoutId:t}){const e=B.useContext(AN).id;return e&&t!==void 0?e+"-"+t:t}function EH(t,e){B.useContext(vL).strict}function TH(t){const{drag:e,layout:n}=eu;if(!e&&!n)return{};const i={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function xH(t,e){if(typeof Proxy>"u")return P_;const n=new Map,i=(s,a)=>P_(s,a,t,e),r=(s,a)=>i(s,a);return new Proxy(r,{get:(s,a)=>a==="create"?i:(n.has(a)||n.set(a,P_(a,void 0,t,e)),n.get(a))})}function NL({top:t,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:t,max:i}}}function SH({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function CH(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function A_(t){return t===void 0||t===1}function Nv({scale:t,scaleX:e,scaleY:n}){return!A_(t)||!A_(e)||!A_(n)}function Lo(t){return Nv(t)||LL(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function LL(t){return vC(t.x)||vC(t.y)}function vC(t){return t&&t!=="0%"}function rm(t,e,n){const i=t-n,r=e*i;return n+r}function wC(t,e,n,i,r){return r!==void 0&&(t=rm(t,r,i)),rm(t,n,i)+e}function Lv(t,e=0,n=1,i,r){t.min=wC(t.min,e,n,i,r),t.max=wC(t.max,e,n,i,r)}function DL(t,{x:e,y:n}){Lv(t.x,e.translate,e.scale,e.originPoint),Lv(t.y,n.translate,n.scale,n.originPoint)}const EC=.999999999999,TC=1.0000000000001;function IH(t,e,n,i=!1){const r=n.length;if(!r)return;e.x=e.y=1;let s,a;for(let u=0;u<r;u++){s=n[u],a=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&pl(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,DL(t,a)),i&&Lo(s.latestValues)&&pl(t,s.latestValues))}e.x<TC&&e.x>EC&&(e.x=1),e.y<TC&&e.y>EC&&(e.y=1)}function fl(t,e){t.min=t.min+e,t.max=t.max+e}function xC(t,e,n,i,r=.5){const s=ut(t.min,t.max,r);Lv(t,e,n,s,i)}function pl(t,e){xC(t.x,e.x,e.scaleX,e.scale,e.originX),xC(t.y,e.y,e.scaleY,e.scale,e.originY)}function ML(t,e){return NL(CH(t.getBoundingClientRect(),e))}function PH(t,e,n){const i=ML(t,n),{scroll:r}=e;return r&&(fl(i.x,r.offset.x),fl(i.y,r.offset.y)),i}const SC=()=>({translate:0,scale:1,origin:0,originPoint:0}),ml=()=>({x:SC(),y:SC()}),CC=()=>({min:0,max:0}),_t=()=>({x:CC(),y:CC()}),Dv={current:null},OL={current:!1};function AH(){if(OL.current=!0,!!gE)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Dv.current=t.matches;t.addEventListener("change",e),e()}else Dv.current=!1}const RH=new WeakMap;function bH(t,e,n){for(const i in e){const r=e[i],s=n[i];if(mn(r))t.addValue(i,r);else if(mn(s))t.addValue(i,Jl(r,{owner:t}));else if(s!==r)if(t.hasValue(i)){const a=t.getValue(i);a.liveStyle===!0?a.jump(r):a.hasAnimated||a.set(r)}else{const a=t.getStaticValue(i);t.addValue(i,Jl(a!==void 0?a:r,{owner:t}))}}for(const i in n)e[i]===void 0&&t.removeValue(i);return e}const IC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kH{scrapeMotionValuesFromProps(e,n,i){return{}}constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:a},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=DE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const _=Vn.now();this.renderScheduledAt<_&&(this.renderScheduledAt=_,st.render(this.render,!1,!0))};const{latestValues:c,renderState:h}=a;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=u,this.blockInitialAnimation=!!s,this.isControllingVariants=hg(n),this.isVariantNode=EL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...m}=this.scrapeMotionValuesFromProps(n,{},this);for(const _ in m){const T=m[_];c[_]!==void 0&&mn(T)&&T.set(c[_])}}mount(e){var n;this.current=e,RH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),OL.current||AH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Dv.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),to(this.notifyUpdate),to(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const i=this.features[n];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=yu.has(e);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&st.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),s&&s(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in eu){const n=eu[e];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):_t()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<IC.length;i++){const r=IC[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,a=e[s];a&&(this.propEventSubscriptions[r]=this.on(r,a))}this.prevMotionValues=bH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const i=this.values.get(e);n!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=Jl(n===null?void 0:n,{owner:this}),this.addValue(e,i)),i}readValue(e,n){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(RN(i)||kN(i))?i=parseFloat(i):!H8(i)&&no.test(n)&&(i=dL(e,n)),this.setBaseTarget(e,mn(i)?i.get():i)),mn(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=HE(this.props,n,(s=this.presenceContext)==null?void 0:s.custom);a&&(i=a[e])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!mn(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new TE),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){VE.render(this.render)}}class VL extends kH{constructor(){super(...arguments),this.KeyframeResolver=k8}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;mn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function FL(t,{style:e,vars:n},i,r){const s=t.style;let a;for(a in e)s[a]=e[a];r==null||r.applyProjectionStyles(s,i);for(a in n)s.setProperty(a,n[a])}function NH(t){return window.getComputedStyle(t)}class LH extends VL{constructor(){super(...arguments),this.type="html",this.renderInstance=FL}readValueFromInstance(e,n){var i;if(yu.has(n))return(i=this.projection)!=null&&i.isProjecting?Cv(n):QW(e,n);{const r=NH(e),s=(CE(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return ML(e,n)}build(e,n,i){BE(e,n,i.transformTemplate)}scrapeMotionValuesFromProps(e,n,i){return $E(e,n,i)}}const jL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function DH(t,e,n,i){FL(t,e,void 0,i);for(const r in e.attrs)t.setAttribute(jL.has(r)?r:qE(r),e.attrs[r])}class MH extends VL{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=_t}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(yu.has(n)){const i=hL(n);return i&&i.default||0}return n=jL.has(n)?n:qE(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,i){return AL(e,n,i)}build(e,n,i){SL(e,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,n,i,r){DH(e,n,i,r)}mount(e){this.isSVGTag=IL(e.tagName),super.mount(e)}}const OH=(t,e)=>WE(t)?new MH(e):new LH(e,{allowProjection:t!==B.Fragment});function kl(t,e,n){const i=t.getProps();return HE(i,e,n!==void 0?n:i.custom,t)}const Mv=t=>Array.isArray(t);function VH(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Jl(n))}function FH(t){return Mv(t)?t[t.length-1]||0:t}function jH(t,e){const n=kl(t,e);let{transitionEnd:i={},transition:r={},...s}=n||{};s={...s,...i};for(const a in s){const u=FH(s[a]);VH(t,a,u)}}function UH(t){return!!(mn(t)&&t.add)}function Ov(t,e){const n=t.getValue("willChange");if(UH(n))return n.add(e);if(!n&&Jr.WillChange){const i=new Jr.WillChange("auto");t.addValue("willChange",i),i.add(e)}}function UL(t){return t.props[RL]}const BH=t=>t!==null;function zH(t,{repeat:e,repeatType:n="loop"},i){const r=t.filter(BH),s=e&&n!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const WH={type:"spring",stiffness:500,damping:25,restSpeed:10},HH=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),$H={type:"keyframes",duration:.8},qH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},GH=(t,{keyframes:e})=>e.length>2?$H:yu.has(t)?t.startsWith("scale")?HH(e[1]):WH:qH;function KH({when:t,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:a,repeatDelay:u,from:c,elapsed:h,...p}){return!!Object.keys(p).length}const GE=(t,e,n,i={},r,s)=>a=>{const u=ME(i,t)||{},c=u.delay||i.delay||0;let{elapsed:h=0}=i;h=h-cr(c);const p={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...u,delay:-h,onUpdate:_=>{e.set(_),u.onUpdate&&u.onUpdate(_)},onComplete:()=>{a(),u.onComplete&&u.onComplete()},name:t,motionValue:e,element:s?void 0:r};KH(u)||Object.assign(p,GH(t,p)),p.duration&&(p.duration=cr(p.duration)),p.repeatDelay&&(p.repeatDelay=cr(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let m=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(bv(p),p.delay===0&&(m=!0)),(Jr.instantAnimations||Jr.skipAnimations)&&(m=!0,bv(p),p.delay=0),p.allowFlatten=!u.type&&!u.ease,m&&!s&&e.get()!==void 0){const _=zH(p.keyframes,u);if(_!==void 0){st.update(()=>{p.onUpdate(_),p.onComplete()});return}}return u.isSync?new LE(p):new v8(p)};function ZH({protectedKeys:t,needsAnimating:e},n){const i=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function BL(t,e,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:a,...u}=e;i&&(s=i);const c=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const p in u){const m=t.getValue(p,t.latestValues[p]??null),_=u[p];if(_===void 0||h&&ZH(h,p))continue;const T={delay:n,...ME(s||{},p)},A=m.get();if(A!==void 0&&!m.isAnimating&&!Array.isArray(_)&&_===A&&!T.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const C=UL(t);if(C){const S=window.MotionHandoffAnimation(C,p,st);S!==null&&(T.startTime=S,b=!0)}}Ov(t,p),m.start(GE(p,m,_,t.shouldReduceMotion&&lL.has(p)?{type:!1}:T,t,b));const V=m.animation;V&&c.push(V)}return a&&Promise.all(c).then(()=>{st.update(()=>{a&&jH(t,a)})}),c}function zL(t,e,n,i=0,r=1){const s=Array.from(t).sort((h,p)=>h.sortNodePosition(p)).indexOf(e),a=t.size,u=(a-1)*i;return typeof n=="function"?n(s,a):r===1?s*i:u-s*i}function Vv(t,e,n={}){var c;const i=kl(t,e,n.type==="exit"?(c=t.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(BL(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(h=0)=>{const{delayChildren:p=0,staggerChildren:m,staggerDirection:_}=r;return QH(t,e,h,p,m,_,n)}:()=>Promise.resolve(),{when:u}=r;if(u){const[h,p]=u==="beforeChildren"?[s,a]:[a,s];return h().then(()=>p())}else return Promise.all([s(),a(n.delay)])}function QH(t,e,n=0,i=0,r=0,s=1,a){const u=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),u.push(Vv(c,e,{...a,delay:n+(typeof i=="function"?0:i)+zL(t.variantChildren,c,i,r,s)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(u)}function YH(t,e,n={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>Vv(t,s,n));i=Promise.all(r)}else if(typeof e=="string")i=Vv(t,e,n);else{const r=typeof e=="function"?kl(t,e,n.custom):e;i=Promise.all(BL(t,r,n))}return i.then(()=>{t.notify("AnimationComplete",e)})}function WL(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}const XH=UE.length;function HL(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?HL(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<XH;n++){const i=UE[n],r=t.props[i];(Fh(r)||r===!1)&&(e[i]=r)}return e}const JH=[...jE].reverse(),e$=jE.length;function t$(t){return e=>Promise.all(e.map(({animation:n,options:i})=>YH(t,n,i)))}function n$(t){let e=t$(t),n=PC(),i=!0;const r=c=>(h,p)=>{var _;const m=kl(t,p,c==="exit"?(_=t.presenceContext)==null?void 0:_.custom:void 0);if(m){const{transition:T,transitionEnd:A,...b}=m;h={...h,...b,...A}}return h};function s(c){e=c(t)}function a(c){const{props:h}=t,p=HL(t.parent)||{},m=[],_=new Set;let T={},A=1/0;for(let V=0;V<e$;V++){const C=JH[V],S=n[C],R=h[C]!==void 0?h[C]:p[C],U=Fh(R),W=C===c?S.isActive:null;W===!1&&(A=V);let K=R===p[C]&&R!==h[C]&&U;if(K&&i&&t.manuallyAnimateOnMount&&(K=!1),S.protectedKeys={...T},!S.isActive&&W===null||!R&&!S.prevProp||cg(R)||typeof R=="boolean")continue;const k=i$(S.prevProp,R);let I=k||C===c&&S.isActive&&!K&&U||V>A&&U,N=!1;const O=Array.isArray(R)?R:[R];let M=O.reduce(r(C),{});W===!1&&(M={});const{prevResolvedValues:j={}}=S,D={...j,...M},xe=he=>{I=!0,_.has(he)&&(N=!0,_.delete(he)),S.needsAnimating[he]=!0;const q=t.getValue(he);q&&(q.liveStyle=!1)};for(const he in D){const q=M[he],re=j[he];if(T.hasOwnProperty(he))continue;let X=!1;Mv(q)&&Mv(re)?X=!WL(q,re):X=q!==re,X?q!=null?xe(he):_.add(he):q!==void 0&&_.has(he)?xe(he):S.protectedKeys[he]=!0}S.prevProp=R,S.prevResolvedValues=M,S.isActive&&(T={...T,...M}),i&&t.blockInitialAnimation&&(I=!1);const Nt=K&&k;I&&(!Nt||N)&&m.push(...O.map(he=>{const q={type:C};if(typeof he=="string"&&i&&!Nt&&t.manuallyAnimateOnMount&&t.parent){const{parent:re}=t,X=kl(re,he);if(re.enteringChildren&&X){const{delayChildren:le}=X.transition||{};q.delay=zL(re.enteringChildren,t,le)}}return{animation:he,options:q}}))}if(_.size){const V={};if(typeof h.initial!="boolean"){const C=kl(t,Array.isArray(h.initial)?h.initial[0]:h.initial);C&&C.transition&&(V.transition=C.transition)}_.forEach(C=>{const S=t.getBaseTarget(C),R=t.getValue(C);R&&(R.liveStyle=!0),V[C]=S??null}),m.push({animation:V})}let b=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!t.manuallyAnimateOnMount&&(b=!1),i=!1,b?e(m):Promise.resolve()}function u(c,h){var m;if(n[c].isActive===h)return Promise.resolve();(m=t.variantChildren)==null||m.forEach(_=>{var T;return(T=_.animationState)==null?void 0:T.setActive(c,h)}),n[c].isActive=h;const p=a(c);for(const _ in n)n[_].protectedKeys={};return p}return{animateChanges:a,setActive:u,setAnimateFunction:s,getState:()=>n,reset:()=>{n=PC()}}}function i$(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!WL(e,t):!1}function Po(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PC(){return{animate:Po(!0),whileInView:Po(),whileHover:Po(),whileTap:Po(),whileDrag:Po(),whileFocus:Po(),exit:Po()}}class fo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class r$ extends fo{constructor(e){super(e),e.animationState||(e.animationState=n$(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();cg(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let s$=0;class o$ extends fo{constructor(){super(...arguments),this.id=s$++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const a$={animation:{Feature:r$},exit:{Feature:o$}};function Uh(t,e,n,i={passive:!0}){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n)}function dd(t){return{point:{x:t.pageX,y:t.pageY}}}const l$=t=>e=>FE(e)&&t(e,dd(e));function Gc(t,e,n,i){return Uh(t,e,l$(n),i)}const $L=1e-4,u$=1-$L,c$=1+$L,qL=.01,h$=0-qL,d$=0+qL;function Tn(t){return t.max-t.min}function f$(t,e,n){return Math.abs(t-e)<=n}function AC(t,e,n,i=.5){t.origin=i,t.originPoint=ut(e.min,e.max,t.origin),t.scale=Tn(n)/Tn(e),t.translate=ut(n.min,n.max,t.origin)-t.originPoint,(t.scale>=u$&&t.scale<=c$||isNaN(t.scale))&&(t.scale=1),(t.translate>=h$&&t.translate<=d$||isNaN(t.translate))&&(t.translate=0)}function Kc(t,e,n,i){AC(t.x,e.x,n.x,i?i.originX:void 0),AC(t.y,e.y,n.y,i?i.originY:void 0)}function RC(t,e,n){t.min=n.min+e.min,t.max=t.min+Tn(e)}function p$(t,e,n){RC(t.x,e.x,n.x),RC(t.y,e.y,n.y)}function bC(t,e,n){t.min=e.min-n.min,t.max=t.min+Tn(e)}function Zc(t,e,n){bC(t.x,e.x,n.x),bC(t.y,e.y,n.y)}function ti(t){return[t("x"),t("y")]}const GL=({current:t})=>t?t.ownerDocument.defaultView:null,kC=(t,e)=>Math.abs(t-e);function m$(t,e){const n=kC(t.x,e.x),i=kC(t.y,e.y);return Math.sqrt(n**2+i**2)}class KL{constructor(e,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=b_(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,A=m$(_.offset,{x:0,y:0})>=this.distanceThreshold;if(!T&&!A)return;const{point:b}=_,{timestamp:V}=en;this.history.push({...b,timestamp:V});const{onStart:C,onMove:S}=this.handlers;T||(C&&C(this.lastMoveEvent,_),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,_)},this.handlePointerMove=(_,T)=>{this.lastMoveEvent=_,this.lastMoveEventInfo=R_(T,this.transformPagePoint),st.update(this.updatePoint,!0)},this.handlePointerUp=(_,T)=>{this.end();const{onEnd:A,onSessionEnd:b,resumeAnimation:V}=this.handlers;if(this.dragSnapToOrigin&&V&&V(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=b_(_.type==="pointercancel"?this.lastMoveEventInfo:R_(T,this.transformPagePoint),this.history);this.startEvent&&A&&A(_,C),b&&b(_,C)},!FE(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=a,this.contextWindow=r||window;const u=dd(e),c=R_(u,this.transformPagePoint),{point:h}=c,{timestamp:p}=en;this.history=[{...h,timestamp:p}];const{onSessionStart:m}=n;m&&m(e,b_(c,this.history)),this.removeListeners=ud(Gc(this.contextWindow,"pointermove",this.handlePointerMove),Gc(this.contextWindow,"pointerup",this.handlePointerUp),Gc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),to(this.updatePoint)}}function R_(t,e){return e?{point:e(t.point)}:t}function NC(t,e){return{x:t.x-e.x,y:t.y-e.y}}function b_({point:t},e){return{point:t,delta:NC(t,ZL(e)),offset:NC(t,g$(e)),velocity:_$(e,.1)}}function g$(t){return t[0]}function ZL(t){return t[t.length-1]}function _$(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=ZL(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>cr(e)));)n--;if(!i)return{x:0,y:0};const s=li(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const a={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function y$(t,{min:e,max:n},i){return e!==void 0&&t<e?t=i?ut(e,t,i.min):Math.max(t,e):n!==void 0&&t>n&&(t=i?ut(n,t,i.max):Math.min(t,n)),t}function LC(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function v$(t,{top:e,left:n,bottom:i,right:r}){return{x:LC(t.x,n,r),y:LC(t.y,e,i)}}function DC(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function w$(t,e){return{x:DC(t.x,e.x),y:DC(t.y,e.y)}}function E$(t,e){let n=.5;const i=Tn(t),r=Tn(e);return r>i?n=Mh(e.min,e.max-i,t.min):i>r&&(n=Mh(t.min,t.max-r,e.min)),Xr(0,1,n)}function T$(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Fv=.35;function x$(t=Fv){return t===!1?t=0:t===!0&&(t=Fv),{x:MC(t,"left","right"),y:MC(t,"top","bottom")}}function MC(t,e,n){return{min:OC(t,e),max:OC(t,n)}}function OC(t,e){return typeof t=="number"?t:t[e]||0}const S$=new WeakMap;class C${constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=_t(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=m=>{const{dragSnapToOrigin:_}=this.getProps();_?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(dd(m).point)},a=(m,_)=>{const{drag:T,dragPropagation:A,onDragStart:b}=this.getProps();if(T&&!A&&(this.openDragLock&&this.openDragLock(),this.openDragLock=O8(T),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=_,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ti(C=>{let S=this.getAxisMotionValue(C).get()||0;if(hr.test(S)){const{projection:R}=this.visualElement;if(R&&R.layout){const U=R.layout.layoutBox[C];U&&(S=Tn(U)*(parseFloat(S)/100))}}this.originPoint[C]=S}),b&&st.postRender(()=>b(m,_)),Ov(this.visualElement,"transform");const{animationState:V}=this.visualElement;V&&V.setActive("whileDrag",!0)},u=(m,_)=>{this.latestPointerEvent=m,this.latestPanInfo=_;const{dragPropagation:T,dragDirectionLock:A,onDirectionLock:b,onDrag:V}=this.getProps();if(!T&&!this.openDragLock)return;const{offset:C}=_;if(A&&this.currentDirection===null){this.currentDirection=I$(C),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",_.point,C),this.updateAxis("y",_.point,C),this.visualElement.render(),V&&V(m,_)},c=(m,_)=>{this.latestPointerEvent=m,this.latestPanInfo=_,this.stop(m,_),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>ti(m=>{var _;return this.getAnimationState(m)==="paused"&&((_=this.getAxisMotionValue(m).animation)==null?void 0:_.play())}),{dragSnapToOrigin:p}=this.getProps();this.panSession=new KL(e,{onSessionStart:s,onStart:a,onMove:u,onSessionEnd:c,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:i,contextWindow:GL(this.visualElement)})}stop(e,n){const i=e||this.latestPointerEvent,r=n||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:u}=this.getProps();u&&st.postRender(()=>u(i,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:r}=this.getProps();if(!i||!wf(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(a=y$(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,r=this.constraints;e&&dl(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=v$(i.layoutBox,e):this.constraints=!1,this.elastic=x$(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ti(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=T$(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!dl(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=PH(i,r.root,this.visualElement.getTransformPagePoint());let a=w$(r.layout.layoutBox,s);if(n){const u=n(SH(a));this.hasMutatedConstraints=!!u,u&&(a=NL(u))}return a}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:u}=this.getProps(),c=this.constraints||{},h=ti(p=>{if(!wf(p,n,this.currentDirection))return;let m=c&&c[p]||{};a&&(m={min:0,max:0});const _=r?200:1e6,T=r?40:1e7,A={type:"inertia",velocity:i?e[p]:0,bounceStiffness:_,bounceDamping:T,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(p,A)});return Promise.all(h).then(u)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return Ov(this.visualElement,e),i.start(GE(e,i,0,n,this.visualElement,!1))}stopAnimation(){ti(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ti(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){ti(n=>{const{drag:i}=this.getProps();if(!wf(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:a,max:u}=r.layout.layoutBox[n];s.set(e[n]-ut(a,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!dl(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};ti(a=>{const u=this.getAxisMotionValue(a);if(u&&this.constraints!==!1){const c=u.get();r[a]=E$({min:c,max:c},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),ti(a=>{if(!wf(a,e,null))return;const u=this.getAxisMotionValue(a),{min:c,max:h}=this.constraints[a];u.set(ut(c,h,r[a]))})}addListeners(){if(!this.visualElement.current)return;S$.set(this.visualElement,this);const e=this.visualElement.current,n=Gc(e,"pointerdown",c=>{const{drag:h,dragListener:p=!0}=this.getProps();h&&p&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();dl(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),st.read(i);const a=Uh(window,"resize",()=>this.scalePositionWithinConstraints()),u=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(ti(p=>{const m=this.getAxisMotionValue(p);m&&(this.originPoint[p]+=c[p].translate,m.set(m.get()+c[p].translate))}),this.visualElement.render())});return()=>{a(),n(),s(),u&&u()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:a=Fv,dragMomentum:u=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:a,dragMomentum:u}}}function wf(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function I$(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class P$ extends fo{constructor(e){super(e),this.removeGroupControls=di,this.removeListeners=di,this.controls=new C$(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||di}unmount(){this.removeGroupControls(),this.removeListeners()}}const VC=t=>(e,n)=>{t&&st.postRender(()=>t(e,n))};class A$ extends fo{constructor(){super(...arguments),this.removePointerDownListener=di}onPointerDown(e){this.session=new KL(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:GL(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:VC(e),onStart:VC(n),onMove:i,onEnd:(s,a)=>{delete this.session,r&&st.postRender(()=>r(s,a))}}}mount(){this.removePointerDownListener=Gc(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Gf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function FC(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const hc={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(me.test(t))t=parseFloat(t);else return t;const n=FC(t,e.target.x),i=FC(t,e.target.y);return`${n}% ${i}%`}},R$={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,r=no.parse(t);if(r.length>5)return i;const s=no.createTransformer(t),a=typeof r[0]!="number"?1:0,u=n.x.scale*e.x,c=n.y.scale*e.y;r[0+a]/=u,r[1+a]/=c;const h=ut(u,c,.5);return typeof r[2+a]=="number"&&(r[2+a]/=h),typeof r[3+a]=="number"&&(r[3+a]/=h),s(r)}};let k_=!1;class b$ extends B.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;X8(k$),s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),k_&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Gf.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,{projection:a}=i;return a&&(a.isPresent=s,k_=!0,r||e.layoutDependency!==n||n===void 0||e.isPresent!==s?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||st.postRender(()=>{const u=a.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),VE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=e;k_=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function QL(t){const[e,n]=$8(),i=B.useContext(AN);return E.jsx(b$,{...t,layoutGroup:i,switchLayoutGroup:B.useContext(bL),isPresent:e,safeToRemove:n})}const k$={borderRadius:{...hc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hc,borderTopRightRadius:hc,borderBottomLeftRadius:hc,borderBottomRightRadius:hc,boxShadow:R$};function N$(t,e,n){const i=mn(t)?t:Jl(t);return i.start(GE("",i,e,n)),i.animation}const L$=(t,e)=>t.depth-e.depth;class D${constructor(){this.children=[],this.isDirty=!1}add(e){yE(this.children,e),this.isDirty=!0}remove(e){vE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(L$),this.isDirty=!1,this.children.forEach(e)}}function M$(t,e){const n=Vn.now(),i=({timestamp:r})=>{const s=r-n;s>=e&&(to(i),t(s-e))};return st.setup(i,!0),()=>to(i)}const YL=["TopLeft","TopRight","BottomLeft","BottomRight"],O$=YL.length,jC=t=>typeof t=="string"?parseFloat(t):t,UC=t=>typeof t=="number"||me.test(t);function V$(t,e,n,i,r,s){r?(t.opacity=ut(0,n.opacity??1,F$(i)),t.opacityExit=ut(e.opacity??1,0,j$(i))):s&&(t.opacity=ut(e.opacity??1,n.opacity??1,i));for(let a=0;a<O$;a++){const u=`border${YL[a]}Radius`;let c=BC(e,u),h=BC(n,u);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||UC(c)===UC(h)?(t[u]=Math.max(ut(jC(c),jC(h),i),0),(hr.test(h)||hr.test(c))&&(t[u]+="%")):t[u]=h}(e.rotate||n.rotate)&&(t.rotate=ut(e.rotate||0,n.rotate||0,i))}function BC(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const F$=XL(0,.5,jN),j$=XL(.5,.95,di);function XL(t,e,n){return i=>i<t?0:i>e?1:n(Mh(t,e,i))}function zC(t,e){t.min=e.min,t.max=e.max}function ei(t,e){zC(t.x,e.x),zC(t.y,e.y)}function WC(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function HC(t,e,n,i,r){return t-=e,t=rm(t,1/n,i),r!==void 0&&(t=rm(t,1/r,i)),t}function U$(t,e=0,n=1,i=.5,r,s=t,a=t){if(hr.test(e)&&(e=parseFloat(e),e=ut(a.min,a.max,e/100)-a.min),typeof e!="number")return;let u=ut(s.min,s.max,i);t===s&&(u-=e),t.min=HC(t.min,e,n,u,r),t.max=HC(t.max,e,n,u,r)}function $C(t,e,[n,i,r],s,a){U$(t,e[n],e[i],e[r],e.scale,s,a)}const B$=["x","scaleX","originX"],z$=["y","scaleY","originY"];function qC(t,e,n,i){$C(t.x,e,B$,n?n.x:void 0,i?i.x:void 0),$C(t.y,e,z$,n?n.y:void 0,i?i.y:void 0)}function GC(t){return t.translate===0&&t.scale===1}function JL(t){return GC(t.x)&&GC(t.y)}function KC(t,e){return t.min===e.min&&t.max===e.max}function W$(t,e){return KC(t.x,e.x)&&KC(t.y,e.y)}function ZC(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function eD(t,e){return ZC(t.x,e.x)&&ZC(t.y,e.y)}function QC(t){return Tn(t.x)/Tn(t.y)}function YC(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class H${constructor(){this.members=[]}add(e){yE(this.members,e),e.scheduleRender()}remove(e){if(vE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function $$(t,e,n){let i="";const r=t.x.translate/e.x,s=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((r||s||a)&&(i=`translate3d(${r}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:h,rotate:p,rotateX:m,rotateY:_,skewX:T,skewY:A}=n;h&&(i=`perspective(${h}px) ${i}`),p&&(i+=`rotate(${p}deg) `),m&&(i+=`rotateX(${m}deg) `),_&&(i+=`rotateY(${_}deg) `),T&&(i+=`skewX(${T}deg) `),A&&(i+=`skewY(${A}deg) `)}const u=t.x.scale*e.x,c=t.y.scale*e.y;return(u!==1||c!==1)&&(i+=`scale(${u}, ${c})`),i||"none"}const N_=["","X","Y","Z"],q$=1e3;let G$=0;function L_(t,e,n,i){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),i&&(i[t]=0))}function tD(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=UL(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",st,!(r||s))}const{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&tD(i)}function nD({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(a={},u=e==null?void 0:e()){this.id=G$++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Q$),this.nodes.forEach(e7),this.nodes.forEach(t7),this.nodes.forEach(Y$)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new D$)}addEventListener(a,u){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new TE),this.eventHandlers.get(a).add(u)}notifyListeners(a,...u){const c=this.eventHandlers.get(a);c&&c.notify(...u)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=_L(a)&&!z8(a),this.instance=a;const{layoutId:u,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||u)&&(this.isLayoutDirty=!0),t){let p,m=0;const _=()=>this.root.updateBlockedByResize=!1;st.read(()=>{m=window.innerWidth}),t(a,()=>{const T=window.innerWidth;T!==m&&(m=T,this.root.updateBlockedByResize=!0,p&&p(),p=M$(_,250),Gf.hasAnimatedSinceResize&&(Gf.hasAnimatedSinceResize=!1,this.nodes.forEach(eI)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||c)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:m,hasRelativeLayoutChanged:_,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const A=this.options.transition||h.getDefaultTransition()||o7,{onLayoutAnimationStart:b,onLayoutAnimationComplete:V}=h.getProps(),C=!this.targetLayout||!eD(this.targetLayout,T),S=!m&&_;if(this.options.layoutRoot||this.resumeFrom||S||m&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...ME(A,"layout"),onPlay:b,onComplete:V};(h.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(p,S)}else m||eI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),to(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(n7),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&tD(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const m=this.path[p];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:u,layout:c}=this.options;if(u===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(XC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(JC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(J$),this.nodes.forEach(K$),this.nodes.forEach(Z$)):this.nodes.forEach(JC),this.clearAllSnapshots();const u=Vn.now();en.delta=Xr(0,1e3/60,u-en.timestamp),en.timestamp=u,en.isProcessing=!0,E_.update.process(en),E_.preRender.process(en),E_.render.process(en),en.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,VE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(X$),this.sharedNodes.forEach(i7)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,st.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){st.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Tn(this.snapshot.measuredBox.x)&&!Tn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=_t(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(u=!1),u&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!JL(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,p=h!==this.prevTransformTemplateValue;a&&this.instance&&(u||Lo(this.latestValues)||p)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const u=this.measurePageBox();let c=this.removeElementScroll(u);return a&&(c=this.removeTransform(c)),a7(c),{animationId:this.root.animationId,measuredBox:u,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:a}=this.options;if(!a)return _t();const u=a.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(l7))){const{scroll:p}=this.root;p&&(fl(u.x,p.offset.x),fl(u.y,p.offset.y))}return u}removeElementScroll(a){var c;const u=_t();if(ei(u,a),(c=this.scroll)!=null&&c.wasRoot)return u;for(let h=0;h<this.path.length;h++){const p=this.path[h],{scroll:m,options:_}=p;p!==this.root&&m&&_.layoutScroll&&(m.wasRoot&&ei(u,a),fl(u.x,m.offset.x),fl(u.y,m.offset.y))}return u}applyTransform(a,u=!1){const c=_t();ei(c,a);for(let h=0;h<this.path.length;h++){const p=this.path[h];!u&&p.options.layoutScroll&&p.scroll&&p!==p.root&&pl(c,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),Lo(p.latestValues)&&pl(c,p.latestValues)}return Lo(this.latestValues)&&pl(c,this.latestValues),c}removeTransform(a){const u=_t();ei(u,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Lo(h.latestValues))continue;Nv(h.latestValues)&&h.updateSnapshot();const p=_t(),m=h.measurePageBox();ei(p,m),qC(u,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,p)}return Lo(this.latestValues)&&qC(u,this.latestValues),u}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==en.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var _;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==u;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(_=this.parent)!=null&&_.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:m}=this.options;if(!(!this.layout||!(p||m))){if(this.resolvedRelativeTargetAt=en.timestamp,!this.targetDelta&&!this.relativeTarget){const T=this.getClosestProjectingParent();T&&T.layout&&this.animationProgress!==1?(this.relativeParent=T,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_t(),this.relativeTargetOrigin=_t(),Zc(this.relativeTargetOrigin,this.layout.layoutBox,T.layout.layoutBox),ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=_t(),this.targetWithTransforms=_t()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),p$(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ei(this.target,this.layout.layoutBox),DL(this.target,this.targetDelta)):ei(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const T=this.getClosestProjectingParent();T&&!!T.resumingFrom==!!this.resumingFrom&&!T.options.layoutScroll&&T.target&&this.animationProgress!==1?(this.relativeParent=T,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_t(),this.relativeTargetOrigin=_t(),Zc(this.relativeTargetOrigin,this.target,T.target),ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Nv(this.parent.latestValues)||LL(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var A;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||(A=this.parent)!=null&&A.isProjectionDirty)&&(c=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===en.timestamp&&(c=!1),c)return;const{layout:h,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||p))return;ei(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,_=this.treeScale.y;IH(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=_t());const{target:T}=a;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(WC(this.prevProjectionDelta.x,this.projectionDelta.x),WC(this.prevProjectionDelta.y,this.projectionDelta.y)),Kc(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==_||!YC(this.projectionDelta.x,this.prevProjectionDelta.x)||!YC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ml(),this.projectionDelta=ml(),this.projectionDeltaWithTransform=ml()}setAnimationOrigin(a,u=!1){const c=this.snapshot,h=c?c.latestValues:{},p={...this.latestValues},m=ml();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const _=_t(),T=c?c.source:void 0,A=this.layout?this.layout.source:void 0,b=T!==A,V=this.getStack(),C=!V||V.members.length<=1,S=!!(b&&!C&&this.options.crossfade===!0&&!this.path.some(s7));this.animationProgress=0;let R;this.mixTargetDelta=U=>{const W=U/1e3;tI(m.x,a.x,W),tI(m.y,a.y,W),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Zc(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),r7(this.relativeTarget,this.relativeTargetOrigin,_,W),R&&W$(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=_t()),ei(R,this.relativeTarget)),b&&(this.animationValues=p,V$(p,h,this.latestValues,W,S,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=W},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var u,c,h;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(h=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||h.stop(),this.pendingAnimation&&(to(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=st.update(()=>{Gf.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Jl(0)),this.currentAnimation=N$(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),a.onUpdate&&a.onUpdate(p)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(q$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:u,target:c,layout:h,latestValues:p}=a;if(!(!u||!c||!h)){if(this!==a&&this.layout&&h&&iD(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||_t();const m=Tn(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+m;const _=Tn(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+_}ei(u,c),pl(u,p),Kc(this.projectionDeltaWithTransform,this.layoutCorrected,u,p)}}registerSharedNode(a,u){this.sharedNodes.has(a)||this.sharedNodes.set(a,new H$),this.sharedNodes.get(a).add(u);const h=u.options.initialPromotionConfig;u.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(u):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var u;const{layoutId:a}=this.options;return a?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:a}=this.options;return a?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:u,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let u=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(u=!0),!u)return;const h={};c.z&&L_("z",a,h,this.animationValues);for(let p=0;p<N_.length;p++)L_(`rotate${N_[p]}`,a,h,this.animationValues),L_(`skew${N_[p]}`,a,h,this.animationValues);a.render();for(const p in h)a.setStaticValue(p,h[p]),this.animationValues&&(this.animationValues[p]=h[p]);a.scheduleRender()}applyProjectionStyles(a,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=qf(u==null?void 0:u.pointerEvents)||"",a.transform=c?c(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=qf(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!Lo(this.latestValues)&&(a.transform=c?c({},""):"none",this.hasProjected=!1);return}a.visibility="";const p=h.animationValues||h.latestValues;this.applyTransformsToTarget();let m=$$(this.projectionDeltaWithTransform,this.treeScale,p);c&&(m=c(p,m)),a.transform=m;const{x:_,y:T}=this.projectionDelta;a.transformOrigin=`${_.origin*100}% ${T.origin*100}% 0`,h.animationValues?a.opacity=h===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:a.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const A in jh){if(p[A]===void 0)continue;const{correct:b,applyTo:V,isCSSVariable:C}=jh[A],S=m==="none"?p[A]:b(p[A],h);if(V){const R=V.length;for(let U=0;U<R;U++)a[V[U]]=S}else C?this.options.visualElement.renderState.vars[A]=S:a[A]=S}this.options.layoutId&&(a.pointerEvents=h===this?qf(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var u;return(u=a.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(XC),this.root.sharedNodes.clear()}}}function K$(t){t.updateLayout()}function Z$(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=t.layout,{animationType:s}=t.options,a=e.source!==t.layout.source;s==="size"?ti(m=>{const _=a?e.measuredBox[m]:e.layoutBox[m],T=Tn(_);_.min=i[m].min,_.max=_.min+T}):iD(s,e.layoutBox,i)&&ti(m=>{const _=a?e.measuredBox[m]:e.layoutBox[m],T=Tn(i[m]);_.max=_.min+T,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+T)});const u=ml();Kc(u,i,e.layoutBox);const c=ml();a?Kc(c,t.applyTransform(r,!0),e.measuredBox):Kc(c,i,e.layoutBox);const h=!JL(u);let p=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:_,layout:T}=m;if(_&&T){const A=_t();Zc(A,e.layoutBox,_.layoutBox);const b=_t();Zc(b,i,T.layoutBox),eD(A,b)||(p=!0),m.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=A,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:i,snapshot:e,delta:c,layoutDelta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:p})}else if(t.isLead()){const{onExitComplete:i}=t.options;i&&i()}t.options.transition=void 0}function Q$(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Y$(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function X$(t){t.clearSnapshot()}function XC(t){t.clearMeasurements()}function JC(t){t.isLayoutDirty=!1}function J$(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function eI(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function e7(t){t.resolveTargetDelta()}function t7(t){t.calcProjection()}function n7(t){t.resetSkewAndRotation()}function i7(t){t.removeLeadSnapshot()}function tI(t,e,n){t.translate=ut(e.translate,0,n),t.scale=ut(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function nI(t,e,n,i){t.min=ut(e.min,n.min,i),t.max=ut(e.max,n.max,i)}function r7(t,e,n,i){nI(t.x,e.x,n.x,i),nI(t.y,e.y,n.y,i)}function s7(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const o7={duration:.45,ease:[.4,0,.1,1]},iI=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),rI=iI("applewebkit/")&&!iI("chrome/")?Math.round:di;function sI(t){t.min=rI(t.min),t.max=rI(t.max)}function a7(t){sI(t.x),sI(t.y)}function iD(t,e,n){return t==="position"||t==="preserve-aspect"&&!f$(QC(e),QC(n),.2)}function l7(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const u7=nD({attachResizeListener:(t,e)=>Uh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),D_={current:void 0},rD=nD({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!D_.current){const t=new u7({});t.mount(window),t.setOptions({layoutScroll:!0}),D_.current=t}return D_.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),c7={pan:{Feature:A$},drag:{Feature:P$,ProjectionNode:rD,MeasureLayout:QL}};function oI(t,e,n){const{props:i}=t;t.animationState&&i.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,s=i[r];s&&st.postRender(()=>s(e,dd(e)))}class h7 extends fo{mount(){const{current:e}=this.node;e&&(this.unmount=V8(e,(n,i)=>(oI(this.node,i,"Start"),r=>oI(this.node,r,"End"))))}unmount(){}}class d7 extends fo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ud(Uh(this.node.current,"focus",()=>this.onFocus()),Uh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function aI(t,e,n){const{props:i}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&i.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),s=i[r];s&&st.postRender(()=>s(e,dd(e)))}class f7 extends fo{mount(){const{current:e}=this.node;e&&(this.unmount=B8(e,(n,i)=>(aI(this.node,i,"Start"),(r,{success:s})=>aI(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const jv=new WeakMap,M_=new WeakMap,p7=t=>{const e=jv.get(t.target);e&&e(t)},m7=t=>{t.forEach(p7)};function g7({root:t,...e}){const n=t||document;M_.has(n)||M_.set(n,{});const i=M_.get(n),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(m7,{root:t,...e})),i[r]}function _7(t,e,n){const i=g7(e);return jv.set(t,n),i.observe(t),()=>{jv.delete(t),i.unobserve(t)}}const y7={some:0,all:1};class v7 extends fo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=e,a={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:y7[r]},u=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:p,onViewportLeave:m}=this.node.getProps(),_=h?p:m;_&&_(c)};return _7(this.node.current,a,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(w7(e,n))&&this.startObserver()}unmount(){}}function w7({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const E7={inView:{Feature:v7},tap:{Feature:f7},focus:{Feature:d7},hover:{Feature:h7}},T7={layout:{ProjectionNode:rD,MeasureLayout:QL}},x7={...a$,...E7,...c7,...T7},Fe=xH(x7,OH);function S7(){const[t,e]=B.useState(0),[n,i]=B.useState(0),[r,s]=B.useState(0),[a,u]=B.useState(0),[c,h]=B.useState(0);B.useEffect(()=>{(async()=>{const S=await Qr(pr(rt,"usuarios"));i(S.size)})();const _=yt(vt,"usuariosConectados"),T=ur(_,S=>{if(S.exists()){const R=Object.keys(S.val());e(R.length)}else e(0)}),A=yt(vt,"alertas"),b=ur(A,S=>{if(S.exists()){const U=Object.values(S.val()).filter(W=>W.estado==="activa").length;s(U)}else s(0)}),V=yt(vt,"recorridos"),C=ur(V,S=>{if(S.exists()){const R=Object.values(S.val());u(R.length);const U=new Date;U.setHours(0,0,0,0);const W=R.filter(K=>new Date(K.fechaInicio)>=U).length;h(W)}else u(0),h(0)});return()=>{b(),C(),T()}},[]);const p=n>0?t/n*100:0,m=Math.max(r,c,a,1);return E.jsxs(Fe.section,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[E.jsx("h1",{className:"text-3xl font-bold",children:"Panel de mtricas"}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[E.jsx(dc,{title:"Usuarios conectados",value:t,color:"blue"}),E.jsx(dc,{title:"Total usuarios",value:n,color:"green"}),E.jsx(dc,{title:"Alertas activas",value:r,color:"red"}),E.jsx(dc,{title:"Recorridos hoy",value:c,color:"purple"}),E.jsx(dc,{title:"Total recorridos",value:a,color:"indigo"})]}),E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[E.jsxs(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado de Usuarios"}),E.jsx("div",{className:"flex items-center justify-center h-48",children:E.jsxs("div",{className:"relative w-32 h-32",children:[E.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[E.jsx("path",{className:"text-gray-200",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),E.jsx("path",{className:"text-blue-600",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${p}, 100`,strokeLinecap:"round",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),E.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t}),E.jsx("div",{className:"text-xs text-gray-500",children:"conectados"})]})})]})}),E.jsxs("div",{className:"flex justify-center space-x-4 mt-4",children:[E.jsxs("div",{className:"flex items-center",children:[E.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full mr-2"}),E.jsxs("span",{className:"text-sm text-gray-600",children:["Conectados (",t,")"]})]}),E.jsxs("div",{className:"flex items-center",children:[E.jsx("div",{className:"w-3 h-3 bg-gray-200 rounded-full mr-2"}),E.jsxs("span",{className:"text-sm text-gray-600",children:["Desconectados (",n-t,")"]})]})]})]}),E.jsxs(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actividad del Sistema"}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between items-center mb-1",children:[E.jsx("span",{className:"text-sm text-gray-600",children:"Alertas Activas"}),E.jsx("span",{className:"text-sm font-semibold text-red-600",children:r})]}),E.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:E.jsx("div",{className:"bg-red-500 h-3 rounded-full transition-all duration-500",style:{width:`${m>0?r/m*100:0}%`}})})]}),E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between items-center mb-1",children:[E.jsx("span",{className:"text-sm text-gray-600",children:"Recorridos Hoy"}),E.jsx("span",{className:"text-sm font-semibold text-purple-600",children:c})]}),E.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:E.jsx("div",{className:"bg-purple-500 h-3 rounded-full transition-all duration-500",style:{width:`${m>0?c/m*100:0}%`}})})]}),E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between items-center mb-1",children:[E.jsx("span",{className:"text-sm text-gray-600",children:"Total Recorridos"}),E.jsx("span",{className:"text-sm font-semibold text-indigo-600",children:a})]}),E.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:E.jsx("div",{className:"bg-indigo-500 h-3 rounded-full transition-all duration-500",style:{width:`${m>0?a/m*100:0}%`}})})]})]})]})]})]})}function dc({title:t,value:e,color:n="blue"}){const i={blue:"text-blue-700 border-blue-200 bg-blue-50",green:"text-green-700 border-green-200 bg-green-50",red:"text-red-700 border-red-200 bg-red-50",purple:"text-purple-700 border-purple-200 bg-purple-50",indigo:"text-indigo-700 border-indigo-200 bg-indigo-50"};return E.jsxs(Fe.div,{whileHover:{scale:1.02},className:`bg-white p-6 rounded-2xl shadow-sm border-l-4 ${i[n]} transition-all duration-200`,children:[E.jsx("h3",{className:"text-sm text-gray-500 font-medium",children:t}),E.jsx("p",{className:`text-3xl font-bold mt-2 ${i[n].split(" ")[0]}`,children:e})]})}function sD(t,e){const n=B.useRef(e);B.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const C7=1;function I7(t){return Object.freeze({__version:C7,map:t})}function P7(t,e){return Object.freeze({...t,...e})}const oD=B.createContext(null),aD=oD.Provider;function lD(){const t=B.useContext(oD);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function A7(t){function e(n,i){const{instance:r,context:s}=t(n).current;return B.useImperativeHandle(i,()=>r),n.children==null?null:ui.createElement(aD,{value:s},n.children)}return B.forwardRef(e)}function R7(t){function e(n,i){const[r,s]=B.useState(!1),{instance:a}=t(n,s).current;B.useImperativeHandle(i,()=>a),B.useEffect(function(){r&&a.update()},[a,r,n.children]);const u=a._contentNode;return u?SA.createPortal(n.children,u):null}return B.forwardRef(e)}function b7(t){function e(n,i){const{instance:r}=t(n).current;return B.useImperativeHandle(i,()=>r),null}return B.forwardRef(e)}function uD(t,e){const n=B.useRef();B.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function KE(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function k7(t,e){return function(i,r){const s=lD(),a=t(KE(i,s),s);return sD(s.map,i.attribution),uD(a.current,i.eventHandlers),e(a.current,s,i,r),a}}var Uv={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,i){i(e)})(WD,function(n){var i="1.9.4";function r(o){var l,f,g,v;for(f=1,g=arguments.length;f<g;f++){v=arguments[f];for(l in v)o[l]=v[l]}return o}var s=Object.create||function(){function o(){}return function(l){return o.prototype=l,new o}}();function a(o,l){var f=Array.prototype.slice;if(o.bind)return o.bind.apply(o,f.call(arguments,1));var g=f.call(arguments,2);return function(){return o.apply(l,g.length?g.concat(f.call(arguments)):arguments)}}var u=0;function c(o){return"_leaflet_id"in o||(o._leaflet_id=++u),o._leaflet_id}function h(o,l,f){var g,v,x,F;return F=function(){g=!1,v&&(x.apply(f,v),v=!1)},x=function(){g?v=arguments:(o.apply(f,arguments),setTimeout(F,l),g=!0)},x}function p(o,l,f){var g=l[1],v=l[0],x=g-v;return o===g&&f?o:((o-v)%x+x)%x+v}function m(){return!1}function _(o,l){if(l===!1)return o;var f=Math.pow(10,l===void 0?6:l);return Math.round(o*f)/f}function T(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function A(o){return T(o).split(/\s+/)}function b(o,l){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?s(o.options):{});for(var f in l)o.options[f]=l[f];return o.options}function V(o,l,f){var g=[];for(var v in o)g.push(encodeURIComponent(f?v.toUpperCase():v)+"="+encodeURIComponent(o[v]));return(!l||l.indexOf("?")===-1?"?":"&")+g.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function S(o,l){return o.replace(C,function(f,g){var v=l[g];if(v===void 0)throw new Error("No value provided for variable "+f);return typeof v=="function"&&(v=v(l)),v})}var R=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function U(o,l){for(var f=0;f<o.length;f++)if(o[f]===l)return f;return-1}var W="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function K(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var k=0;function I(o){var l=+new Date,f=Math.max(0,16-(l-k));return k=l+f,window.setTimeout(o,f)}var N=window.requestAnimationFrame||K("RequestAnimationFrame")||I,O=window.cancelAnimationFrame||K("CancelAnimationFrame")||K("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function M(o,l,f){if(f&&N===I)o.call(l);else return N.call(window,a(o,l))}function j(o){o&&O.call(window,o)}var D={__proto__:null,extend:r,create:s,bind:a,get lastId(){return u},stamp:c,throttle:h,wrapNum:p,falseFn:m,formatNum:_,trim:T,splitWords:A,setOptions:b,getParamString:V,template:S,isArray:R,indexOf:U,emptyImageUrl:W,requestFn:N,cancelFn:O,requestAnimFrame:M,cancelAnimFrame:j};function xe(){}xe.extend=function(o){var l=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=l.__super__=this.prototype,g=s(f);g.constructor=l,l.prototype=g;for(var v in this)Object.prototype.hasOwnProperty.call(this,v)&&v!=="prototype"&&v!=="__super__"&&(l[v]=this[v]);return o.statics&&r(l,o.statics),o.includes&&(Nt(o.includes),r.apply(null,[g].concat(o.includes))),r(g,o),delete g.statics,delete g.includes,g.options&&(g.options=f.options?s(f.options):{},r(g.options,o.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var x=0,F=g._initHooks.length;x<F;x++)g._initHooks[x].call(this)}},l},xe.include=function(o){var l=this.prototype.options;return r(this.prototype,o),o.options&&(this.prototype.options=l,this.mergeOptions(o.options)),this},xe.mergeOptions=function(o){return r(this.prototype.options,o),this},xe.addInitHook=function(o){var l=Array.prototype.slice.call(arguments,1),f=typeof o=="function"?o:function(){this[o].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function Nt(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=R(o)?o:[o];for(var l=0;l<o.length;l++)o[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ge={on:function(o,l,f){if(typeof o=="object")for(var g in o)this._on(g,o[g],l);else{o=A(o);for(var v=0,x=o.length;v<x;v++)this._on(o[v],l,f)}return this},off:function(o,l,f){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var g in o)this._off(g,o[g],l);else{o=A(o);for(var v=arguments.length===1,x=0,F=o.length;x<F;x++)v?this._off(o[x]):this._off(o[x],l,f)}return this},_on:function(o,l,f,g){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(o,l,f)===!1){f===this&&(f=void 0);var v={fn:l,ctx:f};g&&(v.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(v)}},_off:function(o,l,f){var g,v,x;if(this._events&&(g=this._events[o],!!g)){if(arguments.length===1){if(this._firingCount)for(v=0,x=g.length;v<x;v++)g[v].fn=m;delete this._events[o];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var F=this._listens(o,l,f);if(F!==!1){var H=g[F];this._firingCount&&(H.fn=m,this._events[o]=g=g.slice()),g.splice(F,1)}}},fire:function(o,l,f){if(!this.listens(o,f))return this;var g=r({},l,{type:o,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var v=this._events[o];if(v){this._firingCount=this._firingCount+1||1;for(var x=0,F=v.length;x<F;x++){var H=v[x],G=H.fn;H.once&&this.off(o,G,H.ctx),G.call(H.ctx||this,g)}this._firingCount--}}return f&&this._propagateEvent(g),this},listens:function(o,l,f,g){typeof o!="string"&&console.warn('"string" type argument expected');var v=l;typeof l!="function"&&(g=!!l,v=void 0,f=void 0);var x=this._events&&this._events[o];if(x&&x.length&&this._listens(o,v,f)!==!1)return!0;if(g){for(var F in this._eventParents)if(this._eventParents[F].listens(o,l,f,g))return!0}return!1},_listens:function(o,l,f){if(!this._events)return!1;var g=this._events[o]||[];if(!l)return!!g.length;f===this&&(f=void 0);for(var v=0,x=g.length;v<x;v++)if(g[v].fn===l&&g[v].ctx===f)return v;return!1},once:function(o,l,f){if(typeof o=="object")for(var g in o)this._on(g,o[g],l,!0);else{o=A(o);for(var v=0,x=o.length;v<x;v++)this._on(o[v],l,f,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[c(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[c(o)],this},_propagateEvent:function(o){for(var l in this._eventParents)this._eventParents[l].fire(o.type,r({layer:o.target,propagatedFrom:o.target},o),!0)}};Ge.addEventListener=Ge.on,Ge.removeEventListener=Ge.clearAllEventListeners=Ge.off,Ge.addOneTimeEventListener=Ge.once,Ge.fireEvent=Ge.fire,Ge.hasEventListeners=Ge.listens;var he=xe.extend(Ge);function q(o,l,f){this.x=f?Math.round(o):o,this.y=f?Math.round(l):l}var re=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(o){return this.clone()._add(X(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(X(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new q(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new q(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=re(this.x),this.y=re(this.y),this},distanceTo:function(o){o=X(o);var l=o.x-this.x,f=o.y-this.y;return Math.sqrt(l*l+f*f)},equals:function(o){return o=X(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=X(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function X(o,l,f){return o instanceof q?o:R(o)?new q(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new q(o.x,o.y):new q(o,l,f)}function le(o,l){if(o)for(var f=l?[o,l]:o,g=0,v=f.length;g<v;g++)this.extend(f[g])}le.prototype={extend:function(o){var l,f;if(!o)return this;if(o instanceof q||typeof o[0]=="number"||"x"in o)l=f=X(o);else if(o=Se(o),l=o.min,f=o.max,!l||!f)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=f.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(o){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var l,f;return typeof o[0]=="number"||o instanceof q?o=X(o):o=Se(o),o instanceof le?(l=o.min,f=o.max):l=f=o,l.x>=this.min.x&&f.x<=this.max.x&&l.y>=this.min.y&&f.y<=this.max.y},intersects:function(o){o=Se(o);var l=this.min,f=this.max,g=o.min,v=o.max,x=v.x>=l.x&&g.x<=f.x,F=v.y>=l.y&&g.y<=f.y;return x&&F},overlaps:function(o){o=Se(o);var l=this.min,f=this.max,g=o.min,v=o.max,x=v.x>l.x&&g.x<f.x,F=v.y>l.y&&g.y<f.y;return x&&F},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var l=this.min,f=this.max,g=Math.abs(l.x-f.x)*o,v=Math.abs(l.y-f.y)*o;return Se(X(l.x-g,l.y-v),X(f.x+g,f.y+v))},equals:function(o){return o?(o=Se(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function Se(o,l){return!o||o instanceof le?o:new le(o,l)}function nt(o,l){if(o)for(var f=l?[o,l]:o,g=0,v=f.length;g<v;g++)this.extend(f[g])}nt.prototype={extend:function(o){var l=this._southWest,f=this._northEast,g,v;if(o instanceof Ne)g=o,v=o;else if(o instanceof nt){if(g=o._southWest,v=o._northEast,!g||!v)return this}else return o?this.extend(ye(o)||Ve(o)):this;return!l&&!f?(this._southWest=new Ne(g.lat,g.lng),this._northEast=new Ne(v.lat,v.lng)):(l.lat=Math.min(g.lat,l.lat),l.lng=Math.min(g.lng,l.lng),f.lat=Math.max(v.lat,f.lat),f.lng=Math.max(v.lng,f.lng)),this},pad:function(o){var l=this._southWest,f=this._northEast,g=Math.abs(l.lat-f.lat)*o,v=Math.abs(l.lng-f.lng)*o;return new nt(new Ne(l.lat-g,l.lng-v),new Ne(f.lat+g,f.lng+v))},getCenter:function(){return new Ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof Ne||"lat"in o?o=ye(o):o=Ve(o);var l=this._southWest,f=this._northEast,g,v;return o instanceof nt?(g=o.getSouthWest(),v=o.getNorthEast()):g=v=o,g.lat>=l.lat&&v.lat<=f.lat&&g.lng>=l.lng&&v.lng<=f.lng},intersects:function(o){o=Ve(o);var l=this._southWest,f=this._northEast,g=o.getSouthWest(),v=o.getNorthEast(),x=v.lat>=l.lat&&g.lat<=f.lat,F=v.lng>=l.lng&&g.lng<=f.lng;return x&&F},overlaps:function(o){o=Ve(o);var l=this._southWest,f=this._northEast,g=o.getSouthWest(),v=o.getNorthEast(),x=v.lat>l.lat&&g.lat<f.lat,F=v.lng>l.lng&&g.lng<f.lng;return x&&F},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,l){return o?(o=Ve(o),this._southWest.equals(o.getSouthWest(),l)&&this._northEast.equals(o.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ve(o,l){return o instanceof nt?o:new nt(o,l)}function Ne(o,l,f){if(isNaN(o)||isNaN(l))throw new Error("Invalid LatLng object: ("+o+", "+l+")");this.lat=+o,this.lng=+l,f!==void 0&&(this.alt=+f)}Ne.prototype={equals:function(o,l){if(!o)return!1;o=ye(o);var f=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return f<=(l===void 0?1e-9:l)},toString:function(o){return"LatLng("+_(this.lat,o)+", "+_(this.lng,o)+")"},distanceTo:function(o){return Yn.distance(this,ye(o))},wrap:function(){return Yn.wrapLatLng(this)},toBounds:function(o){var l=180*o/40075017,f=l/Math.cos(Math.PI/180*this.lat);return Ve([this.lat-l,this.lng-f],[this.lat+l,this.lng+f])},clone:function(){return new Ne(this.lat,this.lng,this.alt)}};function ye(o,l,f){return o instanceof Ne?o:R(o)&&typeof o[0]!="object"?o.length===3?new Ne(o[0],o[1],o[2]):o.length===2?new Ne(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new Ne(o.lat,"lng"in o?o.lng:o.lon,o.alt):l===void 0?null:new Ne(o,l,f)}var Ut={latLngToPoint:function(o,l){var f=this.projection.project(o),g=this.scale(l);return this.transformation._transform(f,g)},pointToLatLng:function(o,l){var f=this.scale(l),g=this.transformation.untransform(o,f);return this.projection.unproject(g)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var l=this.projection.bounds,f=this.scale(o),g=this.transformation.transform(l.min,f),v=this.transformation.transform(l.max,f);return new le(g,v)},infinite:!1,wrapLatLng:function(o){var l=this.wrapLng?p(o.lng,this.wrapLng,!0):o.lng,f=this.wrapLat?p(o.lat,this.wrapLat,!0):o.lat,g=o.alt;return new Ne(f,l,g)},wrapLatLngBounds:function(o){var l=o.getCenter(),f=this.wrapLatLng(l),g=l.lat-f.lat,v=l.lng-f.lng;if(g===0&&v===0)return o;var x=o.getSouthWest(),F=o.getNorthEast(),H=new Ne(x.lat-g,x.lng-v),G=new Ne(F.lat-g,F.lng-v);return new nt(H,G)}},Yn=r({},Ut,{wrapLng:[-180,180],R:6371e3,distance:function(o,l){var f=Math.PI/180,g=o.lat*f,v=l.lat*f,x=Math.sin((l.lat-o.lat)*f/2),F=Math.sin((l.lng-o.lng)*f/2),H=x*x+Math.cos(g)*Math.cos(v)*F*F,G=2*Math.atan2(Math.sqrt(H),Math.sqrt(1-H));return this.R*G}}),vu=6378137,va={R:vu,MAX_LATITUDE:85.0511287798,project:function(o){var l=Math.PI/180,f=this.MAX_LATITUDE,g=Math.max(Math.min(f,o.lat),-f),v=Math.sin(g*l);return new q(this.R*o.lng*l,this.R*Math.log((1+v)/(1-v))/2)},unproject:function(o){var l=180/Math.PI;return new Ne((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*l,o.x*l/this.R)},bounds:function(){var o=vu*Math.PI;return new le([-o,-o],[o,o])}()};function wu(o,l,f,g){if(R(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=l,this._c=f,this._d=g}wu.prototype={transform:function(o,l){return this._transform(o.clone(),l)},_transform:function(o,l){return l=l||1,o.x=l*(this._a*o.x+this._b),o.y=l*(this._c*o.y+this._d),o},untransform:function(o,l){return l=l||1,new q((o.x/l-this._b)/this._a,(o.y/l-this._d)/this._c)}};function is(o,l,f,g){return new wu(o,l,f,g)}var wa=r({},Yn,{code:"EPSG:3857",projection:va,transformation:function(){var o=.5/(Math.PI*va.R);return is(o,.5,-o,.5)}()}),Eu=r({},wa,{code:"EPSG:900913"});function Tu(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function pd(o,l){var f="",g,v,x,F,H,G;for(g=0,x=o.length;g<x;g++){for(H=o[g],v=0,F=H.length;v<F;v++)G=H[v],f+=(v?"L":"M")+G.x+" "+G.y;f+=l?ae.svg?"z":"x":""}return f||"M0 0"}var po=document.documentElement.style,rs="ActiveXObject"in window,xu=rs&&!document.addEventListener,Lt="msLaunchUri"in navigator&&!("documentMode"in document),Dt=zn("webkit"),mo=zn("android"),md=zn("android 2")||zn("android 3"),gd=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),dg=mo&&zn("Google")&&gd<537&&!("AudioNode"in window),_r=!!window.opera,Su=!Lt&&zn("chrome"),Cu=zn("gecko")&&!Dt&&!_r&&!rs,Iu=!Su&&zn("safari"),_d=zn("phantom"),yd="OTransition"in po,vd=navigator.platform.indexOf("Win")===0,Pu=rs&&"transition"in po,yr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!md,Ea="MozPerspective"in po,Au=!window.L_DISABLE_3D&&(Pu||yr||Ea)&&!yd&&!_d,Bn=typeof orientation<"u"||zn("mobile"),wd=Bn&&Dt,Ta=Bn&&yr,Ru=!window.PointerEvent&&window.MSPointerEvent,ss=!!(window.PointerEvent||Ru),bu="ontouchstart"in window||!!window.TouchEvent,Yt=!window.L_NO_TOUCH&&(bu||ss),Ed=Bn&&_r,go=Bn&&Cu,_o=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,fg=function(){var o=!1;try{var l=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",m,l),window.removeEventListener("testPassiveEventSupport",m,l)}catch{}return o}(),pg=function(){return!!document.createElement("canvas").getContext}(),Fi=!!(document.createElementNS&&Tu("svg").createSVGRect),mg=!!Fi&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),gg=!Fi&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var l=o.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),xa=navigator.platform.indexOf("Mac")===0,Td=navigator.platform.indexOf("Linux")===0;function zn(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var ae={ie:rs,ielt9:xu,edge:Lt,webkit:Dt,android:mo,android23:md,androidStock:dg,opera:_r,chrome:Su,gecko:Cu,safari:Iu,phantom:_d,opera12:yd,win:vd,ie3d:Pu,webkit3d:yr,gecko3d:Ea,any3d:Au,mobile:Bn,mobileWebkit:wd,mobileWebkit3d:Ta,msPointer:Ru,pointer:ss,touch:Yt,touchNative:bu,mobileOpera:Ed,mobileGecko:go,retina:_o,passiveEvents:fg,canvas:pg,svg:Fi,vml:gg,inlineSvg:mg,mac:xa,linux:Td},os=ae.msPointer?"MSPointerDown":"pointerdown",xd=ae.msPointer?"MSPointerMove":"pointermove",gi=ae.msPointer?"MSPointerUp":"pointerup",ku=ae.msPointer?"MSPointerCancel":"pointercancel",Sa={touchstart:os,touchmove:xd,touchend:gi,touchcancel:ku},Ca={touchstart:vr,touchmove:Ui,touchend:Ui,touchcancel:Ui},ji={},Nu=!1;function _g(o,l,f){return l==="touchstart"&&Du(),Ca[l]?(f=Ca[l].bind(this,f),o.addEventListener(Sa[l],f,!1),f):(console.warn("wrong event specified:",l),m)}function Sd(o,l,f){if(!Sa[l]){console.warn("wrong event specified:",l);return}o.removeEventListener(Sa[l],f,!1)}function yg(o){ji[o.pointerId]=o}function Ia(o){ji[o.pointerId]&&(ji[o.pointerId]=o)}function Lu(o){delete ji[o.pointerId]}function Du(){Nu||(document.addEventListener(os,yg,!0),document.addEventListener(xd,Ia,!0),document.addEventListener(gi,Lu,!0),document.addEventListener(ku,Lu,!0),Nu=!0)}function Ui(o,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var f in ji)l.touches.push(ji[f]);l.changedTouches=[l],o(l)}}function vr(o,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&Mt(l),Ui(o,l)}function Mu(o){var l={},f,g;for(g in o)f=o[g],l[g]=f&&f.bind?f.bind(o):f;return o=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var vg=200;function Cd(o,l){o.addEventListener("dblclick",l);var f=0,g;function v(x){if(x.detail!==1){g=x.detail;return}if(!(x.pointerType==="mouse"||x.sourceCapabilities&&!x.sourceCapabilities.firesTouchEvents)){var F=ju(x);if(!(F.some(function(G){return G instanceof HTMLLabelElement&&G.attributes.for})&&!F.some(function(G){return G instanceof HTMLInputElement||G instanceof HTMLSelectElement}))){var H=Date.now();H-f<=vg?(g++,g===2&&l(Mu(x))):g=1,f=H}}}return o.addEventListener("click",v),{dblclick:l,simDblclick:v}}function Id(o,l){o.removeEventListener("dblclick",l.dblclick),o.removeEventListener("click",l.simDblclick)}var Pa=yo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),wr=yo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Aa=wr==="webkitTransition"||wr==="OTransition"?wr+"End":"transitionend";function Ou(o){return typeof o=="string"?document.getElementById(o):o}function as(o,l){var f=o.style[l]||o.currentStyle&&o.currentStyle[l];if((!f||f==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(o,null);f=g?g[l]:null}return f==="auto"?null:f}function Me(o,l,f){var g=document.createElement(o);return g.className=l||"",f&&f.appendChild(g),g}function Ye(o){var l=o.parentNode;l&&l.removeChild(o)}function Wn(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Xt(o){var l=o.parentNode;l&&l.lastChild!==o&&l.appendChild(o)}function Xn(o){var l=o.parentNode;l&&l.firstChild!==o&&l.insertBefore(o,l.firstChild)}function Er(o,l){if(o.classList!==void 0)return o.classList.contains(l);var f=Bi(o);return f.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(f)}function we(o,l){if(o.classList!==void 0)for(var f=A(l),g=0,v=f.length;g<v;g++)o.classList.add(f[g]);else if(!Er(o,l)){var x=Bi(o);ls(o,(x?x+" ":"")+l)}}function _e(o,l){o.classList!==void 0?o.classList.remove(l):ls(o,T((" "+Bi(o)+" ").replace(" "+l+" "," ")))}function ls(o,l){o.className.baseVal===void 0?o.className=l:o.className.baseVal=l}function Bi(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Bt(o,l){"opacity"in o.style?o.style.opacity=l:"filter"in o.style&&wg(o,l)}function wg(o,l){var f=!1,g="DXImageTransform.Microsoft.Alpha";try{f=o.filters.item(g)}catch{if(l===1)return}l=Math.round(l*100),f?(f.Enabled=l!==100,f.Opacity=l):o.style.filter+=" progid:"+g+"(opacity="+l+")"}function yo(o){for(var l=document.documentElement.style,f=0;f<o.length;f++)if(o[f]in l)return o[f];return!1}function Tr(o,l,f){var g=l||new q(0,0);o.style[Pa]=(ae.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(f?" scale("+f+")":"")}function ft(o,l){o._leaflet_pos=l,ae.any3d?Tr(o,l):(o.style.left=l.x+"px",o.style.top=l.y+"px")}function xr(o){return o._leaflet_pos||new q(0,0)}var vo,_i,yi;if("onselectstart"in document)vo=function(){Ee(window,"selectstart",Mt)},_i=function(){Ue(window,"selectstart",Mt)};else{var us=yo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);vo=function(){if(us){var o=document.documentElement.style;yi=o[us],o[us]="none"}},_i=function(){us&&(document.documentElement.style[us]=yi,yi=void 0)}}function Ra(){Ee(window,"dragstart",Mt)}function ba(){Ue(window,"dragstart",Mt)}var wo,ka;function zi(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(Na(),wo=o,ka=o.style.outlineStyle,o.style.outlineStyle="none",Ee(window,"keydown",Na))}function Na(){wo&&(wo.style.outlineStyle=ka,wo=void 0,ka=void 0,Ue(window,"keydown",Na))}function Pd(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function Vu(o){var l=o.getBoundingClientRect();return{x:l.width/o.offsetWidth||1,y:l.height/o.offsetHeight||1,boundingClientRect:l}}var Wi={__proto__:null,TRANSFORM:Pa,TRANSITION:wr,TRANSITION_END:Aa,get:Ou,getStyle:as,create:Me,remove:Ye,empty:Wn,toFront:Xt,toBack:Xn,hasClass:Er,addClass:we,removeClass:_e,setClass:ls,getClass:Bi,setOpacity:Bt,testProp:yo,setTransform:Tr,setPosition:ft,getPosition:xr,get disableTextSelection(){return vo},get enableTextSelection(){return _i},disableImageDrag:Ra,enableImageDrag:ba,preventOutline:zi,restoreOutline:Na,getSizedParentNode:Pd,getScale:Vu};function Ee(o,l,f,g){if(l&&typeof l=="object")for(var v in l)Cr(o,v,l[v],f);else{l=A(l);for(var x=0,F=l.length;x<F;x++)Cr(o,l[x],f,g)}return this}var Pn="_leaflet_events";function Ue(o,l,f,g){if(arguments.length===1)Fu(o),delete o[Pn];else if(l&&typeof l=="object")for(var v in l)La(o,v,l[v],f);else if(l=A(l),arguments.length===2)Fu(o,function(H){return U(l,H)!==-1});else for(var x=0,F=l.length;x<F;x++)La(o,l[x],f,g);return this}function Fu(o,l){for(var f in o[Pn]){var g=f.split(/\d/)[0];(!l||l(g))&&La(o,g,null,null,f)}}var Sr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Cr(o,l,f,g){var v=l+c(f)+(g?"_"+c(g):"");if(o[Pn]&&o[Pn][v])return this;var x=function(H){return f.call(g||o,H||window.event)},F=x;!ae.touchNative&&ae.pointer&&l.indexOf("touch")===0?x=_g(o,l,x):ae.touch&&l==="dblclick"?x=Cd(o,x):"addEventListener"in o?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?o.addEventListener(Sr[l]||l,x,ae.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(x=function(H){H=H||window.event,Ma(o,H)&&F(H)},o.addEventListener(Sr[l],x,!1)):o.addEventListener(l,F,!1):o.attachEvent("on"+l,x),o[Pn]=o[Pn]||{},o[Pn][v]=x}function La(o,l,f,g,v){v=v||l+c(f)+(g?"_"+c(g):"");var x=o[Pn]&&o[Pn][v];if(!x)return this;!ae.touchNative&&ae.pointer&&l.indexOf("touch")===0?Sd(o,l,x):ae.touch&&l==="dblclick"?Id(o,x):"removeEventListener"in o?o.removeEventListener(Sr[l]||l,x,!1):o.detachEvent("on"+l,x),o[Pn][v]=null}function vi(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function Ke(o){return Cr(o,"wheel",vi),this}function Eo(o){return Ee(o,"mousedown touchstart dblclick contextmenu",vi),o._leaflet_disable_click=!0,this}function Mt(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function Hi(o){return Mt(o),vi(o),this}function ju(o){if(o.composedPath)return o.composedPath();for(var l=[],f=o.target;f;)l.push(f),f=f.parentNode;return l}function Uu(o,l){if(!l)return new q(o.clientX,o.clientY);var f=Vu(l),g=f.boundingClientRect;return new q((o.clientX-g.left)/f.x-l.clientLeft,(o.clientY-g.top)/f.y-l.clientTop)}var Da=ae.linux&&ae.chrome?window.devicePixelRatio:ae.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function wi(o){return ae.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/Da:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function Ma(o,l){var f=l.relatedTarget;if(!f)return!0;try{for(;f&&f!==o;)f=f.parentNode}catch{return!1}return f!==o}var Eg={__proto__:null,on:Ee,off:Ue,stopPropagation:vi,disableScrollPropagation:Ke,disableClickPropagation:Eo,preventDefault:Mt,stop:Hi,getPropagationPath:ju,getMousePosition:Uu,getWheelDelta:wi,isExternalTarget:Ma,addListener:Ee,removeListener:Ue},cs=he.extend({run:function(o,l,f,g){this.stop(),this._el=o,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=xr(o),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(o){var l=+new Date-this._startTime,f=this._duration*1e3;l<f?this._runFrame(this._easeOut(l/f),o):(this._runFrame(1),this._complete())},_runFrame:function(o,l){var f=this._startPos.add(this._offset.multiplyBy(o));l&&f._round(),ft(this._el,f),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Re=he.extend({options:{crs:wa,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,l){l=b(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(ye(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=wr&&ae.any3d&&!ae.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ee(this._proxy,Aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,l,f){if(l=l===void 0?this._zoom:this._limitZoom(l),o=this._limitCenter(ye(o),l,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=r({animate:f.animate},f.zoom),f.pan=r({animate:f.animate,duration:f.duration},f.pan));var g=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,l,f.zoom):this._tryAnimatedPan(o,f.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(o,l,f.pan&&f.pan.noMoveStart),this},setZoom:function(o,l){return this._loaded?this.setView(this.getCenter(),o,{zoom:l}):(this._zoom=o,this)},zoomIn:function(o,l){return o=o||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,l)},zoomOut:function(o,l){return o=o||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,l)},setZoomAround:function(o,l,f){var g=this.getZoomScale(l),v=this.getSize().divideBy(2),x=o instanceof q?o:this.latLngToContainerPoint(o),F=x.subtract(v).multiplyBy(1-1/g),H=this.containerPointToLatLng(v.add(F));return this.setView(H,l,{zoom:f})},_getBoundsCenterZoom:function(o,l){l=l||{},o=o.getBounds?o.getBounds():Ve(o);var f=X(l.paddingTopLeft||l.padding||[0,0]),g=X(l.paddingBottomRight||l.padding||[0,0]),v=this.getBoundsZoom(o,!1,f.add(g));if(v=typeof l.maxZoom=="number"?Math.min(l.maxZoom,v):v,v===1/0)return{center:o.getCenter(),zoom:v};var x=g.subtract(f).divideBy(2),F=this.project(o.getSouthWest(),v),H=this.project(o.getNorthEast(),v),G=this.unproject(F.add(H).divideBy(2).add(x),v);return{center:G,zoom:v}},fitBounds:function(o,l){if(o=Ve(o),!o.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(o,l);return this.setView(f.center,f.zoom,l)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,l){return this.setView(o,this._zoom,{pan:l})},panBy:function(o,l){if(o=X(o).round(),l=l||{},!o.x&&!o.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new cs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){we(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,f,l.duration||.25,l.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,l,f){if(f=f||{},f.animate===!1||!ae.any3d)return this.setView(o,l,f);this._stop();var g=this.project(this.getCenter()),v=this.project(o),x=this.getSize(),F=this._zoom;o=ye(o),l=l===void 0?F:l;var H=Math.max(x.x,x.y),G=H*this.getZoomScale(F,l),Y=v.distanceTo(g)||1,ne=1.42,de=ne*ne;function Ie(St){var Hd=St?-1:1,FD=St?G:H,jD=G*G-H*H+Hd*de*de*Y*Y,UD=2*FD*de*Y,Pg=jD/UD,vT=Math.sqrt(Pg*Pg+1)-Pg,BD=vT<1e-9?-18:Math.log(vT);return BD}function vn(St){return(Math.exp(St)-Math.exp(-St))/2}function zt(St){return(Math.exp(St)+Math.exp(-St))/2}function Jn(St){return vn(St)/zt(St)}var Rn=Ie(0);function Wa(St){return H*(zt(Rn)/zt(Rn+ne*St))}function DD(St){return H*(zt(Rn)*Jn(Rn+ne*St)-vn(Rn))/de}function MD(St){return 1-Math.pow(1-St,1.5)}var OD=Date.now(),_T=(Ie(1)-Rn)/ne,VD=f.duration?1e3*f.duration:1e3*_T*.8;function yT(){var St=(Date.now()-OD)/VD,Hd=MD(St)*_T;St<=1?(this._flyToFrame=M(yT,this),this._move(this.unproject(g.add(v.subtract(g).multiplyBy(DD(Hd)/Y)),F),this.getScaleZoom(H/Wa(Hd),F),{flyTo:!0})):this._move(o,l)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),yT.call(this),this},flyToBounds:function(o,l){var f=this._getBoundsCenterZoom(o,l);return this.flyTo(f.center,f.zoom,l)},setMaxBounds:function(o){return o=Ve(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var l=this.options.minZoom;return this.options.minZoom=o,this._loaded&&l!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var l=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&l!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,l){this._enforcingBounds=!0;var f=this.getCenter(),g=this._limitCenter(f,this._zoom,Ve(o));return f.equals(g)||this.panTo(g,l),this._enforcingBounds=!1,this},panInside:function(o,l){l=l||{};var f=X(l.paddingTopLeft||l.padding||[0,0]),g=X(l.paddingBottomRight||l.padding||[0,0]),v=this.project(this.getCenter()),x=this.project(o),F=this.getPixelBounds(),H=Se([F.min.add(f),F.max.subtract(g)]),G=H.getSize();if(!H.contains(x)){this._enforcingBounds=!0;var Y=x.subtract(H.getCenter()),ne=H.extend(x).getSize().subtract(G);v.x+=Y.x<0?-ne.x:ne.x,v.y+=Y.y<0?-ne.y:ne.y,this.panTo(this.unproject(v),l),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=r({animate:!1,pan:!0},o===!0?{animate:!0}:o);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),g=l.divideBy(2).round(),v=f.divideBy(2).round(),x=g.subtract(v);return!x.x&&!x.y?this:(o.animate&&o.pan?this.panBy(x):(o.pan&&this._rawPanBy(x),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=r({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=a(this._handleGeolocationResponse,this),f=a(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,f,o):navigator.geolocation.getCurrentPosition(l,f,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var l=o.code,f=o.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var l=o.coords.latitude,f=o.coords.longitude,g=new Ne(l,f),v=g.toBounds(o.coords.accuracy*2),x=this._locateOptions;if(x.setView){var F=this.getBoundsZoom(v);this.setView(g,x.maxZoom?Math.min(F,x.maxZoom):F)}var H={latlng:g,bounds:v,timestamp:o.timestamp};for(var G in o.coords)typeof o.coords[G]=="number"&&(H[G]=o.coords[G]);this.fire("locationfound",H)}},addHandler:function(o,l){if(!l)return this;var f=this[o]=new l(this);return this._handlers.push(f),this.options[o]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ye(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)Ye(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,l){var f="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),g=Me("div",f,l||this._mapPane);return o&&(this._panes[o]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),l=this.unproject(o.getBottomLeft()),f=this.unproject(o.getTopRight());return new nt(l,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,l,f){o=Ve(o),f=X(f||[0,0]);var g=this.getZoom()||0,v=this.getMinZoom(),x=this.getMaxZoom(),F=o.getNorthWest(),H=o.getSouthEast(),G=this.getSize().subtract(f),Y=Se(this.project(H,g),this.project(F,g)).getSize(),ne=ae.any3d?this.options.zoomSnap:1,de=G.x/Y.x,Ie=G.y/Y.y,vn=l?Math.max(de,Ie):Math.min(de,Ie);return g=this.getScaleZoom(vn,g),ne&&(g=Math.round(g/(ne/100))*(ne/100),g=l?Math.ceil(g/ne)*ne:Math.floor(g/ne)*ne),Math.max(v,Math.min(x,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,l){var f=this._getTopLeftPoint(o,l);return new le(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,l){var f=this.options.crs;return l=l===void 0?this._zoom:l,f.scale(o)/f.scale(l)},getScaleZoom:function(o,l){var f=this.options.crs;l=l===void 0?this._zoom:l;var g=f.zoom(o*f.scale(l));return isNaN(g)?1/0:g},project:function(o,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(ye(o),l)},unproject:function(o,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(X(o),l)},layerPointToLatLng:function(o){var l=X(o).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(o){var l=this.project(ye(o))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(ye(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(Ve(o))},distance:function(o,l){return this.options.crs.distance(ye(o),ye(l))},containerPointToLayerPoint:function(o){return X(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return X(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var l=this.containerPointToLayerPoint(X(o));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ye(o)))},mouseEventToContainerPoint:function(o){return Uu(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var l=this._container=Ou(o);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ee(l,"scroll",this._onScroll,this),this._containerId=c(l)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&ae.any3d,we(o,"leaflet-container"+(ae.touch?" leaflet-touch":"")+(ae.retina?" leaflet-retina":"")+(ae.ielt9?" leaflet-oldie":"")+(ae.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=as(o,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ft(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(we(o.markerPane,"leaflet-zoom-hide"),we(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,l,f){ft(this._mapPane,new q(0,0));var g=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var v=this._zoom!==l;this._moveStart(v,f)._move(o,l)._moveEnd(v),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(o,l){return o&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(o,l,f,g){l===void 0&&(l=this._zoom);var v=this._zoom!==l;return this._zoom=l,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),g?f&&f.pinch&&this.fire("zoom",f):((v||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){ft(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[c(this._container)]=this;var l=o?Ue:Ee;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),ae.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,l){for(var f=[],g,v=l==="mouseout"||l==="mouseover",x=o.target||o.srcElement,F=!1;x;){if(g=this._targets[c(x)],g&&(l==="click"||l==="preclick")&&this._draggableMoved(g)){F=!0;break}if(g&&g.listens(l,!0)&&(v&&!Ma(x,o)||(f.push(g),v))||x===this._container)break;x=x.parentNode}return!f.length&&!F&&!v&&this.listens(l,!0)&&(f=[this]),f},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var l=o.target||o.srcElement;if(!(!this._loaded||l._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(l))){var f=o.type;f==="mousedown"&&zi(l),this._fireDOMEvent(o,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,l,f){if(o.type==="click"){var g=r({},o);g.type="preclick",this._fireDOMEvent(g,g.type,f)}var v=this._findEventTargets(o,l);if(f){for(var x=[],F=0;F<f.length;F++)f[F].listens(l,!0)&&x.push(f[F]);v=x.concat(v)}if(v.length){l==="contextmenu"&&Mt(o);var H=v[0],G={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var Y=H.getLatLng&&(!H._radius||H._radius<=10);G.containerPoint=Y?this.latLngToContainerPoint(H.getLatLng()):this.mouseEventToContainerPoint(o),G.layerPoint=this.containerPointToLayerPoint(G.containerPoint),G.latlng=Y?H.getLatLng():this.layerPointToLatLng(G.layerPoint)}for(F=0;F<v.length;F++)if(v[F].fire(l,G,!0),G.originalEvent._stopped||v[F].options.bubblingMouseEvents===!1&&U(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,l=this._handlers.length;o<l;o++)this._handlers[o].disable()},whenReady:function(o,l){return this._loaded?o.call(l||this,{target:this}):this.on("load",o,l),this},_getMapPanePos:function(){return xr(this._mapPane)||new q(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,l){var f=o&&l!==void 0?this._getNewPixelOrigin(o,l):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,l){var f=this.getSize()._divideBy(2);return this.project(o,l)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,l,f){var g=this._getNewPixelOrigin(f,l);return this.project(o,l)._subtract(g)},_latLngBoundsToNewLayerBounds:function(o,l,f){var g=this._getNewPixelOrigin(f,l);return Se([this.project(o.getSouthWest(),l)._subtract(g),this.project(o.getNorthWest(),l)._subtract(g),this.project(o.getSouthEast(),l)._subtract(g),this.project(o.getNorthEast(),l)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,l,f){if(!f)return o;var g=this.project(o,l),v=this.getSize().divideBy(2),x=new le(g.subtract(v),g.add(v)),F=this._getBoundsOffset(x,f,l);return Math.abs(F.x)<=1&&Math.abs(F.y)<=1?o:this.unproject(g.add(F),l)},_limitOffset:function(o,l){if(!l)return o;var f=this.getPixelBounds(),g=new le(f.min.add(o),f.max.add(o));return o.add(this._getBoundsOffset(g,l))},_getBoundsOffset:function(o,l,f){var g=Se(this.project(l.getNorthEast(),f),this.project(l.getSouthWest(),f)),v=g.min.subtract(o.min),x=g.max.subtract(o.max),F=this._rebound(v.x,-x.x),H=this._rebound(v.y,-x.y);return new q(F,H)},_rebound:function(o,l){return o+l>0?Math.round(o-l)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(l))},_limitZoom:function(o){var l=this.getMinZoom(),f=this.getMaxZoom(),g=ae.any3d?this.options.zoomSnap:1;return g&&(o=Math.round(o/g)*g),Math.max(l,Math.min(f,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_e(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,l){var f=this._getCenterOffset(o)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,l),!0)},_createAnimProxy:function(){var o=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(l){var f=Pa,g=this._proxy.style[f];Tr(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),g===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ye(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),l=this.getZoom();Tr(this._proxy,this.project(o,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,l,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(l),v=this._getCenterOffset(o)._divideBy(1-1/g);return f.animate!==!0&&!this.getSize().contains(v)?!1:(M(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(o,l,!0)},this),!0)},_animateZoom:function(o,l,f,g){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=l,we(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:l,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_e(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Bu(o,l){return new Re(o,l)}var on=xe.extend({options:{position:"topright"},initialize:function(o){b(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var l=this._map;return l&&l.removeControl(this),this.options.position=o,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var l=this._container=this.onAdd(o),f=this.getPosition(),g=o._controlCorners[f];return we(l,"leaflet-control"),f.indexOf("bottom")!==-1?g.insertBefore(l,g.firstChild):g.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ye(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),hs=function(o){return new on(o)};Re.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},l="leaflet-",f=this._controlContainer=Me("div",l+"control-container",this._container);function g(v,x){var F=l+v+" "+l+x;o[v+x]=Me("div",F,f)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)Ye(this._controlCorners[o]);Ye(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var To=on.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,l,f,g){return f<g?-1:g<f?1:0}},initialize:function(o,l,f){b(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in o)this._addLayer(o[g],g);for(g in l)this._addLayer(l[g],g,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return on.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,l){return this._addLayer(o,l),this._map?this._update():this},addOverlay:function(o,l){return this._addLayer(o,l,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var l=this._getLayer(c(o));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){we(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(we(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):_e(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _e(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",l=this._container=Me("div",o),f=this.options.collapsed;l.setAttribute("aria-haspopup",!0),Eo(l),Ke(l);var g=this._section=Me("section",o+"-list");f&&(this._map.on("click",this.collapse,this),Ee(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var v=this._layersLink=Me("a",o+"-toggle",l);v.href="#",v.title="Layers",v.setAttribute("role","button"),Ee(v,{keydown:function(x){x.keyCode===13&&this._expandSafely()},click:function(x){Mt(x),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Me("div",o+"-base",g),this._separator=Me("div",o+"-separator",g),this._overlaysList=Me("div",o+"-overlays",g),l.appendChild(g)},_getLayer:function(o){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&c(this._layers[l].layer)===o)return this._layers[l]},_addLayer:function(o,l,f){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:l,overlay:f}),this.options.sortLayers&&this._layers.sort(a(function(g,v){return this.options.sortFunction(g.layer,v.layer,g.name,v.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Wn(this._baseLayersList),Wn(this._overlaysList),this._layerControlInputs=[];var o,l,f,g,v=0;for(f=0;f<this._layers.length;f++)g=this._layers[f],this._addItem(g),l=l||g.overlay,o=o||!g.overlay,v+=g.overlay?0:1;return this.options.hideSingleBase&&(o=o&&v>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=l&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var l=this._getLayer(c(o.target)),f=l.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;f&&this._map.fire(f,l)},_createRadioElement:function(o,l){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(l?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=f,g.firstChild},_addItem:function(o){var l=document.createElement("label"),f=this._map.hasLayer(o.layer),g;o.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=f):g=this._createRadioElement("leaflet-base-layers_"+c(this),f),this._layerControlInputs.push(g),g.layerId=c(o.layer),Ee(g,"click",this._onInputClick,this);var v=document.createElement("span");v.innerHTML=" "+o.name;var x=document.createElement("span");l.appendChild(x),x.appendChild(g),x.appendChild(v);var F=o.overlay?this._overlaysList:this._baseLayersList;return F.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,l,f,g=[],v=[];this._handlingClick=!0;for(var x=o.length-1;x>=0;x--)l=o[x],f=this._getLayer(l.layerId).layer,l.checked?g.push(f):l.checked||v.push(f);for(x=0;x<v.length;x++)this._map.hasLayer(v[x])&&this._map.removeLayer(v[x]);for(x=0;x<g.length;x++)this._map.hasLayer(g[x])||this._map.addLayer(g[x]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,l,f,g=this._map.getZoom(),v=o.length-1;v>=0;v--)l=o[v],f=this._getLayer(l.layerId).layer,l.disabled=f.options.minZoom!==void 0&&g<f.options.minZoom||f.options.maxZoom!==void 0&&g>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,Ee(o,"click",Mt),this.expand();var l=this;setTimeout(function(){Ue(o,"click",Mt),l._preventClick=!1})}}),Tg=function(o,l,f){return new To(o,l,f)},Oa=on.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var l="leaflet-control-zoom",f=Me("div",l+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,l+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,l+"-out",f,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,l,f,g,v){var x=Me("a",f,g);return x.innerHTML=o,x.href="#",x.title=l,x.setAttribute("role","button"),x.setAttribute("aria-label",l),Eo(x),Ee(x,"click",Hi),Ee(x,"click",v,this),Ee(x,"click",this._refocusOnMap,this),x},_updateDisabled:function(){var o=this._map,l="leaflet-disabled";_e(this._zoomInButton,l),_e(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(we(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(we(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Re.mergeOptions({zoomControl:!0}),Re.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Oa,this.addControl(this.zoomControl))});var xo=function(o){return new Oa(o)},zu=on.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var l="leaflet-control-scale",f=Me("div",l),g=this.options;return this._addScales(g,l+"-line",f),o.on(g.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),f},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,l,f){o.metric&&(this._mScale=Me("div",l,f)),o.imperial&&(this._iScale=Me("div",l,f))},_update:function(){var o=this._map,l=o.getSize().y/2,f=o.distance(o.containerPointToLatLng([0,l]),o.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(f)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var l=this._getRoundNum(o),f=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,f,l/o)},_updateImperial:function(o){var l=o*3.2808399,f,g,v;l>5280?(f=l/5280,g=this._getRoundNum(f),this._updateScale(this._iScale,g+" mi",g/f)):(v=this._getRoundNum(l),this._updateScale(this._iScale,v+" ft",v/l))},_updateScale:function(o,l,f){o.style.width=Math.round(this.options.maxWidth*f)+"px",o.innerHTML=l},_getRoundNum:function(o){var l=Math.pow(10,(Math.floor(o)+"").length-1),f=o/l;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,l*f}}),Ad=function(o){return new zu(o)},Wu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',So=on.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ae.inlineSvg?Wu+" ":"")+"Leaflet</a>"},initialize:function(o){b(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=Me("div","leaflet-control-attribution"),Eo(this._container);for(var l in o._layers)o._layers[l].getAttribution&&this.addAttribution(o._layers[l].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var l in this._attributions)this._attributions[l]&&o.push(l);var f=[];this.options.prefix&&f.push(this.options.prefix),o.length&&f.push(o.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Re.mergeOptions({attributionControl:!0}),Re.addInitHook(function(){this.options.attributionControl&&new So().addTo(this)});var Rd=function(o){return new So(o)};on.Layers=To,on.Zoom=Oa,on.Scale=zu,on.Attribution=So,hs.layers=Tg,hs.zoom=xo,hs.scale=Ad,hs.attribution=Rd;var yn=xe.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});yn.addTo=function(o,l){return o.addHandler(l,this),this};var bd={Events:Ge},Hu=ae.touch?"touchstart mousedown":"mousedown",an=he.extend({options:{clickTolerance:3},initialize:function(o,l,f,g){b(this,g),this._element=o,this._dragStartTarget=l||o,this._preventOutline=f},enable:function(){this._enabled||(Ee(this._dragStartTarget,Hu,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(an._dragging===this&&this.finishDrag(!0),Ue(this._dragStartTarget,Hu,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!Er(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){an._dragging===this&&this.finishDrag();return}if(!(an._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(an._dragging=this,this._preventOutline&&zi(this._element),Ra(),vo(),!this._moving)){this.fire("down");var l=o.touches?o.touches[0]:o,f=Pd(this._element);this._startPoint=new q(l.clientX,l.clientY),this._startPos=xr(this._element),this._parentScale=Vu(f);var g=o.type==="mousedown";Ee(document,g?"mousemove":"touchmove",this._onMove,this),Ee(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var l=o.touches&&o.touches.length===1?o.touches[0]:o,f=new q(l.clientX,l.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,Mt(o),this._moved||(this.fire("dragstart"),this._moved=!0,we(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),we(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),ft(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){_e(document.body,"leaflet-dragging"),this._lastTarget&&(_e(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ue(document,"mousemove touchmove",this._onMove,this),Ue(document,"mouseup touchend touchcancel",this._onUp,this),ba(),_i();var l=this._moved&&this._moving;this._moving=!1,an._dragging=!1,l&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function $u(o,l,f){var g,v=[1,4,2,8],x,F,H,G,Y,ne,de,Ie;for(x=0,ne=o.length;x<ne;x++)o[x]._code=z(o[x],l);for(H=0;H<4;H++){for(de=v[H],g=[],x=0,ne=o.length,F=ne-1;x<ne;F=x++)G=o[x],Y=o[F],G._code&de?Y._code&de||(Ie=P(Y,G,de,l,f),Ie._code=z(Ie,l),g.push(Ie)):(Y._code&de&&(Ie=P(Y,G,de,l,f),Ie._code=z(Ie,l),g.push(Ie)),g.push(G));o=g}return o}function qu(o,l){var f,g,v,x,F,H,G,Y,ne;if(!o||o.length===0)throw new Error("latlngs not passed");ue(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var de=ye([0,0]),Ie=Ve(o),vn=Ie.getNorthWest().distanceTo(Ie.getSouthWest())*Ie.getNorthEast().distanceTo(Ie.getNorthWest());vn<1700&&(de=Va(o));var zt=o.length,Jn=[];for(f=0;f<zt;f++){var Rn=ye(o[f]);Jn.push(l.project(ye([Rn.lat-de.lat,Rn.lng-de.lng])))}for(H=G=Y=0,f=0,g=zt-1;f<zt;g=f++)v=Jn[f],x=Jn[g],F=v.y*x.x-x.y*v.x,G+=(v.x+x.x)*F,Y+=(v.y+x.y)*F,H+=F*3;H===0?ne=Jn[0]:ne=[G/H,Y/H];var Wa=l.unproject(X(ne));return ye([Wa.lat+de.lat,Wa.lng+de.lng])}function Va(o){for(var l=0,f=0,g=0,v=0;v<o.length;v++){var x=ye(o[v]);l+=x.lat,f+=x.lng,g++}return ye([l/g,f/g])}var kd={__proto__:null,clipPolygon:$u,polygonCenter:qu,centroid:Va};function Co(o,l){if(!l||!o.length)return o.slice();var f=l*l;return o=d(o,f),o=Ld(o,f),o}function ln(o,l,f){return Math.sqrt(te(o,l,f,!0))}function Nd(o,l,f){return te(o,l,f)}function Ld(o,l){var f=o.length,g=typeof Uint8Array!=void 0+""?Uint8Array:Array,v=new g(f);v[0]=v[f-1]=1,$i(o,v,l,0,f-1);var x,F=[];for(x=0;x<f;x++)v[x]&&F.push(o[x]);return F}function $i(o,l,f,g,v){var x=0,F,H,G;for(H=g+1;H<=v-1;H++)G=te(o[H],o[g],o[v],!0),G>x&&(F=H,x=G);x>f&&(l[F]=1,$i(o,l,f,g,F),$i(o,l,f,F,v))}function d(o,l){for(var f=[o[0]],g=1,v=0,x=o.length;g<x;g++)$(o[g],o[v])>l&&(f.push(o[g]),v=g);return v<x-1&&f.push(o[x-1]),f}var y;function w(o,l,f,g,v){var x=g?y:z(o,f),F=z(l,f),H,G,Y;for(y=F;;){if(!(x|F))return[o,l];if(x&F)return!1;H=x||F,G=P(o,l,H,f,v),Y=z(G,f),H===x?(o=G,x=Y):(l=G,F=Y)}}function P(o,l,f,g,v){var x=l.x-o.x,F=l.y-o.y,H=g.min,G=g.max,Y,ne;return f&8?(Y=o.x+x*(G.y-o.y)/F,ne=G.y):f&4?(Y=o.x+x*(H.y-o.y)/F,ne=H.y):f&2?(Y=G.x,ne=o.y+F*(G.x-o.x)/x):f&1&&(Y=H.x,ne=o.y+F*(H.x-o.x)/x),new q(Y,ne,v)}function z(o,l){var f=0;return o.x<l.min.x?f|=1:o.x>l.max.x&&(f|=2),o.y<l.min.y?f|=4:o.y>l.max.y&&(f|=8),f}function $(o,l){var f=l.x-o.x,g=l.y-o.y;return f*f+g*g}function te(o,l,f,g){var v=l.x,x=l.y,F=f.x-v,H=f.y-x,G=F*F+H*H,Y;return G>0&&(Y=((o.x-v)*F+(o.y-x)*H)/G,Y>1?(v=f.x,x=f.y):Y>0&&(v+=F*Y,x+=H*Y)),F=o.x-v,H=o.y-x,g?F*F+H*H:new q(v,x)}function ue(o){return!R(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function pt(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ue(o)}function ze(o,l){var f,g,v,x,F,H,G,Y;if(!o||o.length===0)throw new Error("latlngs not passed");ue(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var ne=ye([0,0]),de=Ve(o),Ie=de.getNorthWest().distanceTo(de.getSouthWest())*de.getNorthEast().distanceTo(de.getNorthWest());Ie<1700&&(ne=Va(o));var vn=o.length,zt=[];for(f=0;f<vn;f++){var Jn=ye(o[f]);zt.push(l.project(ye([Jn.lat-ne.lat,Jn.lng-ne.lng])))}for(f=0,g=0;f<vn-1;f++)g+=zt[f].distanceTo(zt[f+1])/2;if(g===0)Y=zt[0];else for(f=0,x=0;f<vn-1;f++)if(F=zt[f],H=zt[f+1],v=F.distanceTo(H),x+=v,x>g){G=(x-g)/v,Y=[H.x-G*(H.x-F.x),H.y-G*(H.y-F.y)];break}var Rn=l.unproject(X(Y));return ye([Rn.lat+ne.lat,Rn.lng+ne.lng])}var xt={__proto__:null,simplify:Co,pointToSegmentDistance:ln,closestPointOnSegment:Nd,clipSegment:w,_getEdgeIntersection:P,_getBitCode:z,_sqClosestPointOnSegment:te,isFlat:ue,_flat:pt,polylineCenter:ze},An={project:function(o){return new q(o.lng,o.lat)},unproject:function(o){return new Ne(o.y,o.x)},bounds:new le([-180,-90],[180,90])},Ei={R:6378137,R_MINOR:6356752314245179e-9,bounds:new le([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var l=Math.PI/180,f=this.R,g=o.lat*l,v=this.R_MINOR/f,x=Math.sqrt(1-v*v),F=x*Math.sin(g),H=Math.tan(Math.PI/4-g/2)/Math.pow((1-F)/(1+F),x/2);return g=-f*Math.log(Math.max(H,1e-10)),new q(o.lng*l*f,g)},unproject:function(o){for(var l=180/Math.PI,f=this.R,g=this.R_MINOR/f,v=Math.sqrt(1-g*g),x=Math.exp(-o.y/f),F=Math.PI/2-2*Math.atan(x),H=0,G=.1,Y;H<15&&Math.abs(G)>1e-7;H++)Y=v*Math.sin(F),Y=Math.pow((1-Y)/(1+Y),v/2),G=Math.PI/2-2*Math.atan(x*Y)-F,F+=G;return new Ne(F*l,o.x*l/f)}},qi={__proto__:null,LonLat:An,Mercator:Ei,SphericalMercator:va},Gi=r({},Yn,{code:"EPSG:3395",projection:Ei,transformation:function(){var o=.5/(Math.PI*Ei.R);return is(o,.5,-o,.5)}()}),Io=r({},Yn,{code:"EPSG:4326",projection:An,transformation:is(1/180,1,-1/180,.5)}),Gu=r({},Ut,{projection:An,transformation:is(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,l){var f=l.lng-o.lng,g=l.lat-o.lat;return Math.sqrt(f*f+g*g)},infinite:!0});Ut.Earth=Yn,Ut.EPSG3395=Gi,Ut.EPSG3857=wa,Ut.EPSG900913=Eu,Ut.EPSG4326=Io,Ut.Simple=Gu;var Ti=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[c(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[c(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var l=o.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var f=this.getEvents();l.on(f,this),this.once("remove",function(){l.off(f,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Re.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var l=c(o);return this._layers[l]?this:(this._layers[l]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var l=c(o);return this._layers[l]?(this._loaded&&o.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return c(o)in this._layers},eachLayer:function(o,l){for(var f in this._layers)o.call(l,this._layers[f]);return this},_addLayers:function(o){o=o?R(o)?o:[o]:[];for(var l=0,f=o.length;l<f;l++)this.addLayer(o[l])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[c(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var l=c(o);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,l=-1/0,f=this._getZoomSpan();for(var g in this._zoomBoundLayers){var v=this._zoomBoundLayers[g].options;o=v.minZoom===void 0?o:Math.min(o,v.minZoom),l=v.maxZoom===void 0?l:Math.max(l,v.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=o===1/0?void 0:o,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Fa=Ti.extend({initialize:function(o,l){b(this,l),this._layers={};var f,g;if(o)for(f=0,g=o.length;f<g;f++)this.addLayer(o[f])},addLayer:function(o){var l=this.getLayerId(o);return this._layers[l]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var l=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(o){var l=typeof o=="number"?o:this.getLayerId(o);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var l=Array.prototype.slice.call(arguments,1),f,g;for(f in this._layers)g=this._layers[f],g[o]&&g[o].apply(g,l);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,l){for(var f in this._layers)o.call(l,this._layers[f]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return c(o)}}),fD=function(o,l){return new Fa(o,l)},Ir=Fa.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Fa.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Fa.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new nt;for(var l in this._layers){var f=this._layers[l];o.extend(f.getBounds?f.getBounds():f.getLatLng())}return o}}),pD=function(o,l){return new Ir(o,l)},ja=xe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){b(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,l){var f=this._getIconUrl(o);if(!f){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(f,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(g,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(o,l){var f=this.options,g=f[l+"Size"];typeof g=="number"&&(g=[g,g]);var v=X(g),x=X(l==="shadow"&&f.shadowAnchor||f.iconAnchor||v&&v.divideBy(2,!0));o.className="leaflet-marker-"+l+" "+(f.className||""),x&&(o.style.marginLeft=-x.x+"px",o.style.marginTop=-x.y+"px"),v&&(o.style.width=v.x+"px",o.style.height=v.y+"px")},_createImg:function(o,l){return l=l||document.createElement("img"),l.src=o,l},_getIconUrl:function(o){return ae.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function mD(o){return new ja(o)}var Ku=ja.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Ku.imagePath!="string"&&(Ku.imagePath=this._detectIconPath()),(this.options.imagePath||Ku.imagePath)+ja.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var l=function(f,g,v){var x=g.exec(f);return x&&x[v]};return o=l(o,/^url\((['"])?(.+)\1\)$/,2),o&&l(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=Me("div","leaflet-default-icon-path",document.body),l=as(o,"background-image")||as(o,"backgroundImage");if(document.body.removeChild(o),l=this._stripUrl(l),l)return l;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),XE=yn.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new an(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),we(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_e(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var l=this._marker,f=l._map,g=this._marker.options.autoPanSpeed,v=this._marker.options.autoPanPadding,x=xr(l._icon),F=f.getPixelBounds(),H=f.getPixelOrigin(),G=Se(F.min._subtract(H).add(v),F.max._subtract(H).subtract(v));if(!G.contains(x)){var Y=X((Math.max(G.max.x,x.x)-G.max.x)/(F.max.x-G.max.x)-(Math.min(G.min.x,x.x)-G.min.x)/(F.min.x-G.min.x),(Math.max(G.max.y,x.y)-G.max.y)/(F.max.y-G.max.y)-(Math.min(G.min.y,x.y)-G.min.y)/(F.min.y-G.min.y)).multiplyBy(g);f.panBy(Y,{animate:!1}),this._draggable._newPos._add(Y),this._draggable._startPos._add(Y),ft(l._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=M(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,o)))},_onDrag:function(o){var l=this._marker,f=l._shadow,g=xr(l._icon),v=l._map.layerPointToLatLng(g);f&&ft(f,g),l._latlng=v,o.latlng=v,o.oldLatLng=this._oldLatLng,l.fire("move",o).fire("drag",o)},_onDragEnd:function(o){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Dd=Ti.extend({options:{icon:new Ku,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,l){b(this,l),this._latlng=ye(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var l=this._latlng;return this._latlng=ye(o),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=o.icon.createIcon(this._icon),g=!1;f!==this._icon&&(this._icon&&this._removeIcon(),g=!0,o.title&&(f.title=o.title),f.tagName==="IMG"&&(f.alt=o.alt||"")),we(f,l),o.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ee(f,"focus",this._panOnFocus,this);var v=o.icon.createShadow(this._shadow),x=!1;v!==this._shadow&&(this._removeShadow(),x=!0),v&&(we(v,l),v.alt=""),this._shadow=v,o.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),v&&x&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ue(this._icon,"focus",this._panOnFocus,this),Ye(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ye(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&ft(this._icon,o),this._shadow&&ft(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var l=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(we(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),XE)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new XE(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&Bt(this._icon,o),this._shadow&&Bt(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var l=this.options.icon.options,f=l.iconSize?X(l.iconSize):X(0,0),g=l.iconAnchor?X(l.iconAnchor):X(0,0);o.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:f.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function gD(o,l){return new Dd(o,l)}var ds=Ti.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return b(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Md=ds.extend({options:{fill:!0,radius:10},initialize:function(o,l){b(this,l),this._latlng=ye(o),this._radius=this.options.radius},setLatLng:function(o){var l=this._latlng;return this._latlng=ye(o),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var l=o&&o.radius||this._radius;return ds.prototype.setStyle.call(this,o),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,l=this._radiusY||o,f=this._clickTolerance(),g=[o+f,l+f];this._pxBounds=new le(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function _D(o,l){return new Md(o,l)}var xg=Md.extend({initialize:function(o,l,f){if(typeof l=="number"&&(l=r({},f,{radius:l})),b(this,l),this._latlng=ye(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new nt(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:ds.prototype.setStyle,_project:function(){var o=this._latlng.lng,l=this._latlng.lat,f=this._map,g=f.options.crs;if(g.distance===Yn.distance){var v=Math.PI/180,x=this._mRadius/Yn.R/v,F=f.project([l+x,o]),H=f.project([l-x,o]),G=F.add(H).divideBy(2),Y=f.unproject(G).lat,ne=Math.acos((Math.cos(x*v)-Math.sin(l*v)*Math.sin(Y*v))/(Math.cos(l*v)*Math.cos(Y*v)))/v;(isNaN(ne)||ne===0)&&(ne=x/Math.cos(Math.PI/180*l)),this._point=G.subtract(f.getPixelOrigin()),this._radius=isNaN(ne)?0:G.x-f.project([Y,o-ne]).x,this._radiusY=G.y-F.y}else{var de=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(de).x}this._updateBounds()}});function yD(o,l,f){return new xg(o,l,f)}var Pr=ds.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,l){b(this,l),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var l=1/0,f=null,g=te,v,x,F=0,H=this._parts.length;F<H;F++)for(var G=this._parts[F],Y=1,ne=G.length;Y<ne;Y++){v=G[Y-1],x=G[Y];var de=g(o,v,x,!0);de<l&&(l=de,f=g(o,v,x))}return f&&(f.distance=Math.sqrt(l)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ze(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,l){return l=l||this._defaultShape(),o=ye(o),l.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new nt,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return ue(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var l=[],f=ue(o),g=0,v=o.length;g<v;g++)f?(l[g]=ye(o[g]),this._bounds.extend(l[g])):l[g]=this._convertLatLngs(o[g]);return l},_project:function(){var o=new le;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),l=new q(o,o);this._rawPxBounds&&(this._pxBounds=new le([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(o,l,f){var g=o[0]instanceof Ne,v=o.length,x,F;if(g){for(F=[],x=0;x<v;x++)F[x]=this._map.latLngToLayerPoint(o[x]),f.extend(F[x]);l.push(F)}else for(x=0;x<v;x++)this._projectLatlngs(o[x],l,f)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,f,g,v,x,F,H,G;for(f=0,v=0,x=this._rings.length;f<x;f++)for(G=this._rings[f],g=0,F=G.length;g<F-1;g++)H=w(G[g],G[g+1],o,g,!0),H&&(l[v]=l[v]||[],l[v].push(H[0]),(H[1]!==G[g+1]||g===F-2)&&(l[v].push(H[1]),v++))}},_simplifyPoints:function(){for(var o=this._parts,l=this.options.smoothFactor,f=0,g=o.length;f<g;f++)o[f]=Co(o[f],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,l){var f,g,v,x,F,H,G=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(f=0,x=this._parts.length;f<x;f++)for(H=this._parts[f],g=0,F=H.length,v=F-1;g<F;v=g++)if(!(!l&&g===0)&&ln(o,H[v],H[g])<=G)return!0;return!1}});function vD(o,l){return new Pr(o,l)}Pr._flat=pt;var Ua=Pr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var l=Pr.prototype._convertLatLngs.call(this,o),f=l.length;return f>=2&&l[0]instanceof Ne&&l[0].equals(l[f-1])&&l.pop(),l},_setLatLngs:function(o){Pr.prototype._setLatLngs.call(this,o),ue(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ue(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,l=this.options.weight,f=new q(l,l);if(o=new le(o.min.subtract(f),o.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,v=this._rings.length,x;g<v;g++)x=$u(this._rings[g],o,!0),x.length&&this._parts.push(x)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var l=!1,f,g,v,x,F,H,G,Y;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(x=0,G=this._parts.length;x<G;x++)for(f=this._parts[x],F=0,Y=f.length,H=Y-1;F<Y;H=F++)g=f[F],v=f[H],g.y>o.y!=v.y>o.y&&o.x<(v.x-g.x)*(o.y-g.y)/(v.y-g.y)+g.x&&(l=!l);return l||Pr.prototype._containsPoint.call(this,o,!0)}});function wD(o,l){return new Ua(o,l)}var Ar=Ir.extend({initialize:function(o,l){b(this,l),this._layers={},o&&this.addData(o)},addData:function(o){var l=R(o)?o:o.features,f,g,v;if(l){for(f=0,g=l.length;f<g;f++)v=l[f],(v.geometries||v.geometry||v.features||v.coordinates)&&this.addData(v);return this}var x=this.options;if(x.filter&&!x.filter(o))return this;var F=Od(o,x);return F?(F.feature=jd(o),F.defaultOptions=F.options,this.resetStyle(F),x.onEachFeature&&x.onEachFeature(o,F),this.addLayer(F)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=r({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(l){this._setLayerStyle(l,o)},this)},_setLayerStyle:function(o,l){o.setStyle&&(typeof l=="function"&&(l=l(o.feature)),o.setStyle(l))}});function Od(o,l){var f=o.type==="Feature"?o.geometry:o,g=f?f.coordinates:null,v=[],x=l&&l.pointToLayer,F=l&&l.coordsToLatLng||Sg,H,G,Y,ne;if(!g&&!f)return null;switch(f.type){case"Point":return H=F(g),JE(x,o,H,l);case"MultiPoint":for(Y=0,ne=g.length;Y<ne;Y++)H=F(g[Y]),v.push(JE(x,o,H,l));return new Ir(v);case"LineString":case"MultiLineString":return G=Vd(g,f.type==="LineString"?0:1,F),new Pr(G,l);case"Polygon":case"MultiPolygon":return G=Vd(g,f.type==="Polygon"?1:2,F),new Ua(G,l);case"GeometryCollection":for(Y=0,ne=f.geometries.length;Y<ne;Y++){var de=Od({geometry:f.geometries[Y],type:"Feature",properties:o.properties},l);de&&v.push(de)}return new Ir(v);case"FeatureCollection":for(Y=0,ne=f.features.length;Y<ne;Y++){var Ie=Od(f.features[Y],l);Ie&&v.push(Ie)}return new Ir(v);default:throw new Error("Invalid GeoJSON object.")}}function JE(o,l,f,g){return o?o(l,f):new Dd(f,g&&g.markersInheritOptions&&g)}function Sg(o){return new Ne(o[1],o[0],o[2])}function Vd(o,l,f){for(var g=[],v=0,x=o.length,F;v<x;v++)F=l?Vd(o[v],l-1,f):(f||Sg)(o[v]),g.push(F);return g}function Cg(o,l){return o=ye(o),o.alt!==void 0?[_(o.lng,l),_(o.lat,l),_(o.alt,l)]:[_(o.lng,l),_(o.lat,l)]}function Fd(o,l,f,g){for(var v=[],x=0,F=o.length;x<F;x++)v.push(l?Fd(o[x],ue(o[x])?0:l-1,f,g):Cg(o[x],g));return!l&&f&&v.length>0&&v.push(v[0].slice()),v}function Ba(o,l){return o.feature?r({},o.feature,{geometry:l}):jd(l)}function jd(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Ig={toGeoJSON:function(o){return Ba(this,{type:"Point",coordinates:Cg(this.getLatLng(),o)})}};Dd.include(Ig),xg.include(Ig),Md.include(Ig),Pr.include({toGeoJSON:function(o){var l=!ue(this._latlngs),f=Fd(this._latlngs,l?1:0,!1,o);return Ba(this,{type:(l?"Multi":"")+"LineString",coordinates:f})}}),Ua.include({toGeoJSON:function(o){var l=!ue(this._latlngs),f=l&&!ue(this._latlngs[0]),g=Fd(this._latlngs,f?2:l?1:0,!0,o);return l||(g=[g]),Ba(this,{type:(f?"Multi":"")+"Polygon",coordinates:g})}}),Fa.include({toMultiPoint:function(o){var l=[];return this.eachLayer(function(f){l.push(f.toGeoJSON(o).geometry.coordinates)}),Ba(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(o){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(o);var f=l==="GeometryCollection",g=[];return this.eachLayer(function(v){if(v.toGeoJSON){var x=v.toGeoJSON(o);if(f)g.push(x.geometry);else{var F=jd(x);F.type==="FeatureCollection"?g.push.apply(g,F.features):g.push(F)}}}),f?Ba(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function eT(o,l){return new Ar(o,l)}var ED=eT,Ud=Ti.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,l,f){this._url=o,this._bounds=Ve(l),b(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(we(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ye(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Xt(this._image),this},bringToBack:function(){return this._map&&Xn(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=Ve(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",l=this._image=o?this._url:Me("img");if(we(l,"leaflet-image-layer"),this._zoomAnimated&&we(l,"leaflet-zoom-animated"),this.options.className&&we(l,this.options.className),l.onselectstart=m,l.onmousemove=m,l.onload=a(this.fire,this,"load"),l.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(o){var l=this._map.getZoomScale(o.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;Tr(this._image,f,l)},_reset:function(){var o=this._image,l=new le(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=l.getSize();ft(o,l.min),o.style.width=f.x+"px",o.style.height=f.y+"px"},_updateOpacity:function(){Bt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),TD=function(o,l,f){return new Ud(o,l,f)},tT=Ud.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",l=this._image=o?this._url:Me("video");if(we(l,"leaflet-image-layer"),this._zoomAnimated&&we(l,"leaflet-zoom-animated"),this.options.className&&we(l,this.options.className),l.onselectstart=m,l.onmousemove=m,l.onloadeddata=a(this.fire,this,"load"),o){for(var f=l.getElementsByTagName("source"),g=[],v=0;v<f.length;v++)g.push(f[v].src);this._url=f.length>0?g:[l.src];return}R(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var x=0;x<this._url.length;x++){var F=Me("source");F.src=this._url[x],l.appendChild(F)}}});function xD(o,l,f){return new tT(o,l,f)}var nT=Ud.extend({_initImage:function(){var o=this._image=this._url;we(o,"leaflet-image-layer"),this._zoomAnimated&&we(o,"leaflet-zoom-animated"),this.options.className&&we(o,this.options.className),o.onselectstart=m,o.onmousemove=m}});function SD(o,l,f){return new nT(o,l,f)}var Ki=Ti.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,l){o&&(o instanceof Ne||R(o))?(this._latlng=ye(o),b(this,l)):(b(this,o),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Bt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Bt(this._container,1),this.bringToFront(),this.options.interactive&&(we(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(Bt(this._container,0),this._removeTimeout=setTimeout(a(Ye,void 0,this._container),200)):Ye(this._container),this.options.interactive&&(_e(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=ye(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Xt(this._container),this},bringToBack:function(){return this._map&&Xn(this._container),this},_prepareOpen:function(o){var l=this._source;if(!l._map)return!1;if(l instanceof Ir){l=null;var f=this._source._layers;for(var g in f)if(f[g]._map){l=f[g];break}if(!l)return!1;this._source=l}if(!o)if(l.getCenter)o=l.getCenter();else if(l.getLatLng)o=l.getLatLng();else if(l.getBounds)o=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")o.innerHTML=l;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),l=X(this.options.offset),f=this._getAnchor();this._zoomAnimated?ft(this._container,o.add(f)):l=l.add(o).add(f);var g=this._containerBottom=-l.y,v=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=g+"px",this._container.style.left=v+"px"}},_getAnchor:function(){return[0,0]}});Re.include({_initOverlay:function(o,l,f,g){var v=l;return v instanceof o||(v=new o(g).setContent(l)),f&&v.setLatLng(f),v}}),Ti.include({_initOverlay:function(o,l,f,g){var v=f;return v instanceof o?(b(v,g),v._source=this):(v=l&&!g?l:new o(g,this),v.setContent(f)),v}});var Bd=Ki.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,Ki.prototype.openOn.call(this,o)},onAdd:function(o){Ki.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ds||this._source.on("preclick",vi))},onRemove:function(o){Ki.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ds||this._source.off("preclick",vi))},getEvents:function(){var o=Ki.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",l=this._container=Me("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Me("div",o+"-content-wrapper",l);if(this._contentNode=Me("div",o+"-content",f),Eo(l),Ke(this._contentNode),Ee(l,"contextmenu",vi),this._tipContainer=Me("div",o+"-tip-container",l),this._tip=Me("div",o+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=Me("a",o+"-close-button",l);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',Ee(g,"click",function(v){Mt(v),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,l=o.style;l.width="",l.whiteSpace="nowrap";var f=o.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),l.width=f+1+"px",l.whiteSpace="",l.height="";var g=o.offsetHeight,v=this.options.maxHeight,x="leaflet-popup-scrolled";v&&g>v?(l.height=v+"px",we(o,x)):_e(o,x),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var l=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),f=this._getAnchor();ft(this._container,l.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,l=parseInt(as(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+l,g=this._containerWidth,v=new q(this._containerLeft,-f-this._containerBottom);v._add(xr(this._container));var x=o.layerPointToContainerPoint(v),F=X(this.options.autoPanPadding),H=X(this.options.autoPanPaddingTopLeft||F),G=X(this.options.autoPanPaddingBottomRight||F),Y=o.getSize(),ne=0,de=0;x.x+g+G.x>Y.x&&(ne=x.x+g-Y.x+G.x),x.x-ne-H.x<0&&(ne=x.x-H.x),x.y+f+G.y>Y.y&&(de=x.y+f-Y.y+G.y),x.y-de-H.y<0&&(de=x.y-H.y),(ne||de)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([ne,de]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),CD=function(o,l){return new Bd(o,l)};Re.mergeOptions({closePopupOnClick:!0}),Re.include({openPopup:function(o,l,f){return this._initOverlay(Bd,o,l,f).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),Ti.include({bindPopup:function(o,l){return this._popup=this._initOverlay(Bd,this._popup,o,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Ir||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){Hi(o);var l=o.layer||o.target;if(this._popup._source===l&&!(l instanceof ds)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=l,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var zd=Ki.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){Ki.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){Ki.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=Ki.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",l=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var l,f,g=this._map,v=this._container,x=g.latLngToContainerPoint(g.getCenter()),F=g.layerPointToContainerPoint(o),H=this.options.direction,G=v.offsetWidth,Y=v.offsetHeight,ne=X(this.options.offset),de=this._getAnchor();H==="top"?(l=G/2,f=Y):H==="bottom"?(l=G/2,f=0):H==="center"?(l=G/2,f=Y/2):H==="right"?(l=0,f=Y/2):H==="left"?(l=G,f=Y/2):F.x<x.x?(H="right",l=0,f=Y/2):(H="left",l=G+(ne.x+de.x)*2,f=Y/2),o=o.subtract(X(l,f,!0)).add(ne).add(de),_e(v,"leaflet-tooltip-right"),_e(v,"leaflet-tooltip-left"),_e(v,"leaflet-tooltip-top"),_e(v,"leaflet-tooltip-bottom"),we(v,"leaflet-tooltip-"+H),ft(v,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Bt(this._container,o)},_animateZoom:function(o){var l=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(l)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),ID=function(o,l){return new zd(o,l)};Re.include({openTooltip:function(o,l,f){return this._initOverlay(zd,o,l,f).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),Ti.include({bindTooltip:function(o,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(zd,this._tooltip,o,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var l=o?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[l](f),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Ir||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var l=typeof o.getElement=="function"&&o.getElement();l&&(Ee(l,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),Ee(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var l=typeof o.getElement=="function"&&o.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var l=o.latlng,f,g;this._tooltip.options.sticky&&o.originalEvent&&(f=this._map.mouseEventToContainerPoint(o.originalEvent),g=this._map.containerPointToLayerPoint(f),l=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(l)}});var iT=ja.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var l=o&&o.tagName==="DIV"?o:document.createElement("div"),f=this.options;if(f.html instanceof Element?(Wn(l),l.appendChild(f.html)):l.innerHTML=f.html!==!1?f.html:"",f.bgPos){var g=X(f.bgPos);l.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function PD(o){return new iT(o)}ja.Default=Ku;var Zu=Ti.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ae.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){b(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),Ye(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Xt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Xn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof q?o:new q(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var l=this.getPane().children,f=-o(-1/0,1/0),g=0,v=l.length,x;g<v;g++)x=l[g].style.zIndex,l[g]!==this._container&&x&&(f=o(f,+x));isFinite(f)&&(this.options.zIndex=f+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ae.ielt9){Bt(this._container,this.options.opacity);var o=+new Date,l=!1,f=!1;for(var g in this._tiles){var v=this._tiles[g];if(!(!v.current||!v.loaded)){var x=Math.min(1,(o-v.loaded)/200);Bt(v.el,x),x<1?l=!0:(v.active?f=!0:this._onOpaqueTile(v),v.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),l&&(j(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,l=this.options.maxZoom;if(o!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===o?(this._levels[f].el.style.zIndex=l-Math.abs(o-f),this._onUpdateLevel(f)):(Ye(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var g=this._levels[o],v=this._map;return g||(g=this._levels[o]={},g.el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=l,g.origin=v.project(v.unproject(v.getPixelOrigin()),o).round(),g.zoom=o,this._setZoomTransform(g,v.getCenter(),v.getZoom()),m(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var o,l,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)l=this._tiles[o],l.retain=l.current;for(o in this._tiles)if(l=this._tiles[o],l.current&&!l.active){var g=l.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var l in this._tiles)this._tiles[l].coords.z===o&&this._removeTile(l)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)Ye(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,l,f,g){var v=Math.floor(o/2),x=Math.floor(l/2),F=f-1,H=new q(+v,+x);H.z=+F;var G=this._tileCoordsToKey(H),Y=this._tiles[G];return Y&&Y.active?(Y.retain=!0,!0):(Y&&Y.loaded&&(Y.retain=!0),F>g?this._retainParent(v,x,F,g):!1)},_retainChildren:function(o,l,f,g){for(var v=2*o;v<2*o+2;v++)for(var x=2*l;x<2*l+2;x++){var F=new q(v,x);F.z=f+1;var H=this._tileCoordsToKey(F),G=this._tiles[H];if(G&&G.active){G.retain=!0;continue}else G&&G.loaded&&(G.retain=!0);f+1<g&&this._retainChildren(v,x,f+1,g)}},_resetView:function(o){var l=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var l=this.options;return l.minNativeZoom!==void 0&&o<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<o?l.maxNativeZoom:o},_setView:function(o,l,f,g){var v=Math.round(l);this.options.maxZoom!==void 0&&v>this.options.maxZoom||this.options.minZoom!==void 0&&v<this.options.minZoom?v=void 0:v=this._clampZoom(v);var x=this.options.updateWhenZooming&&v!==this._tileZoom;(!g||x)&&(this._tileZoom=v,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),v!==void 0&&this._update(o),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(o,l)},_setZoomTransforms:function(o,l){for(var f in this._levels)this._setZoomTransform(this._levels[f],o,l)},_setZoomTransform:function(o,l,f){var g=this._map.getZoomScale(f,o.zoom),v=o.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(l,f)).round();ae.any3d?Tr(o.el,v,g):ft(o.el,v)},_resetGrid:function(){var o=this._map,l=o.options.crs,f=this._tileSize=this.getTileSize(),g=this._tileZoom,v=this._map.getPixelWorldBounds(this._tileZoom);v&&(this._globalTileRange=this._pxBoundsToTileRange(v)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,l.wrapLng[0]],g).x/f.x),Math.ceil(o.project([0,l.wrapLng[1]],g).x/f.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([l.wrapLat[0],0],g).y/f.x),Math.ceil(o.project([l.wrapLat[1],0],g).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var l=this._map,f=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),g=l.getZoomScale(f,this._tileZoom),v=l.project(o,this._tileZoom).floor(),x=l.getSize().divideBy(g*2);return new le(v.subtract(x),v.add(x))},_update:function(o){var l=this._map;if(l){var f=this._clampZoom(l.getZoom());if(o===void 0&&(o=l.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(o),v=this._pxBoundsToTileRange(g),x=v.getCenter(),F=[],H=this.options.keepBuffer,G=new le(v.getBottomLeft().subtract([H,-H]),v.getTopRight().add([H,-H]));if(!(isFinite(v.min.x)&&isFinite(v.min.y)&&isFinite(v.max.x)&&isFinite(v.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Y in this._tiles){var ne=this._tiles[Y].coords;(ne.z!==this._tileZoom||!G.contains(new q(ne.x,ne.y)))&&(this._tiles[Y].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(o,f);return}for(var de=v.min.y;de<=v.max.y;de++)for(var Ie=v.min.x;Ie<=v.max.x;Ie++){var vn=new q(Ie,de);if(vn.z=this._tileZoom,!!this._isValidTile(vn)){var zt=this._tiles[this._tileCoordsToKey(vn)];zt?zt.current=!0:F.push(vn)}}if(F.sort(function(Rn,Wa){return Rn.distanceTo(x)-Wa.distanceTo(x)}),F.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Jn=document.createDocumentFragment();for(Ie=0;Ie<F.length;Ie++)this._addTile(F[Ie],Jn);this._level.el.appendChild(Jn)}}}},_isValidTile:function(o){var l=this._map.options.crs;if(!l.infinite){var f=this._globalTileRange;if(!l.wrapLng&&(o.x<f.min.x||o.x>f.max.x)||!l.wrapLat&&(o.y<f.min.y||o.y>f.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(o);return Ve(this.options.bounds).overlaps(g)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var l=this._map,f=this.getTileSize(),g=o.scaleBy(f),v=g.add(f),x=l.unproject(g,o.z),F=l.unproject(v,o.z);return[x,F]},_tileCoordsToBounds:function(o){var l=this._tileCoordsToNwSe(o),f=new nt(l[0],l[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var l=o.split(":"),f=new q(+l[0],+l[1]);return f.z=+l[2],f},_removeTile:function(o){var l=this._tiles[o];l&&(Ye(l.el),delete this._tiles[o],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){we(o,"leaflet-tile");var l=this.getTileSize();o.style.width=l.x+"px",o.style.height=l.y+"px",o.onselectstart=m,o.onmousemove=m,ae.ielt9&&this.options.opacity<1&&Bt(o,this.options.opacity)},_addTile:function(o,l){var f=this._getTilePos(o),g=this._tileCoordsToKey(o),v=this.createTile(this._wrapCoords(o),a(this._tileReady,this,o));this._initTile(v),this.createTile.length<2&&M(a(this._tileReady,this,o,null,v)),ft(v,f),this._tiles[g]={el:v,coords:o,current:!0},l.appendChild(v),this.fire("tileloadstart",{tile:v,coords:o})},_tileReady:function(o,l,f){l&&this.fire("tileerror",{error:l,tile:f,coords:o});var g=this._tileCoordsToKey(o);f=this._tiles[g],f&&(f.loaded=+new Date,this._map._fadeAnimated?(Bt(f.el,0),j(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),l||(we(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ae.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var l=new q(this._wrapX?p(o.x,this._wrapX):o.x,this._wrapY?p(o.y,this._wrapY):o.y);return l.z=o.z,l},_pxBoundsToTileRange:function(o){var l=this.getTileSize();return new le(o.min.unscaleBy(l).floor(),o.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function AD(o){return new Zu(o)}var za=Zu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,l){this._url=o,l=b(this,l),l.detectRetina&&ae.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,l){return this._url===o&&l===void 0&&(l=!0),this._url=o,l||this.redraw(),this},createTile:function(o,l){var f=document.createElement("img");return Ee(f,"load",a(this._tileOnLoad,this,l,f)),Ee(f,"error",a(this._tileOnError,this,l,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(o),f},getTileUrl:function(o){var l={r:ae.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-o.y;this.options.tms&&(l.y=f),l["-y"]=f}return S(this._url,r(l,this.options))},_tileOnLoad:function(o,l){ae.ielt9?setTimeout(a(o,this,null,l),0):o(null,l)},_tileOnError:function(o,l,f){var g=this.options.errorTileUrl;g&&l.getAttribute("src")!==g&&(l.src=g),o(f,l)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,l=this.options.maxZoom,f=this.options.zoomReverse,g=this.options.zoomOffset;return f&&(o=l-o),o+g},_getSubdomain:function(o){var l=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var o,l;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(l=this._tiles[o].el,l.onload=m,l.onerror=m,!l.complete)){l.src=W;var f=this._tiles[o].coords;Ye(l),delete this._tiles[o],this.fire("tileabort",{tile:l,coords:f})}},_removeTile:function(o){var l=this._tiles[o];if(l)return l.el.setAttribute("src",W),Zu.prototype._removeTile.call(this,o)},_tileReady:function(o,l,f){if(!(!this._map||f&&f.getAttribute("src")===W))return Zu.prototype._tileReady.call(this,o,l,f)}});function rT(o,l){return new za(o,l)}var sT=za.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,l){this._url=o;var f=r({},this.defaultWmsParams);for(var g in l)g in this.options||(f[g]=l[g]);l=b(this,l);var v=l.detectRetina&&ae.retina?2:1,x=this.getTileSize();f.width=x.x*v,f.height=x.y*v,this.wmsParams=f},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,za.prototype.onAdd.call(this,o)},getTileUrl:function(o){var l=this._tileCoordsToNwSe(o),f=this._crs,g=Se(f.project(l[0]),f.project(l[1])),v=g.min,x=g.max,F=(this._wmsVersion>=1.3&&this._crs===Io?[v.y,v.x,x.y,x.x]:[v.x,v.y,x.x,x.y]).join(","),H=za.prototype.getTileUrl.call(this,o);return H+V(this.wmsParams,H,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+F},setParams:function(o,l){return r(this.wmsParams,o),l||this.redraw(),this}});function RD(o,l){return new sT(o,l)}za.WMS=sT,rT.wms=RD;var Rr=Ti.extend({options:{padding:.1},initialize:function(o){b(this,o),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),we(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,l){var f=this._map.getZoomScale(l,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,l),x=g.multiplyBy(-f).add(v).subtract(this._map._getNewPixelOrigin(o,l));ae.any3d?Tr(this._container,x,f):ft(this._container,x)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,l=this._map.getSize(),f=this._map.containerPointToLayerPoint(l.multiplyBy(-o)).round();this._bounds=new le(f,f.add(l.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),oT=Rr.extend({options:{tolerance:0},getEvents:function(){var o=Rr.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Rr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");Ee(o,"mousemove",this._onMouseMove,this),Ee(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ee(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Ye(this._container),Ue(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var l in this._layers)o=this._layers[l],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Rr.prototype._update.call(this);var o=this._bounds,l=this._container,f=o.getSize(),g=ae.retina?2:1;ft(l,o.min),l.width=g*f.x,l.height=g*f.y,l.style.width=f.x+"px",l.style.height=f.y+"px",ae.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){Rr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[c(o)]=o;var l=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var l=o._order,f=l.next,g=l.prev;f?f.prev=g:this._drawLast=g,g?g.next=f:this._drawFirst=f,delete o._order,delete this._layers[c(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var l=o.options.dashArray.split(/[, ]+/),f=[],g,v;for(v=0;v<l.length;v++){if(g=Number(l[v]),isNaN(g))return;f.push(g)}o.options._dashArray=f}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var l=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new le,this._redrawBounds.extend(o._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(o._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var l=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,l=this._redrawBounds;if(this._ctx.save(),l){var f=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)o=g.layer,(!l||o._pxBounds&&o._pxBounds.intersects(l))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,l){if(this._drawing){var f,g,v,x,F=o._parts,H=F.length,G=this._ctx;if(H){for(G.beginPath(),f=0;f<H;f++){for(g=0,v=F[f].length;g<v;g++)x=F[f][g],G[g?"lineTo":"moveTo"](x.x,x.y);l&&G.closePath()}this._fillStroke(G,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var l=o._point,f=this._ctx,g=Math.max(Math.round(o._radius),1),v=(Math.max(Math.round(o._radiusY),1)||g)/g;v!==1&&(f.save(),f.scale(1,v)),f.beginPath(),f.arc(l.x,l.y/v,g,0,Math.PI*2,!1),v!==1&&f.restore(),this._fillStroke(f,o)}},_fillStroke:function(o,l){var f=l.options;f.fill&&(o.globalAlpha=f.fillOpacity,o.fillStyle=f.fillColor||f.color,o.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(o.setLineDash&&o.setLineDash(l.options&&l.options._dashArray||[]),o.globalAlpha=f.opacity,o.lineWidth=f.weight,o.strokeStyle=f.color,o.lineCap=f.lineCap,o.lineJoin=f.lineJoin,o.stroke())},_onClick:function(o){for(var l=this._map.mouseEventToLayerPoint(o),f,g,v=this._drawFirst;v;v=v.next)f=v.layer,f.options.interactive&&f._containsPoint(l)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(f))&&(g=f);this._fireEvent(g?[g]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,l)}},_handleMouseOut:function(o){var l=this._hoveredLayer;l&&(_e(this._container,"leaflet-interactive"),this._fireEvent([l],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,l){if(!this._mouseHoverThrottled){for(var f,g,v=this._drawFirst;v;v=v.next)f=v.layer,f.options.interactive&&f._containsPoint(l)&&(g=f);g!==this._hoveredLayer&&(this._handleMouseOut(o),g&&(we(this._container,"leaflet-interactive"),this._fireEvent([g],o,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,l,f){this._map._fireDOMEvent(l,f||l.type,o)},_bringToFront:function(o){var l=o._order;if(l){var f=l.next,g=l.prev;if(f)f.prev=g;else return;g?g.next=f:f&&(this._drawFirst=f),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(o)}},_bringToBack:function(o){var l=o._order;if(l){var f=l.next,g=l.prev;if(g)g.next=f;else return;f?f.prev=g:g&&(this._drawLast=g),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(o)}}});function aT(o){return ae.canvas?new oT(o):null}var Qu=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),bD={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Rr.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var l=o._container=Qu("shape");we(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",o._path=Qu("path"),l.appendChild(o._path),this._updateStyle(o),this._layers[c(o)]=o},_addPath:function(o){var l=o._container;this._container.appendChild(l),o.options.interactive&&o.addInteractiveTarget(l)},_removePath:function(o){var l=o._container;Ye(l),o.removeInteractiveTarget(l),delete this._layers[c(o)]},_updateStyle:function(o){var l=o._stroke,f=o._fill,g=o.options,v=o._container;v.stroked=!!g.stroke,v.filled=!!g.fill,g.stroke?(l||(l=o._stroke=Qu("stroke")),v.appendChild(l),l.weight=g.weight+"px",l.color=g.color,l.opacity=g.opacity,g.dashArray?l.dashStyle=R(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=g.lineCap.replace("butt","flat"),l.joinstyle=g.lineJoin):l&&(v.removeChild(l),o._stroke=null),g.fill?(f||(f=o._fill=Qu("fill")),v.appendChild(f),f.color=g.fillColor||g.color,f.opacity=g.fillOpacity):f&&(v.removeChild(f),o._fill=null)},_updateCircle:function(o){var l=o._point.round(),f=Math.round(o._radius),g=Math.round(o._radiusY||f);this._setPath(o,o._empty()?"M0 0":"AL "+l.x+","+l.y+" "+f+","+g+" 0,"+65535*360)},_setPath:function(o,l){o._path.v=l},_bringToFront:function(o){Xt(o._container)},_bringToBack:function(o){Xn(o._container)}},Wd=ae.vml?Qu:Tu,Yu=Rr.extend({_initContainer:function(){this._container=Wd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Wd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ye(this._container),Ue(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Rr.prototype._update.call(this);var o=this._bounds,l=o.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,f.setAttribute("width",l.x),f.setAttribute("height",l.y)),ft(f,o.min),f.setAttribute("viewBox",[o.min.x,o.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(o){var l=o._path=Wd("path");o.options.className&&we(l,o.options.className),o.options.interactive&&we(l,"leaflet-interactive"),this._updateStyle(o),this._layers[c(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){Ye(o._path),o.removeInteractiveTarget(o._path),delete this._layers[c(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var l=o._path,f=o.options;l&&(f.stroke?(l.setAttribute("stroke",f.color),l.setAttribute("stroke-opacity",f.opacity),l.setAttribute("stroke-width",f.weight),l.setAttribute("stroke-linecap",f.lineCap),l.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?l.setAttribute("stroke-dasharray",f.dashArray):l.removeAttribute("stroke-dasharray"),f.dashOffset?l.setAttribute("stroke-dashoffset",f.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),f.fill?(l.setAttribute("fill",f.fillColor||f.color),l.setAttribute("fill-opacity",f.fillOpacity),l.setAttribute("fill-rule",f.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(o,l){this._setPath(o,pd(o._parts,l))},_updateCircle:function(o){var l=o._point,f=Math.max(Math.round(o._radius),1),g=Math.max(Math.round(o._radiusY),1)||f,v="a"+f+","+g+" 0 1,0 ",x=o._empty()?"M0 0":"M"+(l.x-f)+","+l.y+v+f*2+",0 "+v+-f*2+",0 ";this._setPath(o,x)},_setPath:function(o,l){o._path.setAttribute("d",l)},_bringToFront:function(o){Xt(o._path)},_bringToBack:function(o){Xn(o._path)}});ae.vml&&Yu.include(bD);function lT(o){return ae.svg||ae.vml?new Yu(o):null}Re.include({getRenderer:function(o){var l=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var l=this._paneRenderers[o];return l===void 0&&(l=this._createRenderer({pane:o}),this._paneRenderers[o]=l),l},_createRenderer:function(o){return this.options.preferCanvas&&aT(o)||lT(o)}});var uT=Ua.extend({initialize:function(o,l){Ua.prototype.initialize.call(this,this._boundsToLatLngs(o),l)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=Ve(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function kD(o,l){return new uT(o,l)}Yu.create=Wd,Yu.pointsToPath=pd,Ar.geometryToLayer=Od,Ar.coordsToLatLng=Sg,Ar.coordsToLatLngs=Vd,Ar.latLngToCoords=Cg,Ar.latLngsToCoords=Fd,Ar.getFeature=Ba,Ar.asFeature=jd,Re.mergeOptions({boxZoom:!0});var cT=yn.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){Ee(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ue(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ye(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),vo(),Ra(),this._startPoint=this._map.mouseEventToContainerPoint(o),Ee(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),we(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var l=new le(this._point,this._startPoint),f=l.getSize();ft(this._box,l.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(Ye(this._box),_e(this._container,"leaflet-crosshair")),_i(),ba(),Ue(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var l=new nt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Re.addInitHook("addHandler","boxZoom",cT),Re.mergeOptions({doubleClickZoom:!0});var hT=yn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var l=this._map,f=l.getZoom(),g=l.options.zoomDelta,v=o.originalEvent.shiftKey?f-g:f+g;l.options.doubleClickZoom==="center"?l.setZoom(v):l.setZoomAround(o.containerPoint,v)}});Re.addInitHook("addHandler","doubleClickZoom",hT),Re.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var dT=yn.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new an(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}we(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_e(this._map._container,"leaflet-grab"),_e(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=Ve(this._map.options.maxBounds);this._offsetLimit=Se(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var l=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(l),this._prunePositions(l)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,l){return o-(o-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;o.x<l.min.x&&(o.x=this._viscousLimit(o.x,l.min.x)),o.y<l.min.y&&(o.y=this._viscousLimit(o.y,l.min.y)),o.x>l.max.x&&(o.x=this._viscousLimit(o.x,l.max.x)),o.y>l.max.y&&(o.y=this._viscousLimit(o.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,l=Math.round(o/2),f=this._initialWorldOffset,g=this._draggable._newPos.x,v=(g-l+f)%o+l-f,x=(g+l+f)%o-l-f,F=Math.abs(v+f)<Math.abs(x+f)?v:x;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=F},_onDragEnd:function(o){var l=this._map,f=l.options,g=!f.inertia||o.noInertia||this._times.length<2;if(l.fire("dragend",o),g)l.fire("moveend");else{this._prunePositions(+new Date);var v=this._lastPos.subtract(this._positions[0]),x=(this._lastTime-this._times[0])/1e3,F=f.easeLinearity,H=v.multiplyBy(F/x),G=H.distanceTo([0,0]),Y=Math.min(f.inertiaMaxSpeed,G),ne=H.multiplyBy(Y/G),de=Y/(f.inertiaDeceleration*F),Ie=ne.multiplyBy(-de/2).round();!Ie.x&&!Ie.y?l.fire("moveend"):(Ie=l._limitOffset(Ie,l.options.maxBounds),M(function(){l.panBy(Ie,{duration:de,easeLinearity:F,noMoveStart:!0,animate:!0})}))}}});Re.addInitHook("addHandler","dragging",dT),Re.mergeOptions({keyboard:!0,keyboardPanDelta:80});var fT=yn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),Ee(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ue(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,l=document.documentElement,f=o.scrollTop||l.scrollTop,g=o.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(g,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var l=this._panKeys={},f=this.keyCodes,g,v;for(g=0,v=f.left.length;g<v;g++)l[f.left[g]]=[-1*o,0];for(g=0,v=f.right.length;g<v;g++)l[f.right[g]]=[o,0];for(g=0,v=f.down.length;g<v;g++)l[f.down[g]]=[0,o];for(g=0,v=f.up.length;g<v;g++)l[f.up[g]]=[0,-1*o]},_setZoomDelta:function(o){var l=this._zoomKeys={},f=this.keyCodes,g,v;for(g=0,v=f.zoomIn.length;g<v;g++)l[f.zoomIn[g]]=o;for(g=0,v=f.zoomOut.length;g<v;g++)l[f.zoomOut[g]]=-o},_addHooks:function(){Ee(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ue(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var l=o.keyCode,f=this._map,g;if(l in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(g=this._panKeys[l],o.shiftKey&&(g=X(g).multiplyBy(3)),f.options.maxBounds&&(g=f._limitOffset(X(g),f.options.maxBounds)),f.options.worldCopyJump){var v=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(g)));f.panTo(v)}else f.panBy(g)}else if(l in this._zoomKeys)f.setZoom(f.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;Hi(o)}}});Re.addInitHook("addHandler","keyboard",fT),Re.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var pT=yn.extend({addHooks:function(){Ee(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ue(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var l=wi(o),f=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var g=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),g),Hi(o)},_performZoom:function(){var o=this._map,l=o.getZoom(),f=this._map.options.zoomSnap||0;o._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),v=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,x=f?Math.ceil(v/f)*f:v,F=o._limitZoom(l+(this._delta>0?x:-x))-l;this._delta=0,this._startTime=null,F&&(o.options.scrollWheelZoom==="center"?o.setZoom(l+F):o.setZoomAround(this._lastMousePos,l+F))}});Re.addInitHook("addHandler","scrollWheelZoom",pT);var ND=600;Re.mergeOptions({tapHold:ae.touchNative&&ae.safari&&ae.mobile,tapTolerance:15});var mT=yn.extend({addHooks:function(){Ee(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ue(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var l=o.touches[0];this._startPos=this._newPos=new q(l.clientX,l.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Ee(document,"touchend",Mt),Ee(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),ND),Ee(document,"touchend touchcancel contextmenu",this._cancel,this),Ee(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Ue(document,"touchend",Mt),Ue(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Ue(document,"touchend touchcancel contextmenu",this._cancel,this),Ue(document,"touchmove",this._onMove,this)},_onMove:function(o){var l=o.touches[0];this._newPos=new q(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,l){var f=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});f._simulated=!0,l.target.dispatchEvent(f)}});Re.addInitHook("addHandler","tapHold",mT),Re.mergeOptions({touchZoom:ae.touch,bounceAtZoomLimits:!0});var gT=yn.extend({addHooks:function(){we(this._map._container,"leaflet-touch-zoom"),Ee(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_e(this._map._container,"leaflet-touch-zoom"),Ue(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var l=this._map;if(!(!o.touches||o.touches.length!==2||l._animatingZoom||this._zooming)){var f=l.mouseEventToContainerPoint(o.touches[0]),g=l.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(f.add(g)._divideBy(2))),this._startDist=f.distanceTo(g),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),Ee(document,"touchmove",this._onTouchMove,this),Ee(document,"touchend touchcancel",this._onTouchEnd,this),Mt(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var l=this._map,f=l.mouseEventToContainerPoint(o.touches[0]),g=l.mouseEventToContainerPoint(o.touches[1]),v=f.distanceTo(g)/this._startDist;if(this._zoom=l.getScaleZoom(v,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&v<1||this._zoom>l.getMaxZoom()&&v>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,v===1)return}else{var x=f._add(g)._divideBy(2)._subtract(this._centerPoint);if(v===1&&x.x===0&&x.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(x),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var F=a(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(F,this,!0),Mt(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Ue(document,"touchmove",this._onTouchMove,this),Ue(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Re.addInitHook("addHandler","touchZoom",gT),Re.BoxZoom=cT,Re.DoubleClickZoom=hT,Re.Drag=dT,Re.Keyboard=fT,Re.ScrollWheelZoom=pT,Re.TapHold=mT,Re.TouchZoom=gT,n.Bounds=le,n.Browser=ae,n.CRS=Ut,n.Canvas=oT,n.Circle=xg,n.CircleMarker=Md,n.Class=xe,n.Control=on,n.DivIcon=iT,n.DivOverlay=Ki,n.DomEvent=Eg,n.DomUtil=Wi,n.Draggable=an,n.Evented=he,n.FeatureGroup=Ir,n.GeoJSON=Ar,n.GridLayer=Zu,n.Handler=yn,n.Icon=ja,n.ImageOverlay=Ud,n.LatLng=Ne,n.LatLngBounds=nt,n.Layer=Ti,n.LayerGroup=Fa,n.LineUtil=xt,n.Map=Re,n.Marker=Dd,n.Mixin=bd,n.Path=ds,n.Point=q,n.PolyUtil=kd,n.Polygon=Ua,n.Polyline=Pr,n.Popup=Bd,n.PosAnimation=cs,n.Projection=qi,n.Rectangle=uT,n.Renderer=Rr,n.SVG=Yu,n.SVGOverlay=nT,n.TileLayer=za,n.Tooltip=zd,n.Transformation=wu,n.Util=D,n.VideoOverlay=tT,n.bind=a,n.bounds=Se,n.canvas=aT,n.circle=yD,n.circleMarker=_D,n.control=hs,n.divIcon=PD,n.extend=r,n.featureGroup=pD,n.geoJSON=eT,n.geoJson=ED,n.gridLayer=AD,n.icon=mD,n.imageOverlay=TD,n.latLng=ye,n.latLngBounds=Ve,n.layerGroup=fD,n.map=Bu,n.marker=gD,n.point=X,n.polygon=wD,n.polyline=vD,n.popup=CD,n.rectangle=kD,n.setOptions=b,n.stamp=c,n.svg=lT,n.svgOverlay=SD,n.tileLayer=rT,n.tooltip=ID,n.transformation=is,n.version=i,n.videoOverlay=xD;var LD=window.L;n.noConflict=function(){return window.L=LD,this},window.L=n})})(Uv,Uv.exports);var fd=Uv.exports;const N7=hI(fd);function ZE(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function QE(t,e){return e==null?function(i,r){const s=B.useRef();return s.current||(s.current=t(i,r)),s}:function(i,r){const s=B.useRef();s.current||(s.current=t(i,r));const a=B.useRef(i),{instance:u}=s.current;return B.useEffect(function(){a.current!==i&&(e(u,i,a.current),a.current=i)},[u,i,r]),s}}function L7(t,e){B.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function cD(t){return function(n){const i=lD(),r=t(KE(n,i),i);return sD(i.map,n.attribution),uD(r.current,n.eventHandlers),L7(r.current,i),r}}function D7(t,e){const n=QE(t,e),i=cD(n);return A7(i)}function M7(t,e){const n=QE(t),i=k7(n,e);return R7(i)}function O7(t,e){const n=QE(t,e),i=cD(n);return b7(i)}function V7(t,e,n){const{opacity:i,zIndex:r}=e;i!=null&&i!==n.opacity&&t.setOpacity(i),r!=null&&r!==n.zIndex&&t.setZIndex(r)}function Bv(){return Bv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Bv.apply(this,arguments)}function F7({bounds:t,boundsOptions:e,center:n,children:i,className:r,id:s,placeholder:a,style:u,whenReady:c,zoom:h,...p},m){const[_]=B.useState({className:r,id:s,style:u}),[T,A]=B.useState(null);B.useImperativeHandle(m,()=>(T==null?void 0:T.map)??null,[T]);const b=B.useCallback(C=>{if(C!==null&&T===null){const S=new fd.Map(C,p);n!=null&&h!=null?S.setView(n,h):t!=null&&S.fitBounds(t,e),c!=null&&S.whenReady(c),A(I7(S))}},[]);B.useEffect(()=>()=>{T==null||T.map.remove()},[T]);const V=T?ui.createElement(aD,{value:T},i):a??null;return ui.createElement("div",Bv({},_,{ref:b}),V)}const j7=B.forwardRef(F7),U7=D7(function({position:e,...n},i){const r=new fd.Marker(e,n);return ZE(r,P7(i,{overlayContainer:r}))},function(e,n,i){n.position!==i.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==i.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==i.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==i.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),B7=M7(function(e,n){const i=new fd.Popup(e,n.overlayContainer);return ZE(i,n)},function(e,n,{position:i},r){B.useEffect(function(){const{instance:a}=e;function u(h){h.popup===a&&(a.update(),r(!0))}function c(h){h.popup===a&&r(!1)}return n.map.on({popupopen:u,popupclose:c}),n.overlayContainer==null?(i!=null&&a.setLatLng(i),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var p;n.map.off({popupopen:u,popupclose:c}),(p=n.overlayContainer)==null||p.unbindPopup(),n.map.removeLayer(a)}},[e,n,r,i])}),z7=O7(function({url:e,...n},i){const r=new fd.TileLayer(e,KE(n,i));return ZE(r,i)},function(e,n,i){V7(e,n,i);const{url:r}=n;r!=null&&r!==i.url&&e.setUrl(r)}),W7=new N7.Icon({iconUrl:"/bus.png",iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]});function YE(){const[t,e]=B.useState(null);return B.useEffect(()=>{const n=yt(vt,"buses/bus001"),i=ur(n,r=>{var s,a;if(r.exists()){const u=r.val();(s=u.ubicacion)!=null&&s.lat&&((a=u.ubicacion)!=null&&a.lng)&&e([u.ubicacion.lat,u.ubicacion.lng])}});return()=>i()},[]),t?E.jsx("div",{className:"h-[80vh]",children:E.jsxs(j7,{center:t,zoom:16,className:"h-full",children:[E.jsx(z7,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),E.jsx(U7,{position:t,icon:W7,children:E.jsx(B7,{children:"Bus institucional"})})]})}):E.jsx("div",{className:"h-[70vh] bg-white rounded p-6",children:"Esperando posicin..."})}function H7(){const[t,e]=B.useState([]);B.useEffect(()=>{const c=yt(vt,"alertas"),h=ur(c,p=>{if(p.exists()){const m=p.val(),_=Object.keys(m).map(T=>({id:T,...m[T]})).sort((T,A)=>A.timestamp-T.timestamp);e(_)}else e([])});return()=>h()},[]);const n=c=>new Date(c).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=c=>({accidente:"bg-red-100 border-red-400 text-red-800",emergencia_medica:"bg-orange-100 border-orange-400 text-orange-800",retraso_ruta:"bg-yellow-100 border-yellow-400 text-yellow-800",falla_mecanica:"bg-purple-100 border-purple-400 text-purple-800",comportamiento_pasajeros:"bg-indigo-100 border-indigo-400 text-indigo-800"})[c]||"bg-gray-100 border-gray-400 text-gray-800",r=c=>({accidente:"",emergencia_medica:"",retraso_ruta:"",falla_mecanica:"",comportamiento_pasajeros:""})[c]||"",s=async c=>{await xc(yt(vt,`alertas/${c}`),{estado:"resuelta",fechaResolucion:Date.now()})},a=t.filter(c=>c.estado==="activa"),u=t.filter(c=>c.estado==="resuelta");return E.jsxs(Fe.section,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-8 rounded-2xl shadow-xl",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[E.jsx("span",{className:"text-3xl",children:""}),E.jsx("h2",{className:"text-2xl font-bold",children:"Sistema de Alertas"}),E.jsxs("span",{className:"ml-auto bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold",children:[a.length," Activas"]})]}),E.jsxs("div",{className:"mb-8",children:[E.jsx("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:" Alertas Activas"}),a.length===0?E.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:E.jsx("p",{className:"text-green-700",children:" No hay alertas activas"})}):E.jsx("div",{className:"space-y-3",children:a.map(c=>E.jsx(Fe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 border-l-4 rounded-lg ${i(c.tipo)}`,children:E.jsxs("div",{className:"flex items-start justify-between",children:[E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[E.jsx("span",{className:"text-lg",children:r(c.tipo)}),E.jsx("h4",{className:"font-semibold",children:c.mensaje})]}),E.jsxs("div",{className:"text-sm space-y-1",children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Bus:"})," ",c.busId]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Fecha:"})," ",n(c.timestamp)]}),c.ubicacion&&E.jsxs("p",{children:[E.jsx("strong",{children:"Ubicacin:"})," ",c.ubicacion.lat.toFixed(6),", ",c.ubicacion.lng.toFixed(6)]})]})]}),E.jsx("button",{onClick:()=>s(c.id),className:"ml-4 px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"Resolver"})]})},c.id))})]}),E.jsxs("div",{children:[E.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-600",children:[" Alertas Resueltas (",u.length,")"]}),u.length===0?E.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:E.jsx("p",{className:"text-gray-600",children:"No hay alertas resueltas"})}):E.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:u.slice(0,10).map(c=>E.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg opacity-75",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[E.jsx("span",{children:r(c.tipo)}),E.jsx("span",{className:"font-medium text-sm",children:c.mensaje})]}),E.jsxs("div",{className:"text-xs text-gray-600",children:[E.jsxs("span",{children:["Bus: ",c.busId]})," ",E.jsxs("span",{children:[" ",n(c.timestamp)]})," ",E.jsxs("span",{children:[" Resuelta: ",n(c.fechaResolucion)]})]})]},c.id))})]})]})}function $7(){const[t,e]=B.useState([]),[n,i]=B.useState([]);DR();const r=async()=>{const h=await Qr(pr(rt,"usuarios")),p=await Qr(pr(rt,"buses")),m=h.docs.filter(_=>_.id.length>=20).map(_=>({id:_.id,..._.data()}));e(m),i(p.docs.map(_=>({id:_.id,..._.data()})))};B.useEffect(()=>{r()},[]);const s=h=>n.filter(p=>!t.some(_=>_.id!==h.id&&_.busAsignado===p.id)),a=async(h,p)=>{p!=="conductor"?await qo(En(rt,"usuarios",h),{rol:p,busAsignado:""}):await qo(En(rt,"usuarios",h),{rol:p}),r()},u=async(h,p)=>{const m=t.find(_=>_.id===h);if((m==null?void 0:m.rol)!=="conductor"&&p!==""){alert("Solo los conductores pueden tener buses asignados");return}await qo(En(rt,"usuarios",h),{busAsignado:p}),r()},c=async h=>{confirm(`Eliminar usuario?
Esto eliminar el registro de Firestore. Tambin debers borrarlo en Firebase Authentication.`)&&(await pk(En(rt,"usuarios",h)),r())};return E.jsxs(Fe.section,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-8 rounded-2xl shadow-xl",children:[E.jsx("h2",{className:"text-2xl mb-6",children:" Gestin de Usuarios"}),E.jsx("p",{className:"text-gray-600 mb-4",children:"* Panel sincronizado con Firebase Authentication. Solo muestra UIDs vlidos."}),E.jsxs("table",{className:"w-full text-sm",children:[E.jsx("thead",{className:"bg-blue-50 text-blue-700",children:E.jsxs("tr",{children:[E.jsx("th",{className:"p-3 text-left",children:"Nombre"}),E.jsx("th",{className:"p-3 text-left",children:"Email"}),E.jsx("th",{className:"p-3 text-left",children:"Rol"}),E.jsx("th",{className:"p-3 text-left",children:"Bus Asignado"}),E.jsx("th",{className:"p-3 text-center",children:"Acciones"})]})}),E.jsx("tbody",{children:t.map(h=>E.jsxs("tr",{className:"border-b",children:[E.jsx("td",{className:"p-3",children:h.nombre}),E.jsx("td",{className:"p-3",children:h.email}),E.jsx("td",{className:"p-3",children:E.jsxs("select",{value:h.rol||"pasajero",onChange:p=>a(h.id,p.target.value),className:"border px-2 py-1 rounded",children:[E.jsx("option",{value:"admin",children:"Admin"}),E.jsx("option",{value:"conductor",children:"Conductor"}),E.jsx("option",{value:"pasajero",children:"Pasajero"})]})}),E.jsx("td",{className:"p-3",children:h.rol==="conductor"?E.jsxs("select",{value:h.busAsignado||"",onChange:p=>u(h.id,p.target.value),className:"border px-2 py-1 rounded",children:[E.jsx("option",{value:"",children:"Sin asignar"}),s(h).map(p=>E.jsxs("option",{value:p.id,children:[p.idBus," - ",p.modelo," - ",p.placa]},p.id))]}):E.jsx("span",{className:"text-gray-500 italic",children:h.busAsignado?"N/A (cambiar rol a conductor)":"N/A"})}),E.jsx("td",{className:"p-3 text-center",children:E.jsx("button",{onClick:()=>c(h.id),className:"text-red-600 text-lg hover:text-red-800",children:""})})]},h.id))})]})]})}async function q7(t){return await f6(pr(rt,"buses"),{idBus:t.idBus,placa:t.placa,modelo:t.modelo,capacidad:t.capacidad,conductor:"",estado:"disponible"})}async function G7(){const e=(await Qr(pr(rt,"buses"))).docs.map(r=>({id:r.id,...r.data()})),i=(await Qr(pr(rt,"usuarios"))).docs.map(r=>({id:r.id,...r.data()}));return e.map(r=>{let s=i.find(a=>a.id===r.conductor);return s||(s=i.find(a=>a.busAsignado===r.id&&a.rol==="conductor")),{...r,conductor:(s==null?void 0:s.id)||r.conductor||"",conductorNombre:(s==null?void 0:s.nombre)||null}})}async function K7(t){return await pk(En(rt,"buses",t))}async function Z7(t,e){const n=En(rt,"buses",t),i=En(rt,"usuarios",e);await qo(n,{conductor:e,estado:"ocupado"}),await qo(i,{busAsignado:t})}async function Q7(t,e){await qo(En(rt,"buses",t),{conductor:"",estado:"disponible"}),await qo(En(rt,"usuarios",e),{busAsignado:""})}function Y7(){const[t,e]=B.useState([]),[n,i]=B.useState({idBus:"",placa:"",modelo:"",capacidad:"",conductor:""}),[r,s]=B.useState([]),a=async()=>{e(await G7());const _=(await Qr(pr(rt,"usuarios"))).docs.map(T=>({id:T.id,...T.data()})).filter(T=>T.rol==="conductor"&&(!T.busAsignado||T.busAsignado===""));s(_)};B.useEffect(()=>{a()},[]);const u=async m=>{m.preventDefault(),await q7(n),i({idBus:"",placa:"",modelo:"",capacidad:"",conductor:""}),await a()},c=async(m,_)=>{await Z7(m,_),await a()},h=async(m,_)=>{await Q7(m,_),await a()},p=async m=>{confirm("Eliminar bus?")&&(await K7(m),await a())};return E.jsxs(Fe.section,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-8 rounded-2xl shadow-xl",children:[E.jsx("h2",{className:"text-2xl mb-6",children:" Gestin de Buses"}),E.jsxs("form",{onSubmit:u,className:"grid md:grid-cols-5 gap-3 mb-6",children:[E.jsx("input",{placeholder:"ID del Bus",value:n.idBus,onChange:m=>i({...n,idBus:m.target.value}),required:!0,className:"border p-2"}),E.jsx("input",{placeholder:"Placa",value:n.placa,onChange:m=>i({...n,placa:m.target.value}),required:!0,className:"border p-2"}),E.jsx("input",{placeholder:"Modelo",value:n.modelo,onChange:m=>i({...n,modelo:m.target.value}),required:!0,className:"border p-2"}),E.jsx("input",{placeholder:"Capacidad",type:"number",value:n.capacidad,onChange:m=>i({...n,capacidad:m.target.value}),required:!0,className:"border p-2"}),E.jsx("button",{className:"bg-blue-600 text-white rounded p-2",children:"Crear Bus"})]}),E.jsxs("table",{className:"w-full text-sm",children:[E.jsx("thead",{className:"bg-blue-50 text-blue-700",children:E.jsxs("tr",{children:[E.jsx("th",{className:"p-3 text-left",children:"ID"}),E.jsx("th",{className:"p-3 text-left",children:"Placa"}),E.jsx("th",{className:"p-3 text-left",children:"Modelo"}),E.jsx("th",{className:"p-3 text-left",children:"Capacidad"}),E.jsx("th",{className:"p-3 text-left",children:"Conductor"}),E.jsx("th",{className:"p-3 text-center",children:"Acciones"})]})}),E.jsx("tbody",{children:t.map(m=>E.jsxs("tr",{className:"border-b",children:[E.jsx("td",{className:"p-3",children:m.idBus}),E.jsx("td",{className:"p-3",children:m.placa}),E.jsx("td",{className:"p-3",children:m.modelo}),E.jsx("td",{className:"p-3",children:m.capacidad}),E.jsx("td",{className:"p-3",children:m.conductor?E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"font-semibold",children:m.conductorNombre}),E.jsx("button",{onClick:()=>h(m.id,m.conductor),className:"text-red-600 text-sm",children:"Quitar"})]}):E.jsxs("select",{defaultValue:"",onChange:_=>c(m.id,_.target.value),className:"border p-1",children:[E.jsx("option",{value:"",children:"Asignar conductor"}),r.map(_=>E.jsx("option",{value:_.id,children:_.nombre},_.id))]})}),E.jsx("td",{className:"p-3 text-center",children:E.jsx("button",{onClick:()=>p(m.id),className:"text-red-600 mr-2",children:""})})]},m.id))})]})]})}function X7(){const[t,e]=B.useState([]);B.useEffect(()=>{const c=yt(vt,"recorridos"),h=ur(c,p=>{if(p.exists()){const m=p.val(),_=Object.keys(m).map(T=>{const A=m[T].coordenadas?Object.values(m[T].coordenadas):[],b=s(A);return{id:T,...m[T],coordenadas:A.length,distanciaKm:b}}).sort((T,A)=>A.fechaInicio-T.fechaInicio);e(_)}else e([])});return()=>h()},[]);const n=c=>new Date(c).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=(c,h)=>{if(!h)return"En curso";const p=h-c,m=Math.floor(p/6e4),_=Math.floor(m/60),T=m%60;return _>0?`${_}h ${T}m`:`${T}m`},r=(c,h,p,m)=>{const T=(p-c)*Math.PI/180,A=(m-h)*Math.PI/180,b=Math.sin(T/2)*Math.sin(T/2)+Math.cos(c*Math.PI/180)*Math.cos(p*Math.PI/180)*Math.sin(A/2)*Math.sin(A/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},s=c=>{if(!c||!Array.isArray(c)||c.length<2)return 0;let h=0;for(let p=1;p<c.length;p++){const m=c[p-1],_=c[p];if(m!=null&&m.lat&&(m!=null&&m.lng)&&(_!=null&&_.lat)&&(_!=null&&_.lng)){const T=r(m.lat,m.lng,_.lat,_.lng);!isNaN(T)&&isFinite(T)&&(h+=T)}}return h||0},a=t.filter(c=>c.estado==="activo"),u=t.filter(c=>c.estado==="finalizado");return E.jsxs(Fe.section,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-8 rounded-2xl shadow-xl",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[E.jsx(Sc,{className:"w-6 h-6 text-blue-600"}),E.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Historial de Recorridos"}),E.jsxs("span",{className:"ml-auto bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold",children:[t.length," Total"]})]}),a.length>0&&E.jsxs("div",{className:"mb-8",children:[E.jsxs("h3",{className:"text-lg font-semibold mb-4 text-green-600 flex items-center gap-2",children:[E.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Recorridos Activos"]}),E.jsx("div",{className:"space-y-3",children:a.map(c=>E.jsx(Fe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 border-l-4 border-green-400 bg-green-50 rounded-lg",children:E.jsx("div",{className:"flex items-start justify-between",children:E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[E.jsx("h4",{className:"font-semibold text-green-900",children:c.id}),E.jsx("span",{className:"px-2 py-1 bg-green-200 text-green-800 text-xs rounded-full font-medium",children:"EN CURSO"})]}),E.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(w_,{className:"w-4 h-4 text-green-600"}),E.jsx("span",{className:"text-green-700",children:n(c.fechaInicio)})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(ZS,{className:"w-4 h-4 text-green-600"}),E.jsx("span",{className:"text-green-700",children:i(c.fechaInicio,Date.now())})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Dh,{className:"w-4 h-4 text-green-600"}),E.jsxs("span",{className:"text-green-700",children:[c.coordenadas," puntos"]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Sc,{className:"w-4 h-4 text-green-600"}),E.jsxs("span",{className:"text-green-700 font-medium",children:[(c.distanciaKm||0).toFixed(2)," km"]})]}),E.jsx("div",{className:"flex items-center gap-2",children:E.jsxs("span",{className:"text-green-700 font-medium",children:["Bus: ",c.busId]})})]})]})})},c.id))})]}),E.jsxs("div",{children:[E.jsxs("h3",{className:"text-lg font-semibold mb-4 text-blue-600",children:["Recorridos Finalizados (",u.length,")"]}),u.length===0?E.jsxs("div",{className:"p-8 bg-gray-50 border border-gray-200 rounded-lg text-center",children:[E.jsx(Sc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),E.jsx("p",{className:"text-gray-600",children:"No hay recorridos finalizados"})]}):E.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:u.map(c=>E.jsx(Fe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 border border-gray-200 bg-white rounded-lg hover:shadow-md transition-shadow",children:E.jsx("div",{className:"flex items-start justify-between",children:E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[E.jsx("h4",{className:"font-semibold text-gray-900",children:c.id}),E.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"FINALIZADO"})]}),E.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(w_,{className:"w-4 h-4 text-gray-500"}),E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Inicio"}),E.jsx("p",{className:"text-gray-600 text-xs",children:n(c.fechaInicio)})]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(w_,{className:"w-4 h-4 text-gray-500"}),E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Fin"}),E.jsx("p",{className:"text-gray-600 text-xs",children:c.fechaFin?n(c.fechaFin):"N/A"})]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(ZS,{className:"w-4 h-4 text-gray-500"}),E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Duracin"}),E.jsx("p",{className:"text-gray-600 text-xs",children:i(c.fechaInicio,c.fechaFin)})]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Sc,{className:"w-4 h-4 text-gray-500"}),E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Distancia"}),E.jsxs("p",{className:"text-gray-600 text-xs font-semibold",children:[(c.distanciaKm||0).toFixed(2)," km"]})]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Dh,{className:"w-4 h-4 text-gray-500"}),E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Puntos GPS"}),E.jsxs("p",{className:"text-gray-600 text-xs",children:[c.coordenadas," coordenadas"]})]})]}),E.jsx("div",{className:"flex items-center gap-2",children:E.jsxs("div",{children:[E.jsx("p",{className:"text-gray-700 font-medium",children:"Bus"}),E.jsx("p",{className:"text-gray-600 text-xs",children:c.busId})]})})]})]})})},c.id))})]})]})}function J7(){const t=Kh(),[e,n]=B.useState(null),[i,r]=B.useState(""),[s,a]=B.useState("dashboard");B.useEffect(()=>{const c=TR(si,async h=>{var p,m,_;if(!h)t("/");else{n(h);try{const A=(await Qr(pr(rt,"usuarios"))).docs.find(b=>b.id===h.uid);r(A?A.data().nombre||((p=h.email)==null?void 0:p.split("@")[0])||"Usuario":((m=h.email)==null?void 0:m.split("@")[0])||"Usuario")}catch{r(((_=h.email)==null?void 0:_.split("@")[0])||"Usuario")}}});return()=>c()},[]);const u=async()=>{await bm(si),t("/")};return E.jsxs("div",{className:"flex h-screen bg-gray-50",children:[E.jsxs(Fe.aside,{initial:{x:-300},animate:{x:0},className:"w-72 bg-white border-r border-gray-200 flex flex-col shadow-sm",children:[E.jsxs(Fe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-col items-center py-8 px-6 border-b border-gray-100",children:[E.jsxs("div",{className:"relative mb-4",children:[E.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:E.jsx("img",{src:"/mapa.png",alt:"Logo",className:"w-10 h-10"})}),E.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white"})]}),E.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Bus Tracker"}),E.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Panel Administrativo"}),E.jsx("div",{className:"mt-3 px-3 py-1 bg-blue-50 rounded-full",children:E.jsx("p",{className:"text-xs text-blue-700 font-medium",children:i})})]}),E.jsx("nav",{className:"flex-1 py-6 px-4",children:E.jsxs("div",{className:"space-y-1",children:[E.jsx(qa,{icon:E.jsx(F9,{size:20}),text:"Mtricas",active:s==="dashboard",onClick:()=>a("dashboard")}),E.jsx(qa,{icon:E.jsx(Dh,{size:20}),text:"Mapa",active:s==="mapa",onClick:()=>a("mapa")}),E.jsx(qa,{icon:E.jsx(PN,{size:20}),text:"Alertas",active:s==="alertas",onClick:()=>a("alertas")}),E.jsx(qa,{icon:E.jsx(Sc,{size:20}),text:"Recorridos",active:s==="recorridos",onClick:()=>a("recorridos")}),E.jsx(qa,{icon:E.jsx($9,{size:20}),text:"Usuarios",active:s==="usuarios",onClick:()=>a("usuarios")}),E.jsx(qa,{icon:E.jsx(pE,{size:20}),text:"Buses",active:s==="buses",onClick:()=>a("buses")})]})})]}),E.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[E.jsx(Fe.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white border-b border-gray-200 px-8 py-6",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s==="dashboard"?"Mtricas del Sistema":s==="mapa"?"Mapa en Tiempo Real":s==="alertas"?"Centro de Alertas":s==="recorridos"?"Historial de Recorridos":s==="usuarios"?"Gestin de Usuarios":s==="buses"?"Gestin de Buses":s}),E.jsx("p",{className:"text-sm text-gray-600 mt-1",children:new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 text-green-800 rounded-lg",children:[E.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),E.jsx("span",{className:"text-sm font-semibold",children:"Sistema Activo"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:u,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm hover:shadow-md",children:[E.jsx(mE,{size:16}),E.jsx("span",{children:"Cerrar Sesin"})]})]})]})}),E.jsxs(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},className:"flex-1 p-8 overflow-y-auto bg-gray-50",children:[s==="dashboard"&&E.jsx(S7,{}),s==="mapa"&&E.jsx(YE,{}),s==="alertas"&&E.jsx(H7,{}),s==="recorridos"&&E.jsx(X7,{}),s==="usuarios"&&E.jsx($7,{}),s==="buses"&&E.jsx(Y7,{})]},s)]})]})}function qa({icon:t,text:e,active:n,onClick:i}){return E.jsxs(Fe.button,{whileHover:{x:4},whileTap:{scale:.98},onClick:i,className:`relative w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left font-medium transition-all duration-200 group ${n?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"}`,children:[E.jsx("div",{className:`flex-shrink-0 transition-colors duration-200 ${n?"text-white":"text-gray-500 group-hover:text-blue-600"}`,children:t}),E.jsx("span",{className:"truncate",children:e}),n&&E.jsx(Fe.div,{layoutId:"activeIndicator",className:"absolute right-3 w-2 h-2 bg-white rounded-full",transition:{type:"spring",bounce:.3,duration:.6}})]})}function eq(){var T,A;const t=Kh(),[e,n]=B.useState(null),[i,r]=B.useState("detenido"),[s,a]=B.useState(!1),[u,c]=B.useState(null),[h,p]=B.useState(""),m="bus001";B.useEffect(()=>{const b=yt(vt,`buses/${m}/ubicacion`),V=yt(vt,`buses/${m}/estado`),C=ur(b,U=>{if(U.exists()){const W=U.val();W.lat&&W.lng&&(n([W.lat,W.lng]),c(Date.now()))}}),S=ur(V,U=>{if(U.exists()){const W=U.val();r(W),a(W==="en_recorrido"),W!=="en_recorrido"&&n(null)}});return(async()=>{var W,K,k;const U=si.currentUser;if(U)try{const N=(await Qr(pr(rt,"usuarios"))).docs.find(O=>O.id===U.uid);p(N?N.data().nombre||((W=U.email)==null?void 0:W.split("@")[0])||"Pasajero":((K=U.email)==null?void 0:K.split("@")[0])||"Pasajero")}catch{p(((k=U.email)==null?void 0:k.split("@")[0])||"Pasajero")}})(),()=>{C(),S()}},[]);const _=async()=>{await bm(si),t("/login")};return E.jsxs("div",{className:"min-h-screen bg-gray-50",children:[E.jsx(Fe.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white border-b border-gray-200 px-8 py-6",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 bg-green-600 rounded-xl flex items-center justify-center",children:E.jsx(W9,{className:"w-6 h-6 text-white"})}),E.jsxs("div",{children:[E.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Localizador del Bus"}),E.jsxs("p",{className:"text-sm text-gray-600",children:[h," - Bus ID: ",m]})]})]}),E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${s?"bg-green-50 border-green-200 text-green-800":"bg-gray-50 border-gray-200 text-gray-700"}`,children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${s?"bg-green-500 animate-pulse":"bg-gray-400"}`}),E.jsx("span",{className:"text-sm font-semibold",children:s?"Bus en Recorrido":"Bus Detenido"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:_,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",children:[E.jsx(mE,{size:16}),E.jsx("span",{children:"Cerrar Sesin"})]})]})]})}),E.jsx("main",{className:"p-8",children:s?E.jsxs(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[E.jsx(Dh,{className:"w-5 h-5 text-green-600"}),E.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ubicacin del Bus en Tiempo Real"})]}),E.jsx(YE,{pos:e}),e&&E.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),E.jsxs("div",{children:[E.jsxs("p",{className:"text-sm font-medium text-green-900",children:["Ubicacin: ",(T=e[0])==null?void 0:T.toFixed(6),", ",(A=e[1])==null?void 0:A.toFixed(6)]}),E.jsxs("p",{className:"text-xs text-green-700",children:["ltima actualizacin: ",u?new Date(u).toLocaleTimeString():"N/A"]})]})]})})]}):E.jsx(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-12 text-center shadow-sm",children:E.jsxs("div",{className:"mb-8",children:[E.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-2xl mx-auto mb-6 flex items-center justify-center",children:E.jsx(pE,{className:"w-10 h-10 text-gray-400"})}),E.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Bus No Disponible"}),E.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"El bus no est realizando ningn recorrido en este momento."}),E.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:E.jsxs("div",{className:"flex items-start gap-3",children:[E.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:E.jsx("span",{className:"text-white text-xs font-bold",children:"i"})}),E.jsxs("p",{className:"text-sm text-blue-800 text-left",children:[E.jsx("strong",{children:"Informacin:"})," La ubicacin del bus solo se muestra cuando est en recorrido activo."]})]})})]})})})]})}function tq(){const t=Kh(),[e,n]=B.useState(null),[i,r]=B.useState("detenido"),[s,a]=B.useState(null),[u,c]=B.useState(!1),[h,p]=B.useState(null),[m,_]=B.useState(null),[T,A]=B.useState(0),[b,V]=B.useState(""),C="bus001",S=1e4,R=10,U=(M,j,D,xe)=>{const Ge=M*Math.PI/180,he=D*Math.PI/180,q=(D-M)*Math.PI/180,re=(xe-j)*Math.PI/180,X=Math.sin(q/2)*Math.sin(q/2)+Math.cos(Ge)*Math.cos(he)*Math.sin(re/2)*Math.sin(re/2);return 6371e3*(2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X)))},W=M=>new Date(M).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});B.useEffect(()=>{const M=yt(vt,`buses/${C}/ubicacion`),j=yt(vt,`buses/${C}/estado`);(async()=>{try{await xc(yt(vt,`buses/${C}`),{estado:"detenido"})}catch(he){console.log("Estado ya existe o error menor:",he)}})();const xe=ur(M,he=>{if(he.exists()){const q=he.val();q.lat&&q.lng&&n([q.lat,q.lng])}}),Nt=ur(j,he=>{if(he.exists()){const q=he.val();r(q),c(q==="en_recorrido")}else r("detenido"),c(!1)});return(async()=>{var q,re,X;const he=si.currentUser;if(he)try{const Se=(await Qr(pr(rt,"usuarios"))).docs.find(nt=>nt.id===he.uid);V(Se?Se.data().nombre||((q=he.email)==null?void 0:q.split("@")[0])||"Conductor":((re=he.email)==null?void 0:re.split("@")[0])||"Conductor")}catch{V(((X=he.email)==null?void 0:X.split("@")[0])||"Conductor")}})(),()=>{xe(),Nt(),s&&navigator.geolocation.clearWatch(s)}},[]),B.useEffect(()=>{u?K():s&&(navigator.geolocation.clearWatch(s),a(null),console.log(" GPS detenido"))},[u]);const K=()=>{if(navigator.geolocation){console.log(" Iniciando geolocalizacin..."),console.log(" Verificando permisos de ubicacin...");const M=navigator.geolocation.watchPosition(async j=>{const{latitude:D,longitude:xe}=j.coords;n([D,xe]),Lh(yt(vt,`buses/${C}/ubicacion`),{lat:D,lng:xe,timestamp:Date.now()}),c(Ge=>(p(he=>{if(Ge&&he){const q=Date.now(),re=q-T;let X=re>=S;if(m&&U(m.lat,m.lng,D,xe)>=R&&(X=!0),X||!m){console.log(" Guardando coordenada:",{lat:D,lng:xe,hora:W(q),tiempoTranscurrido:Math.round(re/1e3)+"s"});const le=yt(vt,`recorridos/${he}/coordenadas`);GS(le,{lat:D,lng:xe,timestamp:q}).then(()=>{console.log(" Coordenada guardada"),_({lat:D,lng:xe}),A(q)}).catch(Se=>{console.error(" Error al guardar coordenada:",Se)})}}return he}),Ge))},j=>{console.warn(" Error de geolocalizacin:",j.message);let D="Error de GPS: ";j.code===1?D+="Permisos de ubicacin denegados. Permite el acceso a la ubicacin.":j.code===2?D+="Ubicacin no disponible. Verifica tu conexin GPS.":j.code===3&&(D+="Timeout del GPS. Intenta nuevamente."),alert(D)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:5e3});a(M)}else alert("Geolocalizacin no soportada en este navegador")},k=async()=>{const M=Date.now(),j=`recorrido_${M}`;console.log(" Iniciando recorrido:",j),console.log(" Fecha/Hora:",W(M)),p(j),c(!0),_(null),A(0);try{await Lh(yt(vt,`recorridos/${j}`),{busId:C,fechaInicio:Date.now(),estado:"activo",coordenadas:{}}),console.log(" Recorrido creado en Firebase"),await xc(yt(vt,`buses/${C}`),{estado:"en_recorrido",recorridoActual:j}),console.log(" Estado del bus actualizado")}catch(D){console.error(" Error al iniciar recorrido:",D)}},I=async()=>{const M=Date.now();if(console.log(" Terminando recorrido:",h),console.log(" Fecha/Hora fin:",W(M)),h)try{await xc(yt(vt,`recorridos/${h}`),{fechaFin:M,estado:"finalizado"}),console.log(" Recorrido finalizado en Firebase")}catch(j){console.error(" Error al finalizar recorrido:",j)}c(!1),p(null),n(null),await xc(yt(vt,`buses/${C}`),{estado:"detenido",recorridoActual:null})},N=async M=>{const j={accidente:"Accidente reportado en la ruta",emergencia_medica:"Emergencia mdica en el bus",retraso_ruta:"Retraso significativo en la ruta",falla_mecanica:"Falla mecnica del vehculo",comportamiento_pasajeros:"Comportamiento inapropiado de pasajeros"};try{const D=yt(vt,"alertas");await GS(D,{tipo:M,mensaje:j[M]||"Alerta general",timestamp:Date.now(),busId:C,conductorId:"uid_CONDUCTOR_123",estado:"activa",ubicacion:e?{lat:e[0],lng:e[1]}:null}),console.log(` Alerta enviada: ${M}`),alert(` Alerta enviada: ${j[M]}`)}catch(D){console.error("Error al enviar alerta:",D),alert(" Error al enviar la alerta. Intenta nuevamente.")}},O=async()=>{if(u)if(confirm("Tienes un recorrido activo. Deseas finalizarlo y cerrar sesin?"))await I();else return;await bm(si),t("/login")};return E.jsxs("div",{className:"min-h-screen bg-gray-50",children:[E.jsx(Fe.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white border-b border-gray-200 px-8 py-6",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center",children:E.jsx("img",{src:"/mapa.png",alt:"Mapa",className:"w-8 h-8"})}),E.jsxs("div",{children:[E.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Panel del Conductor"}),E.jsxs("p",{className:"text-sm text-gray-600",children:[b," - Bus ID: ",C]})]})]}),E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${i==="en_recorrido"?"bg-green-50 border-green-200 text-green-800":"bg-gray-50 border-gray-200 text-gray-700"}`,children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${i==="en_recorrido"?"bg-green-500 animate-pulse":"bg-gray-400"}`}),E.jsx("span",{className:"text-sm font-semibold",children:i==="en_recorrido"?"En Recorrido":"Detenido"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:O,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",children:[E.jsx(mE,{size:16}),E.jsx("span",{children:"Cerrar Sesin"})]})]})]})}),E.jsxs("div",{className:"flex h-full",children:[E.jsxs(Fe.aside,{initial:{x:-300},animate:{x:0},className:"w-80 bg-white border-r border-gray-200 p-6 overflow-y-auto",children:[E.jsxs("div",{className:"mb-8",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[E.jsx(pE,{className:"w-5 h-5 text-green-600"}),E.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Control de Recorrido"})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs(Fe.button,{whileHover:{scale:u?1:1.02},whileTap:{scale:u?1:.98},className:`w-full px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ${u?"bg-gray-100 text-gray-500 cursor-not-allowed border border-gray-200":"bg-green-600 hover:bg-green-700 text-white shadow-sm hover:shadow-md"}`,onClick:k,disabled:u,children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${u?"bg-gray-400":"bg-white"}`}),E.jsx("span",{children:u?"Recorrido en Curso...":"Iniciar Recorrido"})]}),E.jsxs(Fe.button,{whileHover:{scale:u?1.02:1},whileTap:{scale:u?.98:1},className:`w-full px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ${u?"bg-red-600 hover:bg-red-700 text-white shadow-sm hover:shadow-md":"bg-gray-100 text-gray-500 cursor-not-allowed border border-gray-200"}`,onClick:I,disabled:!u,children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${u?"bg-white":"bg-gray-400"}`}),E.jsx("span",{children:"Finalizar Recorrido"})]})]})]}),E.jsxs("div",{children:[E.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[E.jsx(PN,{className:"w-5 h-5 text-red-600"}),E.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alertas de Emergencia"})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",onClick:()=>N("accidente"),children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Accidente"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",onClick:()=>N("emergencia_medica"),children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Emergencia Mdica"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",onClick:()=>N("retraso_ruta"),children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Retraso en Ruta"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",onClick:()=>N("falla_mecanica"),children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Falla Mecnica"})]}),E.jsxs(Fe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",onClick:()=>N("comportamiento_pasajeros"),children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Comportamiento Pasajeros"})]})]})]})]}),E.jsx("main",{className:"flex-1 p-8",children:E.jsxs(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl border border-gray-200 p-6 h-full shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[E.jsx(Dh,{className:"w-5 h-5 text-blue-600"}),E.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ubicacin en Tiempo Real"})]}),E.jsx(YE,{pos:e}),e&&e.length===2?E.jsxs("div",{className:"mt-6 space-y-3",children:[E.jsx("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),E.jsxs("div",{children:[E.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Lat: ",typeof e[0]=="number"?e[0].toFixed(6):"N/A",", Lng: ",typeof e[1]=="number"?e[1].toFixed(6):"N/A"]}),E.jsxs("p",{className:"text-xs text-blue-700",children:["Actualizado: ",new Date().toLocaleTimeString()]})]})]})}),u&&E.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[E.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),E.jsx("p",{className:"text-sm font-semibold text-green-900",children:"GRABANDO RECORRIDO"})]}),E.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[E.jsxs("p",{children:["ID: ",h]}),E.jsxs("p",{children:["Iniciado: ",W(parseInt(h.split("_")[1]))]}),E.jsx("p",{className:"text-gray-600",children:"Guardado: cada 10s o 10m de movimiento"})]})]})]}):E.jsx("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-center",children:E.jsx("p",{className:"text-sm text-gray-600",children:"GPS inactivo - Inicia un recorrido para activar la ubicacin"})})]})})]})]})}const nq="/assets/mapa-df6ca398.png";var hD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},lI=ui.createContext&&ui.createContext(hD),iq=["attr","size","title"];function rq(t,e){if(t==null)return{};var n=sq(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function sq(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function sm(){return sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},sm.apply(this,arguments)}function uI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function om(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uI(Object(n),!0).forEach(function(i){oq(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function oq(t,e,n){return e=aq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aq(t){var e=lq(t,"string");return typeof e=="symbol"?e:e+""}function lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dD(t){return t&&t.map((e,n)=>ui.createElement(e.tag,om({key:n},e.attr),dD(e.child)))}function uq(t){return e=>ui.createElement(cq,sm({attr:om({},t.attr)},e),dD(t.child))}function cq(t){var e=n=>{var{attr:i,size:r,title:s}=t,a=rq(t,iq),u=r||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),ui.createElement("svg",sm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,a,{className:c,style:om(om({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),s&&ui.createElement("title",null,s),t.children)};return lI!==void 0?ui.createElement(lI.Consumer,null,n=>e(n)):e(hD)}function cI(t){return uq({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(t)}function hq(){const t=Kh(),[e,n]=B.useState("login"),[i,r]=B.useState({email:"",password:""}),[s,a]=B.useState(""),[u,c]=B.useState(""),[h,p]=B.useState(""),[m,_]=B.useState(""),T=async C=>{C.preventDefault(),_("");try{const R=(await H4(si,i.email,i.password)).user.uid,U=En(rt,"usuarios",R),W=await Wf(U);if(!W.exists()){_("Tu cuenta no tiene un rol asignado.");return}const K=W.data().rol,k=yt(vt,`usuariosConectados/${R}`);await Lh(k,{nombre:W.data().nombre,rol:K,timestamp:Date.now()}),qS(k).remove(),K==="admin"?t("/panel"):K==="pasajero"?t("/pasajero"):K==="conductor"?t("/conductor"):_("Rol no reconocido.")}catch{_("Correo o contrasea incorrectos.")}},A=async C=>{if(C.preventDefault(),_(""),!s){_("El nombre es obligatorio.");return}try{const S=await W4(si,u,h);await uS(En(rt,"usuarios",S.user.uid),{nombre:s,email:u,rol:"pasajero",busAsignado:""}),await bm(si),n("login"),alert("Usuario registrado. Ahora inicia sesin.")}catch(S){S.code==="auth/email-already-in-use"?_("El correo ya est registrado."):S.code==="auth/weak-password"?_("La contrasea debe tener al menos 6 caracteres."):_("Error al registrar usuario.")}},b=async()=>{try{const C=new er,R=(await s1(si,C)).user.uid,U=En(rt,"usuarios",R),W=await Wf(U);if(!W.exists()){_("Tu cuenta no tiene registro interno en Firestore.");return}const K=W.data().rol,k=yt(vt,`usuariosConectados/${R}`);await Lh(k,{nombre:W.data().nombre,rol:K,timestamp:Date.now()}),qS(k).remove(),K==="admin"?t("/panel"):K==="pasajero"?t("/pasajero"):K==="conductor"?t("/conductor"):_("Rol no reconocido.")}catch{_("Error al iniciar sesin con Google.")}},V=async()=>{try{const C=new er,R=(await s1(si,C)).user,U=En(rt,"usuarios",R.uid);(await Wf(U)).exists()||await uS(U,{nombre:R.displayName||"Sin nombre",email:R.email,rol:"pasajero",busAsignado:""}),t("/pasajero")}catch{_("Error al registrarse con Google.")}};return E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-100 to-blue-200",children:E.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8",children:[E.jsx("img",{src:nq,alt:"Mapa",className:"w-full h-32 object-cover rounded-xl mb-4"}),E.jsx("h2",{className:"text-2xl font-bold text-center text-blue-700 mb-2",children:"Bienvenido al Sistema de Geolocalizacin del Bus Institucional"}),E.jsxs("div",{className:"flex justify-center mt-8 mb-6",children:[E.jsx("div",{className:`w-1/2 text-center pb-2 font-semibold cursor-pointer ${e==="register"?"text-gray-400":"border-b-2 border-blue-600 text-blue-600"}`,onClick:()=>n("login"),children:"Login"}),E.jsx("div",{className:`w-1/2 text-center pb-2 font-semibold cursor-pointer ${e==="register"?"border-b-2 border-blue-600 text-blue-600":"text-gray-400"}`,onClick:()=>n("register"),children:"Registro"})]}),m&&E.jsx("p",{className:"text-red-600 font-semibold text-center mb-2",children:m}),e==="login"?E.jsxs(E.Fragment,{children:[E.jsxs("form",{onSubmit:T,className:"flex flex-col gap-4",children:[E.jsx("input",{type:"email",placeholder:"Correo electrnico",className:"border p-3 rounded-lg",value:i.email,onChange:C=>r({...i,email:C.target.value})}),E.jsx("input",{type:"password",placeholder:"Contrasea",className:"border p-3 rounded-lg",value:i.password,onChange:C=>r({...i,password:C.target.value})}),E.jsx("button",{type:"submit",className:"bg-blue-600 text-white py-3 rounded-lg font-semibold",children:"Iniciar Sesin"})]}),E.jsxs("div",{className:"flex items-center w-full my-6",children:[E.jsx("hr",{className:"flex-grow border-gray-300"}),E.jsx("span",{className:"mx-2 text-gray-400 text-sm",children:"o contina con"}),E.jsx("hr",{className:"flex-grow border-gray-300"})]}),E.jsxs("button",{onClick:b,className:"flex items-center justify-center gap-3 border border-gray-300 py-3 w-full rounded-lg hover:bg-gray-100 transition duration-200",children:[E.jsx(cI,{size:24}),E.jsx("span",{className:"text-gray-700 font-medium",children:"Iniciar sesin con Google"})]}),E.jsxs("p",{className:"mt-6 text-center text-gray-600 text-sm",children:["No tienes cuenta?"," ",E.jsx("span",{className:"text-blue-600 cursor-pointer",onClick:()=>n("register"),children:"Regstrate"})]})]}):E.jsxs(E.Fragment,{children:[E.jsxs("form",{onSubmit:A,className:"flex flex-col gap-4",children:[E.jsx("input",{type:"text",placeholder:"Nombre completo",className:"border p-3 rounded-lg",value:s,onChange:C=>a(C.target.value)}),E.jsx("input",{type:"email",placeholder:"Correo electrnico",className:"border p-3 rounded-lg",value:u,onChange:C=>c(C.target.value),required:!0}),E.jsx("input",{type:"password",placeholder:"Contrasea",className:"border p-3 rounded-lg",value:h,onChange:C=>p(C.target.value),required:!0}),E.jsx("button",{type:"submit",className:"bg-blue-600 text-white py-3 rounded-lg font-semibold",children:"Registrarse"})]}),E.jsxs("div",{className:"flex items-center w-full my-6",children:[E.jsx("hr",{className:"flex-grow border-gray-300"}),E.jsx("span",{className:"mx-2 text-gray-400 text-sm",children:"o contina con"}),E.jsx("hr",{className:"flex-grow border-gray-300"})]}),E.jsxs("button",{onClick:V,className:"flex items-center justify-center gap-3 border border-gray-300 py-3 w-full rounded-lg hover:bg-gray-100 transition duration-200",children:[E.jsx(cI,{size:24}),E.jsx("span",{className:"text-gray-700 font-medium",children:"Registrarse con Google"})]})]})]})})}function dq(){const[t,e]=B.useState(null),[n,i]=B.useState(null),[r,s]=B.useState(!0);return B.useEffect(()=>{const a=TR(si,async u=>{if(e(u),u){const c=En(rt,"usuarios",u.uid),h=await Wf(c);h.exists()&&i(h.data().rol)}s(!1)});return()=>a()},[]),r?E.jsx("p",{children:"Cargando"}):E.jsxs(rV,{children:[E.jsx(bo,{path:"/",element:E.jsx(uf,{to:"/login"})}),E.jsx(bo,{path:"/login",element:E.jsx(hq,{})}),E.jsx(bo,{path:"/panel",element:t&&n==="admin"?E.jsx(J7,{}):E.jsx(uf,{to:"/login"})}),E.jsx(bo,{path:"/pasajero",element:t&&n==="pasajero"?E.jsx(eq,{}):E.jsx(uf,{to:"/login"})}),E.jsx(bo,{path:"/conductor",element:t&&n==="conductor"?E.jsx(tq,{}):E.jsx(uf,{to:"/login"})}),E.jsx(bo,{path:"*",element:E.jsx("p",{children:"404"})})]})}O_.createRoot(document.getElementById("root")).render(E.jsx(ui.StrictMode,{children:E.jsx(aV,{children:E.jsx(dq,{})})}));
